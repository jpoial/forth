SOURCE$ MKOR.MOD IMODULE$ MKOR MODTAB$ MKOR SET-IMPL IMPORT-ON FROM$ DBF IMPORT$ GetByKey IMPORT$ ClearRecord FROM-OFF IMPORT$ KUNDE IMPORT-OFF KUNDE MOD-ID KLIENT RES-CONTEXT TYPE-DUP VAR$ klient TYPE-DROP MKORTYYP TYPE-DUP VAR$ maks TYPE-DROP WORD TYPE-DUP VAR$ KFail TYPE-DROP PRTAB$ Maksja NOOP ~ : &MKOR001 BODY-BEGIN FORTHBEGIN  DIA-PARA @ F+P ! addr maks BUF->REC  FORTHEND A-STACK-0 SV0 [ maks ] IDENTIFIER I*ALSO OP-REC WPUSH+ [ MaksjaNr ] IDENTIFIER WPOP- CT? I*PREV RES-CONTEXT REC-CHECK COMPILE-FETCH AGR-ADDR [ klient ] IDENTIFIER I*ALSO OP-REC WPUSH+ [ KUNDENUMBER ] IDENTIFIER WPOP- CT? I*PREV RES-CONTEXT REC-CHECK RECIPIENT? COMPILE-ASSIGN FORTHBEGIN  CO-FILE @ addr KFail !   FORTHEND CASE SV0 [ GetByKey ] IDENTIFIER RES-CONTEXT REC-CHECK AGRNAME SV0 [ KFail ] IDENTIFIER RES-CONTEXT REC-CHECK COMPILE-FETCH NEXTCOMP SV0 [ klient ] IDENTIFIER RES-CONTEXT REC-CHECK COMPILE-FETCH NEXTCOMP AGREND BOOLEAN? => [ ClearRecord ] IDENTIFIER RES-CONTEXT REC-CHECK PROCNAME SV0 [ maks ] IDENTIFIER RES-CONTEXT REC-CHECK COMPILE-FETCH NEXTCOMP PROCEND A-STACK-0 SV0 [ klient ] IDENTIFIER I*ALSO OP-REC WPUSH+ [ KUNDENUMBER ] IDENTIFIER WPOP- CT? I*PREV RES-CONTEXT REC-CHECK COMPILE-FETCH AGR-ADDR [ maks ] IDENTIFIER I*ALSO OP-REC WPUSH+ [ MaksjaNr ] IDENTIFIER WPOP- CT? I*PREV RES-CONTEXT REC-CHECK RECIPIENT? COMPILE-ASSIGN A-STACK-0 SV0 [ klient ] IDENTIFIER I*ALSO OP-REC WPUSH+ [ NIMETUS ] IDENTIFIER WPOP- CT? I*PREV RES-CONTEXT REC-CHECK COMPILE-FETCH AGR-ADDR [ maks ] IDENTIFIER I*ALSO OP-REC WPUSH+ [ MaksjaNimetus ] IDENTIFIER WPOP- CT? I*PREV RES-CONTEXT REC-CHECK RECIPIENT? COMPILE-ASSIGN A-STACK-0 SV0 [ klient ] IDENTIFIER I*ALSO OP-REC WPUSH+ [ NJATK ] IDENTIFIER WPOP- CT? I*PREV RES-CONTEXT REC-CHECK COMPILE-FETCH AGR-ADDR [ maks ] IDENTIFIER I*ALSO OP-REC WPUSH+ [ MNimetuseJatk ] IDENTIFIER WPOP- CT? I*PREV RES-CONTEXT REC-CHECK RECIPIENT? COMPILE-ASSIGN A-STACK-0 SV0 [ klient ] IDENTIFIER I*ALSO OP-REC WPUSH+ [ KOOD ] IDENTIFIER WPOP- CT? I*PREV RES-CONTEXT REC-CHECK COMPILE-FETCH AGR-ADDR [ maks ] IDENTIFIER I*ALSO OP-REC WPUSH+ [ MaksjaKood ] IDENTIFIER WPOP- CT? I*PREV RES-CONTEXT REC-CHECK RECIPIENT? COMPILE-ASSIGN A-STACK-0 SV0 [ klient ] IDENTIFIER I*ALSO OP-REC WPUSH+ [ PANGANIMI ] IDENTIFIER WPOP- CT? I*PREV RES-CONTEXT REC-CHECK COMPILE-FETCH AGR-ADDR [ maks ] IDENTIFIER I*ALSO OP-REC WPUSH+ [ MaksjaPangaNimi ] IDENTIFIER WPOP- CT? I*PREV RES-CONTEXT REC-CHECK RECIPIENT? COMPILE-ASSIGN A-STACK-0 SV0 [ klient ] IDENTIFIER I*ALSO OP-REC WPUSH+ [ PANGALINN ] IDENTIFIER WPOP- CT? I*PREV RES-CONTEXT REC-CHECK COMPILE-FETCH AGR-ADDR [ maks ] IDENTIFIER I*ALSO OP-REC WPUSH+ [ MaksjaPangaLinn ] IDENTIFIER WPOP- CT? I*PREV RES-CONTEXT REC-CHECK RECIPIENT? COMPILE-ASSIGN A-STACK-0 SV0 [ klient ] IDENTIFIER I*ALSO OP-REC WPUSH+ [ ARVEKOOD ] IDENTIFIER WPOP- CT? I*PREV RES-CONTEXT REC-CHECK COMPILE-FETCH AGR-ADDR [ maks ] IDENTIFIER I*ALSO OP-REC WPUSH+ [ MaksjaPKood ] IDENTIFIER WPOP- CT? I*PREV RES-CONTEXT REC-CHECK RECIPIENT? COMPILE-ASSIGN A-STACK-0 SV0 [ klient ] IDENTIFIER I*ALSO OP-REC WPUSH+ [ ARVENR ] IDENTIFIER WPOP- CT? I*PREV RES-CONTEXT REC-CHECK COMPILE-FETCH AGR-ADDR [ maks ] IDENTIFIER I*ALSO OP-REC WPUSH+ [ MaksjaArveNr ] IDENTIFIER WPOP- CT? I*PREV RES-CONTEXT REC-CHECK RECIPIENT? COMPILE-ASSIGN FORTHBEGIN  DIA-PARA @ F+P !         addr maks KIRJE @ MEST  FORTHEND ENDOF ESAC FORTHBEGIN  DIA-PARA @ F+P !  FORTHEND BODY-END ; BLBODY$ &MKOR001 END-BLOCK NPAIRS$ Maksja Maksja PRTAB$ Saaja NOOP ~ : &MKOR002 BODY-BEGIN FORTHBEGIN  DIA-PARA @ F+P ! addr maks BUF->REC  FORTHEND A-STACK-0 SV0 [ maks ] IDENTIFIER I*ALSO OP-REC WPUSH+ [ SaajaNr ] IDENTIFIER WPOP- CT? I*PREV RES-CONTEXT REC-CHECK COMPILE-FETCH AGR-ADDR [ klient ] IDENTIFIER I*ALSO OP-REC WPUSH+ [ KUNDENUMBER ] IDENTIFIER WPOP- CT? I*PREV RES-CONTEXT REC-CHECK RECIPIENT? COMPILE-ASSIGN FORTHBEGIN  CO-FILE @ addr KFail !   FORTHEND CASE SV0 [ GetByKey ] IDENTIFIER RES-CONTEXT REC-CHECK AGRNAME SV0 [ KFail ] IDENTIFIER RES-CONTEXT REC-CHECK COMPILE-FETCH NEXTCOMP SV0 [ klient ] IDENTIFIER RES-CONTEXT REC-CHECK COMPILE-FETCH NEXTCOMP AGREND BOOLEAN? => [ ClearRecord ] IDENTIFIER RES-CONTEXT REC-CHECK PROCNAME SV0 [ maks ] IDENTIFIER RES-CONTEXT REC-CHECK COMPILE-FETCH NEXTCOMP PROCEND A-STACK-0 SV0 [ klient ] IDENTIFIER I*ALSO OP-REC WPUSH+ [ KUNDENUMBER ] IDENTIFIER WPOP- CT? I*PREV RES-CONTEXT REC-CHECK COMPILE-FETCH AGR-ADDR [ maks ] IDENTIFIER I*ALSO OP-REC WPUSH+ [ SaajaNr ] IDENTIFIER WPOP- CT? I*PREV RES-CONTEXT REC-CHECK RECIPIENT? COMPILE-ASSIGN A-STACK-0 SV0 [ klient ] IDENTIFIER I*ALSO OP-REC WPUSH+ [ NIMETUS ] IDENTIFIER WPOP- CT? I*PREV RES-CONTEXT REC-CHECK COMPILE-FETCH AGR-ADDR [ maks ] IDENTIFIER I*ALSO OP-REC WPUSH+ [ SaajaNimetus ] IDENTIFIER WPOP- CT? I*PREV RES-CONTEXT REC-CHECK RECIPIENT? COMPILE-ASSIGN A-STACK-0 SV0 [ klient ] IDENTIFIER I*ALSO OP-REC WPUSH+ [ NJATK ] IDENTIFIER WPOP- CT? I*PREV RES-CONTEXT REC-CHECK COMPILE-FETCH AGR-ADDR [ maks ] IDENTIFIER I*ALSO OP-REC WPUSH+ [ SNimetuseJatk ] IDENTIFIER WPOP- CT? I*PREV RES-CONTEXT REC-CHECK RECIPIENT? COMPILE-ASSIGN A-STACK-0 SV0 [ klient ] IDENTIFIER I*ALSO OP-REC WPUSH+ [ KOOD ] IDENTIFIER WPOP- CT? I*PREV RES-CONTEXT REC-CHECK COMPILE-FETCH AGR-ADDR [ maks ] IDENTIFIER I*ALSO OP-REC WPUSH+ [ SaajaKood ] IDENTIFIER WPOP- CT? I*PREV RES-CONTEXT REC-CHECK RECIPIENT? COMPILE-ASSIGN A-STACK-0 SV0 [ klient ] IDENTIFIER I*ALSO OP-REC WPUSH+ [ PANGANIMI ] IDENTIFIER WPOP- CT? I*PREV RES-CONTEXT REC-CHECK COMPILE-FETCH AGR-ADDR [ maks ] IDENTIFIER I*ALSO OP-REC WPUSH+ [ SaajaPangaNimi ] IDENTIFIER WPOP- CT? I*PREV RES-CONTEXT REC-CHECK RECIPIENT? COMPILE-ASSIGN A-STACK-0 SV0 [ klient ] IDENTIFIER I*ALSO OP-REC WPUSH+ [ PANGALINN ] IDENTIFIER WPOP- CT? I*PREV RES-CONTEXT REC-CHECK COMPILE-FETCH AGR-ADDR [ maks ] IDENTIFIER I*ALSO OP-REC WPUSH+ [ SaajaPangaLinn ] IDENTIFIER WPOP- CT? I*PREV RES-CONTEXT REC-CHECK RECIPIENT? COMPILE-ASSIGN A-STACK-0 SV0 [ klient ] IDENTIFIER I*ALSO OP-REC WPUSH+ [ ARVEKOOD ] IDENTIFIER WPOP- CT? I*PREV RES-CONTEXT REC-CHECK COMPILE-FETCH AGR-ADDR [ maks ] IDENTIFIER I*ALSO OP-REC WPUSH+ [ SaajaPKood ] IDENTIFIER WPOP- CT? I*PREV RES-CONTEXT REC-CHECK RECIPIENT? COMPILE-ASSIGN A-STACK-0 SV0 [ klient ] IDENTIFIER I*ALSO OP-REC WPUSH+ [ ARVENR ] IDENTIFIER WPOP- CT? I*PREV RES-CONTEXT REC-CHECK COMPILE-FETCH AGR-ADDR [ maks ] IDENTIFIER I*ALSO OP-REC WPUSH+ [ SaajaArveNr ] IDENTIFIER WPOP- CT? I*PREV RES-CONTEXT REC-CHECK RECIPIENT? COMPILE-ASSIGN FORTHBEGIN  DIA-PARA @ F+P !         addr maks KIRJE @ MEST  FORTHEND ENDOF ESAC FORTHBEGIN  DIA-PARA @ F+P !  FORTHEND BODY-END ; BLBODY$ &MKOR002 END-BLOCK NPAIRS$ Saaja Saaja PRTAB$ INITS NOOP ~ 1 I/C BENUM 80 I/C BENUM CRROOT RANGE-TAB CHAR ARRAY-TAB TYPE-DUP VAR$ T1 TYPE-DUP VAR$ T2 TYPE-DUP VAR$ T3 TYPE-DUP VAR$ T4 TYPE-DUP VAR$ T5 TYPE-DUP VAR$ T6 TYPE-DUP VAR$ T7 TYPE-DUP VAR$ T8 TYPE-DUP VAR$ T9 TYPE-DUP VAR$ T10 TYPE-DUP VAR$ T11 TYPE-DUP VAR$ T12 TYPE-DUP VAR$ T13 TYPE-DUP VAR$ T14 TYPE-DUP VAR$ T15 TYPE-DUP VAR$ T16 TYPE-DUP VAR$ T17 TYPE-DUP VAR$ T18 TYPE-DUP VAR$ T19 TYPE-DROP 1 I/C BENUM 5 I/C BENUM CRROOT RANGE-TAB CHAR ARRAY-TAB TYPE-DUP VAR$ KIRJELDUS TYPE-DROP STR' MKOR ' SYS-STR$ &MKOR003 STR' Maksekorraldus Nr.  ' SYS-STR$ &MKOR004 STR' . ' SYS-STR$ &MKOR005 STR' .a. ' SYS-STR$ &MKOR006 STR' Maksja ' SYS-STR$ &MKOR007 STR' DEEBET       Summa ' SYS-STR$ &MKOR008 STR' Kood ' SYS-STR$ &MKOR009 STR' ----------------------------------------------------------------- ' SYS-STR$ &MKOR010 STR' . ' SYS-STR$ &MKOR011 STR' Maksja pank                   Linn       Kood       Arve Nr. ' SYS-STR$ &MKOR012 STR' ------------------------------------------------------------------------------ ' SYS-STR$ &MKOR013 STR' Saaja ' SYS-STR$ &MKOR014 STR' KREEDIT ' SYS-STR$ &MKOR015 STR' Saaja pank                    Linn       Kood       Arve Nr. ' SYS-STR$ &MKOR016 STR' Summa sonadega ' SYS-STR$ &MKOR017 STR' Makse eesmark ' SYS-STR$ &MKOR018 STR' P.K.                Kliendi allkirjad              Panga allkirjad ' SYS-STR$ &MKOR019 : &MKOR020 BODY-BEGIN A-STACK-0 SV0 [ &MKOR003 ] $STRINGCONST AGR-ADDR [ KIRJELDUS ] IDENTIFIER RES-CONTEXT REC-CHECK RECIPIENT? COMPILE-ASSIGN A-STACK-0 SV0 [ &MKOR004 ] $STRINGCONST AGR-ADDR [ T1 ] IDENTIFIER RES-CONTEXT REC-CHECK RECIPIENT? COMPILE-ASSIGN A-STACK-0 SV0 [ &MKOR005 ] $STRINGCONST AGR-ADDR [ T2 ] IDENTIFIER RES-CONTEXT REC-CHECK RECIPIENT? COMPILE-ASSIGN A-STACK-0 SV0 [ &MKOR006 ] $STRINGCONST AGR-ADDR [ T3 ] IDENTIFIER RES-CONTEXT REC-CHECK RECIPIENT? COMPILE-ASSIGN A-STACK-0 SV0 [ &MKOR007 ] $STRINGCONST AGR-ADDR [ T4 ] IDENTIFIER RES-CONTEXT REC-CHECK RECIPIENT? COMPILE-ASSIGN A-STACK-0 SV0 [ &MKOR008 ] $STRINGCONST AGR-ADDR [ T5 ] IDENTIFIER RES-CONTEXT REC-CHECK RECIPIENT? COMPILE-ASSIGN A-STACK-0 SV0 [ &MKOR009 ] $STRINGCONST AGR-ADDR [ T6 ] IDENTIFIER RES-CONTEXT REC-CHECK RECIPIENT? COMPILE-ASSIGN A-STACK-0 SV0 [ &MKOR010 ] $STRINGCONST AGR-ADDR [ T7 ] IDENTIFIER RES-CONTEXT REC-CHECK RECIPIENT? COMPILE-ASSIGN A-STACK-0 SV0 [ &MKOR011 ] $STRINGCONST AGR-ADDR [ T8 ] IDENTIFIER RES-CONTEXT REC-CHECK RECIPIENT? COMPILE-ASSIGN A-STACK-0 SV0 [ &MKOR012 ] $STRINGCONST AGR-ADDR [ T9 ] IDENTIFIER RES-CONTEXT REC-CHECK RECIPIENT? COMPILE-ASSIGN A-STACK-0 SV0 [ &MKOR013 ] $STRINGCONST AGR-ADDR [ T10 ] IDENTIFIER RES-CONTEXT REC-CHECK RECIPIENT? COMPILE-ASSIGN A-STACK-0 SV0 [ &MKOR014 ] $STRINGCONST AGR-ADDR [ T11 ] IDENTIFIER RES-CONTEXT REC-CHECK RECIPIENT? COMPILE-ASSIGN A-STACK-0 SV0 [ &MKOR015 ] $STRINGCONST AGR-ADDR [ T12 ] IDENTIFIER RES-CONTEXT REC-CHECK RECIPIENT? COMPILE-ASSIGN A-STACK-0 SV0 [ T7 ] IDENTIFIER RES-CONTEXT REC-CHECK COMPILE-FETCH AGR-ADDR [ T13 ] IDENTIFIER RES-CONTEXT REC-CHECK RECIPIENT? COMPILE-ASSIGN A-STACK-0 SV0 [ &MKOR016 ] $STRINGCONST AGR-ADDR [ T14 ] IDENTIFIER RES-CONTEXT REC-CHECK RECIPIENT? COMPILE-ASSIGN A-STACK-0 SV0 [ T10 ] IDENTIFIER RES-CONTEXT REC-CHECK COMPILE-FETCH AGR-ADDR [ T15 ] IDENTIFIER RES-CONTEXT REC-CHECK RECIPIENT? COMPILE-ASSIGN A-STACK-0 SV0 [ &MKOR017 ] $STRINGCONST AGR-ADDR [ T16 ] IDENTIFIER RES-CONTEXT REC-CHECK RECIPIENT? COMPILE-ASSIGN A-STACK-0 SV0 [ T10 ] IDENTIFIER RES-CONTEXT REC-CHECK COMPILE-FETCH AGR-ADDR [ T17 ] IDENTIFIER RES-CONTEXT REC-CHECK RECIPIENT? COMPILE-ASSIGN A-STACK-0 SV0 [ &MKOR018 ] $STRINGCONST AGR-ADDR [ T18 ] IDENTIFIER RES-CONTEXT REC-CHECK RECIPIENT? COMPILE-ASSIGN A-STACK-0 SV0 [ &MKOR019 ] $STRINGCONST AGR-ADDR [ T19 ] IDENTIFIER RES-CONTEXT REC-CHECK RECIPIENT? COMPILE-ASSIGN FORTHBEGIN  0 GET-FP   ['] MKORTYYP EXECUTE 12 + @ KIRJETYYP !        addr KIRJELDUS DEFNAME !                       7 #KOMPLEKT !   ['] KEY1TYYP KEY.ARRAY @ !        ['] KEY2TYYP KEY.ARRAY @  4 + !   ['] KEY3TYYP KEY.ARRAY @  8 + !   ['] KEY4TYYP KEY.ARRAY @ 12 + !   ['] KEY5TYYP KEY.ARRAY @ 16 + !   ['] KEY6TYYP KEY.ARRAY @ 20 + !   ['] KEY7TYYP KEY.ARRAY @ 24 + !   19 #VABA !    addr T1  TEXT.ARRAY @ !    addr T2  TEXT.ARRAY @  4 + !   addr T3  TEXT.ARRAY @  8 + !   addr T4  TEXT.ARRAY @ 12 + !   addr T5  TEXT.ARRAY @ 16 + !   addr T6  TEXT.ARRAY @ 20 + !   addr T7  TEXT.ARRAY @ 24 + !   addr T8  TEXT.ARRAY @ 28 + !   addr T9  TEXT.ARRAY @ 32 + !   addr T10 TEXT.ARRAY @ 36 + !   addr T11 TEXT.ARRAY @ 40 + !   addr T12 TEXT.ARRAY @ 44 + !   addr T13 TEXT.ARRAY @ 48 + !   addr T14 TEXT.ARRAY @ 52 + !   addr T15 TEXT.ARRAY @ 56 + !   addr T16 TEXT.ARRAY @ 60 + !   addr T17 TEXT.ARRAY @ 64 + !   addr T18 TEXT.ARRAY @ 68 + !   addr T19 TEXT.ARRAY @ 72 + !   2 #PROTS !   ['] Maksja  PROCED.ARRAY @ !       [']  Saaja  PROCED.ARRAY @ 4 + !  FORTHEND BODY-END ; BLBODY$ &MKOR020 END-BLOCK NPAIRS$ INITS INITS : &MKOR021 BODY-BEGIN [ INITS ] IDENTIFIER RES-CONTEXT REC-CHECK PROCNAME PROCEND BODY-END ; BLBODY$ &MKOR021 END-BLOCK NPAIRS$ MKOR MKOR CUNIT$ MKOR ;S NOSOURCE   