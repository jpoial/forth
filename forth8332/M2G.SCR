( Modula-2 menu                                      10/14/89 ) (                                                                       This file contains source for Modula-2 system              menu.                                                                                                                                Copyright (c), 1990, Viljo Soo                                          Tartu University, Estonia                                                                                               Modified by Ain Isotamm, 1991: direct run Modula-2Base.                                                                                                                                                                                                 )                                                                                                                                                                                                                                                               ( String operations                                  10/16/89 ) ( 1 LOAD-USING TRACE32 ) HEX                                    ( : CSTR, ( cstr --- )                                          (        DUP C@ 1+ HERE SWAP DUP ?ALLOT CMOVE ; )               : STR, ( addr l --- )                                                   HERE SWAP DUP ALLOT CMOVE ;                             : DEST|SOUR ( destad sourad --- )                                       ( concatenates two counted strings dest|sour -> dest )          SWAP >R DUP COUNT R@ COUNT + SWAP CMOVE                         C@ R@ C@ + R> C! ;                                      : SOUR|DEST ( sourad destad --- )                                       ( concatenates two counted strings sour|dest -> dest )          DUP >R 1+ OVER C@ ( s da sl )                                   OVER + R@ C@ CMOVE> ( s )                                       DUP C@ R@ C@ + R@ C! ( s )                                      COUNT R> 1+ SWAP CMOVE ; -->                            ( INTENS_EMIT CAP ENV_SEG ADRUN ?DISCERR             10/14/89 ) : INTENS_EMIT ?MODE 7 <> IF 4 FOREGROUND THEN INTENSITY EMIT    ?MODE 7 <> IF B/W THEN INTENSITY-OFF ;                          : CAP ( chr1 --- chr2 )                                         DUP ASCII a < OVER ASCII z > OR 0= IF 20 - THEN ;               VARIABLE ENV_ADDR                                               : ENV_SEG ENV_ADDR @ 10 / ?fs: + ;                              ( : K KEY DROP ; )                                              : ADRUN ( cstr1 cstr2 --- )                                     ( OVER COUNT TYPE SPACE DUP COUNT TYPE K ) HIDDEN                       PGM_NAME 40 ERASE CMD_LINE 40 ERASE                             DUP C@ 1+ CMD_LINE SWAP CMOVE                                   COUNT PGM_NAME SWAP CMOVE ENV_SEG exec-run                      FORTH ;                                                 : ?DISCERR ( errcode --- )                                       ?DUP IF CR .STATUS ABORT THEN ; -->                            ( Filenames and pathes                               10/14/89 ) HANDLE WFILE WFILE DROP 45 ERASE                                HANDLE MFILE MFILE DROP 45 ERASE                                HANDLE RFILE RFILE DROP 45 ERASE HANDLE TEMPOUT                 DIRECTORY EDITOR_NAME EDITOR_NAME DIRNAME NE.COM                DIRECTORY COMPILER_NAME COMPILER_NAME DIRNAME M2COMP.COM        DIRECTORY LOADLIST_NAME LOADLIST_NAME DIRNAME LOADLIST.COM      DIRECTORY LOADER_NAME LOADER_NAME DIRNAME LOADF.COM             DIRECTORY LINKER_NAME LINKER_NAME DIRNAME M2LINK.COM            DIRECTORY DBASE_NAME DBASE_NAME DIRNAME SHOWREC.COM             DIRECTORY CROSS_LINKER_NAME CROSS_LINKER_NAME DIRNAME CROSS.COM DIRECTORY RUNNER_NAME RUNNER_NAME DIRNAME  M2LINK.COM           DIRECTORY MODPATH MODPATH 40 ERASE                              DIRECTORY SOURCEPATH SOURCEPATH 40 ERASE                        DIRECTORY OBJECTPATH OBJECTPATH 40 ERASE                        DIRECTORY LIBPATH LIBPATH 40 ERASE  -->                         ( Error processing                                   04/19/90 ) HANDLE ERRFILE ERRFILE FILENAME M2ERR.TMP                       VARIABLE #LINE                       VARIABLE PARAMADDR         : HANDNAME DROP 4 + ;                                           : READERR ERRFILE OPEN-FILE-R/O ?DISCERR                                ERRFILE 4 #LINE READ IF 0 #LINE !                                                    ELSE  DROP THEN                            ERRFILE CLOSE-FILE ?DISCERR                                     ERRFILE KILL-FILE ?DISCERR ;                            : U>PSTR ( u --- addr l )                                               DECIMAL 0 <# #S ASCII + HOLD #> ;                       : EDITERR #LINE @ U>PSTR                                                HERE PARAMADDR ! DUP C, STR,                                    PARAMADDR @ DUP LIT"  " DEST|SOUR                               WFILE HANDNAME DEST|SOUR                                        EDITOR_NAME PARAMADDR @ ADRUN PARAMADDR @ DP ! ; -->    ( READ_LINKERR ?XCODE FILE_EXISTS?                   04/23/90 ) HANDLE SOURFILE         VARIABLE LOC#                           : READ_LINKERR ERRFILE OPEN-FILE ?DISCERR                               ERRFILE 1 SOURFILE HANDNAME DUP >R                              READ ?DISCERR DROP                                              ERRFILE R> COUNT SWAP READ ?DISCERR DROP                        ERRFILE 4 LOC# READ ?DISCERR DROP                               ERRFILE CLOSE-FILE ?DISCERR                                     ERRFILE KILL-FILE ?DISCERR ;                            : ?XCODE ( --- c )                                                      4D 0 FDOS DROP 0FF AND ;                                : FILE_EXISTS? ( handle_pars --- flag )                                 2DUP OPEN-FILE                                                  IF CR ." File " .FILENAME  ."  not found" 0                     ELSE DROP DUP H@ CLOSE-FILE DROP -1                             THEN ; -->                                              ( CHANGE_WFILE U>STR SET_LOCOPT                      04/23/90 ) : CHANGE_WFILE WFILE DROP 40 ERASE                                      SOURFILE HANDNAME DUP C@ 1+                                     WFILE HANDNAME SWAP CMOVE                                       CR ." Work file changed to " WFILE .FILENAME ;          VARIABLE LOCOPT 10 ALLOT                                        : U>STR ( u --- addr l )                                                DECIMAL 0 <# #S #> ;                                    : SET_LOCOPT                                                            0 LOCOPT ! LOCOPT LIT"  /E" DEST|SOUR                           LOC# @ U>STR DUP 3 + LOCOPT C!                                  LOCOPT 4 + SWAP CMOVE ;                                 DIRECTORY DBP_NAME DBP_NAME DIRNAME MF.COM                      DIRECTORY BRUNNER_NAME BRUNNER_NAME DIRNAME MF.COM              DIRECTORY DRUNNER_NAME DRUNNER_NAME DIRNAME  SHOWREC.COM        -->                                                             ( PATHEND                                            05/07/90 ) : PATHEND ( addr1 --- addr2 )                                           BEGIN ASCII \ SCAN                                              WHILE 1+ REPEAT ;                                       : LOAD&EX ( cstr1 cstr2 handle_pars --- )                               HANDNAME >R >R >R HERE PARAMADDR ! 0 C,                         PARAMADDR @ DUP R> DEST|SOUR                                    DUP LIT"  " DEST|SOUR R> OVER R> DEST|SOUR                      DEST|SOUR                                                       HERE C@ ALLOT                                                   LOADER_NAME PARAMADDR @ ADRUN PARAMADDR @ DP ! ;        VARIABLE NULSTR                                                 -->                                                                                                                                                                                                                                                             ( File settings: SET_WORKFILE SET_MAINFILE           10/14/89 ) : SET_WORKFILE                                                  ?MODE 7 <> IF 4 FOREGROUND THEN                                         INTENSITY ." Work file name: " QUERY CR INTENSITY-OFF           WFILE [COMPILE] FILENAME                                        WFILE ?FILE-EXT SWAP DROP 0=                                    IF WFILE HANDNAME LIT" .MOD" DEST|SOUR THEN                     WFILE DROP 5 + ASCII \ SCAN 0=                                  IF SOURCEPATH WFILE HANDNAME SOUR|DEST                          THEN DROP ?MODE 7 <> IF B/W THEN ;                      : SET_MAINFILE ( Main file name from command line )                     HEX 80 C@ 1 - DUP >R MFILE DROP 4 + C!                          82 MFILE DROP 5 + R> CMOVE DECIMAL                              MFILE ?FILE-EXT SWAP DROP 0=                                    IF MFILE HANDNAME LIT" .OBM" DEST|SOUR THEN             -->                                                             ( Drive & dir setting: SET_LOGDISK SET_ACTDIR        10/14/89 )         MFILE DROP 5 + ASCII \ SCAN 0=                                  IF OBJECTPATH MFILE HANDNAME SOUR|DEST                          THEN DROP ;                                             : SET_LOGDISK                                                           INTENSITY ." Log disk drive: "                                  KEY CAP DUP EMIT ASCII : EMIT INTENSITY-OFF                     ASCII A - 0 MAX 3F MIN                                          0E OVER FDOS DROP 0FF AND >=                                    IF CR ." Illegal drive." CR                                     THEN ;                                                  : SET_ACTDIR                                                            INTENSITY ." New directory name: " QUERY CR                     INTENSITY-OFF                                                   BL WORD DUP COUNT + 0 SWAP C! chdir 0=                          IF DROP THEN ; -->                                      ( EMPTY_NAME WFILE_SET? MFILE_SET?                   12/04/90 ) : EMPTY_NAME ( handle_pars --- flag )                                   DROP 4 + C@ 0= ;                                        : WFILE_SET?                                                            WFILE EMPTY_NAME                                                IF                                                                 SET_WORKFILE                                                 THEN                                                    ;                                                               : MFILE_SET?                                                            MFILE EMPTY_NAME                                                IF                                                                 SET_MAINFILE                                                 THEN                                                    ;                                                               -->                                                             ( Executing utilites: IMPORTLIST M2EDIT              12/04/90 ) : IMPORTLIST LOADLIST_NAME MFILE HANDNAME ADRUN ;               : M2EDIT WFILE_SET? ?MODE 7 <> IF 4 FOREGROUND THEN                     ." Edit" CR                                                     EDITOR_NAME WFILE HANDNAME                                      ?MODE 7 <> IF 3 MODE 2 FOREGROUND THEN ADRUN                    ?MODE 7 <> IF B/W THEN ;                                -->                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ( Executing utilites: OPTCOMP M2COMPILE COMPLOC      04/23/90 ) : OPTCOMP ( cstr --- )                                                  COMPILER_NAME SWAP WFILE LOAD&EX ?XCODE  8 =                    IF READERR                                                         ." Press ENTER to edit errorneus program" CR                    ." or any other key to continue."                               KEY ASCII_CR = IF EDITERR THEN                               THEN ;                                                  : M2COMPILE WFILE_SET? ." Compile" WFILE FILE_EXISTS? CR                IF LIT"  /E0" OPTCOMP                                           THEN ;                                                  : COMPLOC SOURFILE FILE_EXISTS?                                         IF CHANGE_WFILE SET_LOCOPT                                         LOCOPT OPTCOMP                                               THEN ; -->                                                                                                              ( Executing utilites: M2LINK                         04/23/90 ) : M2LINK MFILE_SET? ." Link" MFILE FILE_EXISTS? CR                      IF IMPORTLIST ?XCODE 0=                                            IF LOADER_NAME LINKER_NAME ADRUN                                   ?XCODE 8 =                                                      IF READ_LINKERR                                                   ." Press ENTER to find error position in souce"                  CR ." or any other key to continue."                            KEY ASCII_CR =                                                  IF COMPLOC                                                      THEN                                                         THEN                                                         THEN                                                         THEN ;                                                  -->                                                                                                                             ( Executing utilites: CROSS                          12/04/90 ) : CROSS MFILE_SET? ." Cross link" MFILE FILE_EXISTS? CR                 IF IMPORTLIST ?XCODE 0=                                            IF LOADER_NAME CROSS_LINKER_NAME ADRUN                             ?XCODE 8 =                                                      IF READ_LINKERR                                                   ." Press ENTER to find error position in souce"                  CR ." or any other key to continue."                            KEY ASCII_CR =                                                  IF COMPLOC                                                      THEN                                                         THEN                                                         THEN                                                         THEN ;                                                  -->                                                                                                                             ( Executing utilites: M2RUN                          05/07/90 ) : M2RUN MFILE_SET? ." Run" CR RFILE DROP 40 ERASE               MFILE HANDNAME RFILE HANDNAME OVER C@ 1+ CMOVE RFILE ?FILE-EXT   IF LIT" BIN" 1+ SWAP 3 CMOVE                                    ELSE RFILE HANDNAME LIT" .BIN" DEST|SOUR THEN                  0 RFILE HANDNAME COUNT + C! RFILE FILE_EXISTS?                          IF RUNNER_NAME NULSTR RFILE LOAD&EX THEN ;                                                                              : M2BRUN MFILE_SET? ." Run" CR RFILE DROP 40 ERASE              MFILE HANDNAME RFILE HANDNAME OVER C@ 1+ CMOVE RFILE ?FILE-EXT   IF LIT" BIN" 1+ SWAP 3 CMOVE                                    ELSE RFILE HANDNAME LIT" .BIN" DEST|SOUR THEN                  0 RFILE HANDNAME COUNT + C! RFILE FILE_EXISTS?                          IF BRUNNER_NAME NULSTR RFILE LOAD&EX THEN ;             -->                                                                                                                             ( Executing utilites: M2BASE                         01/21/91 ) : M2BASE MFILE_SET? ?MODE 7 <> IF 4 FOREGROUND INTENSITY THEN         ." Base" MFILE FILE_EXISTS? CR                                    IF IMPORTLIST ?XCODE 0=                                            IF LOADER_NAME DBASE_NAME                                         ?MODE 7 <> IF B/W THEN ADRUN                                  THEN                                                         THEN ?MODE 7 <> IF B/W THEN ;                           : M2BP MFILE_SET? ?MODE 7 <> IF 4 FOREGROUND INTENSITY THEN           ." Report" MFILE FILE_EXISTS? CR                                  IF IMPORTLIST ?XCODE 0=                                            IF LOADER_NAME DBP_NAME                                           ?MODE 7 <> IF B/W THEN ADRUN                                  THEN                                                         THEN ?MODE 7 <> IF B/W THEN ;                           -->                                                             ( Main menu: SHOWDIR PROMPT .LOGGED_DRIVE .ACTIVE_DIR10/14/89 ) : SHOWDIR                                                               INTENSITY ." Dir mask: " QUERY INTENSITY-OFF                    DIR ;                                                   : PROMPT CR ." $ " ;                                            : .LOGGED_DRIVE                                                         ." lo" ASCII G INTENS_EMIT ." ged drive: "                      19 0 FDOS DROP 0FF AND ASCII A + INTENS_EMIT                    ASCII : INTENS_EMIT ;                                   : .ACTIVE_DIR                                                           ASCII A INTENS_EMIT ." ctive directory: "                       19 0 FDOS DROP 0FF AND 1+ ( drive )                             INTENSITY .DIR INTENSITY-OFF ;                          -->                                                                                                                                                                                             ( Main menu: .WORKFILE .MAINFILE .COMMANDS           10/14/89 ) : .WORKFILE                                                             ASCII W INTENS_EMIT ." ork file: "                              INTENSITY WFILE .FILENAME INTENSITY-OFF ;               : .MAINFILE                                                             ASCII M INTENS_EMIT ." ain file: "                              INTENSITY MFILE .FILENAME INTENSITY-OFF ;                                                                               : M2DRUN MFILE_SET? ." Run" CR RFILE DROP 40 ERASE              MFILE HANDNAME RFILE HANDNAME OVER C@ 1+ CMOVE RFILE ?FILE-EXT   IF LIT" BIN" 1+ SWAP 3 CMOVE                                    ELSE RFILE HANDNAME LIT" .BIN" DEST|SOUR THEN                  0 RFILE HANDNAME COUNT + C! RFILE FILE_EXISTS?                          IF DRUNNER_NAME NULSTR RFILE LOAD&EX THEN ;             -->                                                                                                                             ( Main menu: .COMMANDS                               12/04/90 ) : .COMMANDS                                                     ?MODE 7 <> IF 4 FOREGROUND THEN                                         ASCII E INTENS_EMIT ." dit      "                               ASCII C INTENS_EMIT ." ompile   "                               ASCII L INTENS_EMIT ." ink      "                               ASCII R INTENS_EMIT ." un       "  CR                           14 SPACES ." cr" ASCII O INTENS_EMIT ." ss-link "  CR           ASCII Q INTENS_EMIT ." uit      "                               ASCII D INTENS_EMIT ." irectory "                               ASCII P INTENS_EMIT ." aths     "                       -->                                                                                                                                                                                                                                                                                                                             ( Main menu: M2IDENTIFY SHOWMENU                     10/14/89 )         ASCII B INTENS_EMIT ." ase comp "                               ASCII F INTENS_EMIT ." ile edit "  CR                           ." repor" ASCII T INTENS_EMIT ."     "                          ." DBLabor r" ASCII U INTENS_EMIT ." n" CR              ?MODE 7 <> IF B/W THEN ;                                        : M2IDENTIFY CLEARSCREEN                                                10 SPACES ." Modula-2 system. Version 2.0"                      CR 0E SPACES ." Tartu University, Estonia. 1989"                     CR CR ;                                            : SHOWMENU                                                              M2IDENTIFY .LOGGED_DRIVE CR .ACTIVE_DIR CR CR                   .WORKFILE CR .MAINFILE CR CR .COMMANDS CR CR ;          -->                                                                                                                                                                                             ( Paths menu: CHECK\ INPUT_PATH SET_<path>           10/22/89 ) : CHECK\ ( addr --- )                                                   DUP COUNT DUP                                                   IF + 1- C@ ASCII \ =                                               IF DROP                                                         ELSE LIT" \" DEST|SOUR THEN                                  ELSE DROP 2DROP THEN ;                                  : INPUT_PATH ( addr --- )                                               DUP INPUT-DIRNAME INTENSITY-OFF CHECK\ ;                : SET_SOURCEPATH INTENSITY ." Source text directory path: "             SOURCEPATH INPUT_PATH ;                                 : SET_OBJECTPATH INTENSITY ." Object modules directory path: "          OBJECTPATH INPUT_PATH ;                                 : SET_LIBPATH INTENSITY ." Library modules directory path: "            LIBPATH INPUT_PATH ;                                    -->                                                             ( Paths menu: SET_EDITOR .<path>                     10/22/89 ) : SET_EDITOR INTENSITY ." Editor's pathname: "                          EDITOR_NAME INPUT-DIRNAME INTENSITY-OFF ;               ( : .MODPATH ASCII M INTENS_EMIT ." odula-2 system directory : "        INTENSITY MODPATH COUNT TYPE INTENSITY-OFF ; )          : .EDITORPATH ASCII E INTENS_EMIT ." ditor : "                          INTENSITY EDITOR_NAME COUNT TYPE INTENSITY-OFF ;        : .SOURCEPATH ASCII S INTENS_EMIT ." ource text directory : "           INTENSITY SOURCEPATH COUNT TYPE INTENSITY-OFF ;         : .OBJECTPATH ASCII O INTENS_EMIT ." bject modules directory : "        INTENSITY OBJECTPATH COUNT TYPE INTENSITY-OFF ;         -->                                                                                                                                                                                                                                                                                                                             ( Paths menu: .LIBPATH .PATH_COMMANDS PATHIDENTIFY...10/22/89 ) : .LIBPATH ASCII L INTENS_EMIT ." ibrary modules directory : "          INTENSITY LIBPATH COUNT TYPE INTENSITY-OFF ;            : .PATH_COMMANDS ASCII Q INTENS_EMIT ." uit" CR                         ." save " ASCII C INTENS_EMIT                                   ." urrent settings in file and exit " ;                 : PATHIDENTIFY CLEARSCREEN 10 SPACES                                    ." Modula-2 system." CR 10 SPACES                               ." Path setting menu." CR ;                             : SHOW_PATHMENU PATHIDENTIFY ( CR .MODPATH ) CR .EDITORPATH             CR CR .SOURCEPATH CR .OBJECTPATH CR .LIBPATH CR CR              .PATH_COMMANDS CR CR ;                                  -->                                                                                                                                                                                                                                                             ( Environment: HEREPARA CREATE_ENV INIT_ENV ...      10/22/89 ) : HEREPARA ( --- addr )                                                    HERE 0F + FFFF0 AND DUP DP ! ;                       : CREATE_ENV HEREPARA ENV_ADDR ! ;                              : INIT_ENV ENV_ADDR @ DP ! ;                                    : ENV_END 0 C, ;                                                : SET_ENV ( addr1 addr2 --- )                                           SWAP COUNT STR, ASCII = C, COUNT STR, 0 C, ;            : MODIFY_ENV INIT_ENV                                                   LIT" SOURCE" SOURCEPATH SET_ENV                                 LIT" OBJECT" OBJECTPATH SET_ENV                                 LIT" LIBRARY" LIBPATH SET_ENV                                   ENV_END ;                                               -->                                                                                                                                                                                             ( Paths menu: SAVE_CONFIG                            10/22/89 ) : SAVE_CONFIG INTENSITY                                                 ." Name of .COM file with current settings: "                   WFILE FILENAME NUL MFILE FILENAME NUL                           INIT_ENV QUERY INTENSITY-OFF SAVE ;                     -->                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ( Paths menu: RESET_NAME NEW_NAMES                   10/22/89 ) -->                                                             : RESET_NAME ( newpath name --- )                                       DUP >R 1+ PATHEND DUP R@ - 1- R@ C@ SWAP - DUP HERE C!          HERE 1+ SWAP CMOVE                                              R@ 40 ERASE                                                     R@ SWAP DEST|SOUR                                               R> HERE DEST|SOUR ;                                     : NEW_NAMES MODPATH DUP COMPILER_NAME RESET_NAME                        DUP MAKE_NAME RESET_NAME                                        DUP LOADER_NAME RESET_NAME                                      DUP LINKER_NAME RESET_NAME                                      RUNNER_NAME RESET_NAME ; -->                                                                                                                                                                                                                            ( Paths menu: PATH_SHELL SET_PATHS                   10/22/89 ) : PATH_SHELL                                                            BEGIN SHOW_PATHMENU PROMPT KEY CAP                                CASE                                                              ASCII E OF SET_EDITOR ENDOF                         (           ASCII M OF SET_MODPATH ENDOF )                                  ASCII S OF SET_SOURCEPATH ENDOF                                 ASCII O OF SET_OBJECTPATH ENDOF                                 ASCII L OF SET_LIBPATH ENDOF                                    ASCII Q OF EXIT ENDOF                                           ASCII C OF SAVE_CONFIG ENDOF                                  ENDCASE                                                       AGAIN ;                                                 : SET_PATHS PATH_SHELL SHOWMENU                                        (  NEW_NAMES ) MODIFY_ENV ;                              -->                                                             ( Main menu: MENUSHELL                               10/14/89 ) : MENUSHELL                                                       SHOWMENU                                                        BEGIN PROMPT KEY CAP CASE                                         ASCII E OF M2EDIT ENDOF       ASCII C OF M2COMPILE ENDOF        ASCII L OF M2LINK ENDOF       ASCII R OF M2RUN ENDOF            ASCII B OF M2BASE ENDOF       ASCII T OF M2BP  ENDOF            ASCII W OF SET_WORKFILE ENDOF ASCII M OF SET_MAINFILE ENDOF     ASCII G OF SET_LOGDISK ENDOF  ASCII A OF SET_ACTDIR ENDOF       ASCII Q OF BYE ENDOF          ASCII D OF SHOWDIR ENDOF          ASCII P OF SET_PATHS ENDOF    ASCII O OF CROSS ENDOF            ASCII F OF M2DRUN ENDOF       ASCII U OF M2BRUN ENDOF           ( else ) SHOWMENU                                              ENDCASE SHOWMENU AGAIN ;                                     -->                                                                                                                             ( #8 FORTKEY.ASM                                     01/20/91 ) ( Jourdain, lk. 104. 80 - Insert, 40 - CapsLock, 20 - NumLock,  10 - ScrollLock, 08 - AltShift, 04 - CtrlShift,                 02 - LefthandShift, 01 - RighthandShift )                       ( CapsLock only on )                                                                                                            HEX                                                             CREATE fkeys! HERE  DUP BODY> !                                     2B C, C0 C, 8E C, C0 C, B8 C, 40 C, 40 C, 26 C, A3 C, 417 H,    51 C, E9 C,                                                     NEXT-LINK HERE 2 + - H,                                                                                                     : !FKEYS ( --- )                                                fkeys! ;                                                        DECIMAL                                                         -->                                                             ( End of modmenu                                     10/16/89 ) : DIRECT-RUN ( Main file name in command line; MF.COM )         CREATE_ENV MODIFY_ENV ( !FKEYS ) SET_MAINFILE M2BRUN            ?MODE 7 <> IF 3 MODE THEN BYE ;                                                                                                  DECIMAL                                                         ' DIRECT-RUN DUP UIDENT ! UQUIT !                               SAVE M2G                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       