 Modula-DataBase: TABEL  ( Ain Isotamm, Tartu University )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              M A S S I I V I   P A R A M E E T R I D   ( ArrP )                                                                       0 >korner                         56 >veeru(puu) pass           4 >juhtveerud                     60 juhtveergude arv #dim-1    8 >pea                            64 >juhtveergude laiused     12 >maatriks                       68 >juhtveergude nimed       16 #massiiviveerud                 72 juhtveergude ä-laius      20 #massiiviread                   76 tabelirea pikkus          24 #massiivielemendid              80 paani laius               28 #dimensioonid                   84 #paani ortogonid          32 >D-vektor                       88 paani paksus              36 >indeksid ( t””vektor )         92 #paani M-read             40 >limes ( rajad )                96 paani nihe ( muutuja )    44 >indextypes                    100 >larida                  48 ortogoni laius                 104 >alarida                  52 ortogoni paksus                108 maatrixi & pea laius      112 t””index (MX),kirjeindex MBT  176 n„htav maatrixi #read     116 pea & korneri paksus          180 viimase veeru pass        120 >wbp korner                   184 ortogoni pikkus kirjes    124 >wbp juhtveerud               188 massiivi sa kirjes        128 >wbp pea                      192 >PRINTBUFFER  ( tr-rida ) 132 >wbp maatrix                  196 >EXPUHVER  ( lk. algus )  136 alamtabeli reapikkus          200 >KRPUHVER  ( lk. vahe )   140 alamtabeli reaindex           204 >MARKBUFFER               144 n„htav tabelilaius            208 A(MARK)                   148 n„htav ridade arv             212 [0..0]-ARRAY: NEXTPOINTER 152 ä tabel                                                     156 tabeliridade koguarv                                        160 >pea nimi | 0                                               164 jooksva veeru index                                         168 jooksva rea index  ( pilt )                                 172 n„htav maatrixi laius                                                         V E E R U P A S S                                                                                              0 >kirjev„lja | arraytype pass    52 laius ( enda | alampuu )   4 >l“pptp                       56 >NAME                      8 T                               60 tase                      10 selektori laius                 64 >caseroot, if select      12 suhtaadress reas                                             16 pikkus ( #SYMB? )                                            20 >down                                                        24 >next                                                        28 >prior                                                       32 >up                                                          36 >ScopeParm | 0                                               40 >ArrP | 0                                                    44 suhtaadress kirjes                                           48 paksus                                                       \ #4 Variables                                       02/18/90 ) VARIABLE Magasin       VARIABLE Pagas                           VARIABLE Minx          VARIABLE Paxus                           VARIABLE DimArv        VARIABLE Vektor                          VARIABLE Tipp          VARIABLE SaD                             VARIABLE Puu           VARIABLE J@RG                            VARIABLE LineIndex     VARIABLE PAKS                            VARIABLE CurrLine      VARIABLE Pesa                            VARIABLE Sarv          28 DECL Magasin !   0 Minx !             VARIABLE EXPUHVER          VARIABLE KRPUHVER                    VARIABLE LK-NR             VARIABLE RIDANR                      VARIABLE PILU              VARIABLE LK-RIDA                     : A180 ArrP @ 180 + ;         : @180 ArrP @ 180 + @ ;           : A212 ArrP @ 212 + ;         : @212 ArrP @ 212 + @ ;           -->                                                                                                                             \ #5 Parm addressing                                 02/18/90 ) : A0 ArrP @ ;                 : @0 ArrP @ @ ;                   : A4 ArrP @ 4 + ;             : @4 ArrP @ 4 + @ ;               : A8 ArrP @ 8 + ;             : @8 ArrP @ 8 + @ ;               : A12 ArrP @ 12 + ;           : @12 ArrP @ 12 + @ ;             : A16 ArrP @ 16 + ;           : @16 ArrP @ 16 + @ ;             : A20 ArrP @ 20 + ;           : @20 ArrP @ 20 + @ ;             : A24 ArrP @ 24 + ;           : @24 ArrP @ 24 + @ ;             : A28 ArrP @ 28 + ;           : @28 ArrP @ 28 + @ ;             : A32 ArrP @ 32 + ;           : @32 ArrP @ 32 + @ ;             : A36 ArrP @ 36 + ;           : @36 ArrP @ 36 + @ ;             : A40 ArrP @ 40 + ;           : @40 ArrP @ 40 + @ ;             : A44 ArrP @ 44 + ;           : @44 ArrP @ 44 + @ ;             : A48 ArrP @ 48 + ;           : @48 ArrP @ 48 + @ ;             : A52 ArrP @ 52 + ;           : @52 ArrP @ 52 + @ ;             : A56 ArrP @ 56 + ;           : @56 ArrP @ 56 + @ ;   -->       \ #6 Parm addressing                                 02/18/90 ) : A60 ArrP @ 60 + ;           : @60 ArrP @ 60 + @ ;             : A64 ArrP @ 64 + ;           : @64 ArrP @ 64 + @ ;             : A68 ArrP @ 68 + ;           : @68 ArrP @ 68 + @ ;             : A72 ArrP @ 72 + ;           : @72 ArrP @ 72 + @ ;             : A76 ArrP @ 76 + ;           : @76 ArrP @ 76 + @ ;             : A80 ArrP @ 80 + ;           : @80 ArrP @ 80 + @ ;             : A84 ArrP @ 84 + ;           : @84 ArrP @ 84 + @ ;             : A88 ArrP @ 88 + ;           : @88 ArrP @ 88 + @ ;             : A92 ArrP @ 92 + ;           : @92 ArrP @ 92 + @ ;             : A96 ArrP @ 96 + ;           : @96 ArrP @ 96 + @ ;             : A100 ArrP @ 100 + ;         : @100 ArrP @ 100 + @ ;           : A104 ArrP @ 104 + ;         : @104 ArrP @ 104 + @ ;           : A108 ArrP @ 108 + ;         : @108 ArrP @ 108 + @ ;           : A112 ArrP @ 112 + ;         : @112 ArrP @ 112 + @ ;           : A116 ArrP @ 116 + ;         : @116 ArrP @ 116 + @ ;   -->     \ #7 Parm addressing                                 02/18/90 ) : A120 ArrP @ 120 + ;         : @120 ArrP @ 120 + @ ;           : A124 ArrP @ 124 + ;         : @124 ArrP @ 124 + @ ;           : A128 ArrP @ 128 + ;         : @128 ArrP @ 128 + @ ;           : A132 ArrP @ 132 + ;         : @132 ArrP @ 132 + @ ;           : A136 ArrP @ 136 + ;         : @136 ArrP @ 136 + @ ;           : A140 ArrP @ 140 + ;         : @140 ArrP @ 140 + @ ;           : A144 ArrP @ 144 + ;         : @144 ArrP @ 144 + @ ;           : A148 ArrP @ 148 + ;         : @148 ArrP @ 148 + @ ;           : A152 ArrP @ 152 + ;         : @152 ArrP @ 152 + @ ;           : A156 ArrP @ 156 + ;         : @156 ArrP @ 156 + @ ;           : A160 ArrP @ 160 + ;         : @160 ArrP @ 160 + @ ;           : A164 ArrP @ 164 + ;         : @164 ArrP @ 164 + @ ;           : A168 ArrP @ 168 + ;         : @168 ArrP @ 168 + @ ;           : A172 ArrP @ 172 + ;         : @172 ArrP @ 172 + @ ;           : A176 ArrP @ 176 + ;         : @176 ArrP @ 176 + @ ;   -->     \ #8 Pict                                            02/18/90 ) : ?LNAME ( >pass --- n )                                        DUP ?L 9 = IF DROP 0                                                       ELSE 4 - BODY> >NAME C@ 31 AND                                  THEN ;                                               : ?LAIUS ( sarv --- n )                                         PATS @ @ DUP 0 <>                                                 IF C@ 31 AND 2DUP > IF DROP ELSE SWAP DROP THEN                 ELSE DROP                                                       THEN ;                                                        : LAIUS? ( >eltyyp --- >eltyyp n )                              DUP #SYMB? Tipp @ @ DUP ?L 11 <>                                    IF ?LNAME 2DUP > IF DROP ELSE SWAP DROP THEN                    ELSE DROP                                                       THEN ;                                                      -->                                                             \ #9 Stack                                           02/18/90 ) : >Magasin ( x --- x )                                          DUP Minx @ Magasin @ + ! ;                                      : Magasin> ( --- x )                                            Minx @ Magasin @ + @ ;                                          : Minx+ ( --- )                                                 4 Minx +! Minx @ 4 / DUP @116 >                                   IF A116 ! ELSE DROP THEN                                      0 >Magasin DROP ;                                               : Minx-  ( --- )                                                4 Minx -! Magasin> DUP                                          12 + @ Pesa @ SWAP - 1+ SWAP 52 + ! ;                           : Mix-  ( --- )                                                 4 Minx -! ;                                                     -->                                                                                                                             \ #10 Line filling                                   02/18/90 ) : FILL-A ( A n lopp taide algus --- )                           4 PICK C! 3 PICK 1+ 3 PICK 2 - ROT FILL ROT ROT 1- + C! ;       : 0-RIDA ( A n mode --- )                                       >R 2DUP R>                                                      CASE 0 OF 187 205 201 FILL-A ENDOF             ( ÉÍ» )               1 OF 191 196 218 FILL-A ENDOF             ( ÚÄ¿ )          ENDCASE ;                                                       : n-RIDA ( A n mode --- )                                       >R 2DUP R>                                                      CASE 0 OF 188 205 200 FILL-A ENDOF             ( ÈÍ¼ )               1 OF 217 196 192 FILL-A ENDOF             ( ÀÄÙ )          ENDCASE ;                                                       -->                                                                                                                                                                                             \ #11 Name handle                                    02/18/90 ) : MOVE-NAME ( A >NAME --- )                                     DUP 0= IF 2DROP                                                     ELSE 2DUP DUP C@ 31 AND SWAP 1+ ROT ROT CMOVE                           C@ 31 AND SWAP 1- + DUP C@ 128 - SWAP C!                THEN ;                                                      : NimiKeskele ( A >NAME vasak laius --- )                       1+ 2 PICK C@ 31 AND - 2 / + ROT + SWAP MOVE-NAME ;              : Name-RIDA ( A >names >laiused arv --- A )                     0 ?DO 2DUP I 4 * + @ SWAP I 4 * + @ DUP 0 <>                            IF 4 PICK ROT ROT SWAP PATS @ SWAP                                 DUP PATS +! NimiKeskele                                      ELSE DROP PATS +!                                               THEN                                                      LOOP 2DROP ;                                                  -->                                                             \ #12 Corner                                         02/18/90 ) : MakeKorner ( --- )                                            @60 0 <>                                                         IF 0 PATS !                                                        @0 @116 2 /  @76 * +                 ( A keskmine pearida )     @68 @64 @60 Name-RIDA DROP                                   THEN ;                                                         -->                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ #13 Array spec.                                    02/18/90 ) : A-String? ( >arraytype --- flag )                             ?INDEXTYPE IS-CHAR? SWAP DROP ;                                 : DimArv? ( >type --- >type" )                                  DUP A-String? IF                                                              ELSE 1 A28 +! ?ELTYPE IS-ARRAY?                                    IF MYSELF THEN                                               THEN ;                                            : MakeLimit ( >arraytype --- >arraytype )                       DUP @28 0 DO DUP ?ELEM# Vektor @ ! 4 Vektor +! ?ELTYPE                    LOOP DROP ;                                           : MakeTV ( >arraytype --- >arraytype )                          DUP @28 0 DO DUP ?INDEXTYPE Vektor @ ! 4 Vektor +! ?ELTYPE                LOOP DROP ;                                           -->                                                                                                                             \ #14 Array spec                                     02/18/90 ) : MakeJVp ( >arraytype --- >arraytype )                         DUP @64 Pesa !      ( JV-laiused )                              @68 PATS !          ( JV-names )                                @60 0 ?DO DUP 16 + @ DUP ?L 8 =                                           IF DUP ?Nimi ELSE 0 THEN PATS @ ! DROP DUP ?INDEXTYPE           #SYMB? DUP 0= IF DROP 6 THEN                                    ?LAIUS 2 + DUP A72 +! Pesa @ !                                  4 Pesa +! 4 PATS +! ?ELTYPE                                  LOOP 16 + @ DUP ?L 8 = IF ?Nimi A160 ! ELSE DROP THEN ;  : PURE?                                                         @20 1 =                                                           IF @212 -1 <> IF 16 @116 -  DUP A20 ! A24 ! THEN                THEN ;                                                        -->                                                                                                                             \ #15 Array spec.                                    02/18/90 ) : MakeDV ( --- )                                                @28 1- 4 * >R @32 R@ + PICT !  1 PICT @ !  ( D.n := 1 )         @40 R> + PATS !              ( A.lim.n  )                       @28 1- 0 ?DO PATS @ @ PICT @ @ * 4 PICT -! PICT @ ! 4 PATS -!            LOOP ;                                                 : Make#M                                                        @40 PATS !  ( >limes )                                          1 PICT !    ( #Mread )                                          @60 DUP 0 <> IF 0 DO PATS @ @ PICT @ * PICT ! 4 PATS +! LOOP                 ELSE DROP                                                       THEN                                               PICT @ A20 !       ( #Mread )                                   PATS @ @ DUP A16 ! ( #Mveerud )                                 PICT @ * A24 !     ( #Mread * #Mveerud ) ;                      -->                                                             \ #16 Make arrayparm.                                02/18/90 ) : MakeArrP ( >arraytype --- )                                   216 DECL ArrP ! 0..0POINT @ A212 !                              DUP DimArv? A56 ! @28 1 =                                        IF DUP 12 + @ DUP ?L 8 = IF ?Nimi A160 ! ELSE DROP THEN THEN   1 A48 ! 1 A52 !    ( ortogoni algm““dud )                       @28 DUP DUP 1- A60 ! 4 *  >R 1 =                                IF @56 ?T 13 = IF 1 A60 ! THEN THEN                             R@ DECL A32 ! R@ DECL A36 !                                     R@ DECL DUP A40 ! Vektor ! MakeLimit                            R> DECL DUP A44 ! Vektor ! MakeTV MakeDV                        @60 DUP 0 <> IF 4 * DUP DECL A64 ! DECL A68 ! MakeJVp                        ELSE DROP THEN                                     @28 @60 = IF 1 A16 ! @40 @ DUP A20 ! A24 !                                ELSE Make#M THEN                                      DROP AIT @ 24 + @ ArrP @ 188 + ! ;                     -->      \ #17 Array spec.                                    02/18/90 ) : PeaPaxus @116 2 * 1+ @28 @60 <>                                 IF 2 + THEN @160 0<> IF 2 + THEN A116 ! ;                     : Viidad ( >tipp --- )                                          Magasin> DUP 0 <>                                                 IF 2DUP 32 + @ SWAP 32 + ! 2DUP 24 + ! SWAP 28 + !              ELSE DROP Minx @ DUP 0 <>                                         IF 4 - Magasin @ + @ 2DUP 20 + ! SWAP 32 + !                    ELSE DROP DROP                                                  THEN                                                          THEN ;                                                        -->                                                                                                                                                                                                                                                                                                                             \ #18 ortogon                                        02/18/90 ) : Viidatyyp? ( >elemtyyp --- >elemtyyp f )                      DUP ?TYPE ?T 8 =                                                  IF    0                ( viidatyyp )                            ELSE -1                ( muu tyyp  )                            THEN ;                                                        -->                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ #19 ortogon                                        02/18/90 ) : MakeCRT ( >elemtyyp --- >elemtyyp )                           68 DECL DUP Tipp ! >R DUP ?Nimi R@ 56 + ! Minx @ 4 / R@ 60 + !  Pesa @ R@ 12 + ! Puu @ 0= IF R@ Puu ! THEN                      DUP 4 + @ NihE @ + R@ 44 + !  ( sa kirjes )                     DUP R@ ! DUP                                                    ?TYPE DUP ??TYPE R@ 8 + ! R@ 4 + !  ( >pass, T, >lopptyyp )     LAIUS? 2 + R@ 52 + !                                            #SYMB? R@ 16 + !                                                R> DUP PAKS @ SWAP 48 + ! DUP Viidad                            Tipp @ DUP 28 + @ 64 + !            ( selector+64: >caseroot )  >Magasin DROP ;                                                 -->                                                                                                                                                                                                                                                             \ #20 Ortogon                                        04/21/90 ) : MakePuu NOOP ;                                                : Make1Tipp ( >elemtyyp --- >elemtyyp >tipp )                   68 DECL DUP Tipp ! >R DUP ?Nimi R@ 56 + ! Minx @ 4 / R@ 60 + !  Pesa @ R@ 12 + ! Puu @ 0= IF R@ Puu ! THEN                      DUP 4 + @ NihE @ + R@ 44 + !  ( sa kirjes )                     DUP R@ ! DUP                                                    DUP ??TYPE R@ 8 + ! R@ 4 + !  ( >pass, T, >lopptyyp )           LAIUS? 2 + DUP R@ 52 + ! Pesa +!                                #SYMB? R@ 16 + ! R@ @ DUP ?T 10 =                                   IF DUP BaastyyP ! MAKESCOPE ScP @ R@ 36 + !                     ELSE DROP                                                       THEN                                                        R> DUP PAKS @ SWAP 48 + ! DUP Viidad ;                          -->                                                                                                                             \ #21 SubArray                                       04/21/90 ) : SubArray       ( >arraytype --- | massiiv alampuus )          DUP ?ELTYPE ?T 6 =                                              IF   DROP                                                       ELSE DUP @28 >R 0 A28 ! DimArv? DROP @28 1 <>                     IF   DROP R> A28 !                                              ELSE DUP ?ELEM# DUP DUP Tipp @ 48 + ! PAKS @ >R DUP PAKS !           @52 > IF A52 ! ELSE DROP THEN R> A28 !                          Pesa @ Tipp @ 52 + @ - Pesa !                                   ?ELTYPE DUP ?T 13 =                                               IF   NihE @ >R Tipp @ 44 + @ NihE ! MakePuu  R> NihE !          ELSE Minx+ Make1Tipp Minx-                                      THEN R> PAKS !                                           THEN                                                          THEN ;                                                          -->                                                             \ #22 ortogon                                        02/18/90 ) : MakeTipp ( >elemtyyp --- >elemtyyp )                          Viidatyyp?                                                      IF 68 DECL DUP Tipp ! >R                                        DUP ?Nimi R@ 56 + ! Minx @ 4 / R@ 60 + !       ( >NAME, tase  ) Pesa @ R@ 12 + !                               ( sa reas      ) Puu @ 0= IF R@ Puu ! THEN                                       DUP R@ ! DUP ?T 3 <>                           ( >pass        ) IF  DUP 4 + @ NihE @ + R@ 44 + ! DUP           ( sa kirjes    )     ?TYPE DUP DUP BaastyyP !                   ( makescope'le )     ??TYPE R@ 8 + C! R@ 4 + !                  ( T, >lopptyyp )     LAIUS? 2 + DUP R@ 52 + ! Pesa +! DUP #SYMB? R@ 16 + !           ?T CASE 10 OF MAKESCOPE ScP @ Tipp @ 36 + ! ENDOF ENDCASE   THEN R> DUP PAKS @ SWAP 48 + ! DUP Viidad >Magasin DROP         THEN ;                                                          -->                                                             \ #23 ortogon                                        02/18/90 ) : Get-CurrLine @0 LineIndex @ @76 * + CurrLine ! ;              : M-LA CurrLine @ @72 + ;                                       : JUPP ( laius vasak A --- )                                    + SWAP 196 FILL ;                                               : ?VAD ( --- veeru-sa )                                         Pagas @ Tipp @ 12 + @ + ;                                       : Kriips? ( A --- tf )                                          1+ C@ DUP 205 = SWAP 196 = OR ;                                 : ?Hors ( A --- A i )                                           DUP C@ DUP 32 = IF DROP 0                                                       ELSE DUP 205 = IF DROP 1                   ( Í )                               ELSE 196 = IF 2 ELSE 0 THEN ( Ä )                               THEN                                             THEN ;                                          -->                                                             \ #24 ortogon                                        02/18/90 ) : PystI ( A mode  --- )                                         0= IF   ?Hors  CASE 0 OF 186 SWAP C! ENDOF  ( º )                                   1 OF 206 SWAP C! ENDOF  ( Î )                                   2 OF 215 SWAP C! ENDOF  ( × )                              ENDCASE                                             ELSE ?Hors CASE 0 OF 179 SWAP C! ENDOF  ( ³ )                                   1 OF 216 SWAP C! ENDOF  ( Ø )                                   2 OF 197 SWAP C! ENDOF  ( Å )                              ENDCASE                                              THEN ;                                                       -->                                                                                                                                                                                                                                                                                                                             \ #25 ortogon                                        02/18/90 ) : PystA ( A mode --- )                                          0= IF   DUP C@ 205 = IF 203 ELSE 210 THEN OVER C! ( Í Ë Ò )        ELSE DUP C@ 205 = IF 209 ELSE 194 THEN OVER C! (   Ñ Â )        THEN DROP ;                                                  : PystN ( A mode --- )                                          0= IF   DUP C@ 205 = IF 202 ELSE 207 THEN OVER C! ( Í Ê Ï )        ELSE DUP C@ 205 = IF 207 ELSE 193 THEN OVER C! (   Ï Á )        THEN DROP ;                                                  : VERT-LINE ( mode nihe reaindex --- )                          DUP @76 * @0 + 2 PICK OVER + 4 PICK                             PystA @76 + SWAP @156 2- SWAP                                       DO 2DUP + 3 PICK PystI @76 +                                    LOOP                                                        + SWAP PystN ;                                                  -->                                                             \ #26 ortogon                                        02/22/90 ) : KriipsA ( A mode --- A+1 : algussymbol )                      0= IF   DUP C@ 186 = IF 204 ELSE 198 THEN OVER C! ( º Ì Æ )        ELSE DUP C@ 186 = IF 199 ELSE 195 THEN OVER C! (   Ç Ã )        THEN 1+ ;                                                    : KriipsN ( A mode ---  : l“ppsymbol )                          0= IF   DUP C@ 186 = IF 185 ELSE 181 THEN OVER C! ( º ¹ µ )        ELSE DUP C@ 186 = IF 182 ELSE 180 THEN OVER C! (   ¶ ´ )        THEN DROP ;                                                  : ?Verts ( A --- A i )                                          DUP C@ DUP 32 = IF DROP 0                                                       ELSE DUP 186 = IF DROP 1                   ( º )                               ELSE 179 = IF 2 ELSE 0 THEN ( ³ )                               THEN                                             THEN ;                                          -->                                                             \ #27 ortogon                                        02/22/90 ) : KriipsI ( A mode n ---  : A+n-1 )                             SWAP 0= IF 0 DO  ?Verts CASE 0 OF 205 OVER C! ENDOF  ( Í )                                   1 OF 206 OVER C! ENDOF  ( Î )                                   2 OF 216 OVER C! ENDOF  ( Ø )                              ENDCASE                                          1+  LOOP                                                       ELSE 0 DO ?Verts CASE 0 OF 196 OVER C! ENDOF  ( Ä )                                   1 OF 215 OVER C! ENDOF  ( × )                                   2 OF 197 OVER C! ENDOF  ( Å )                              ENDCASE                                         1+    LOOP                                                     THEN ;                                                  : Kriips ( A mode pikkus --- )                                  ROT 2 PICK KriipsA 2 PICK ROT 2 - KriipsI SWAP KriipsN ;        -->                                                             \ #28 Pilt                                           02/24/90 ) : GCL ( --- A )                                                 Get-CurrLine CurrLine @ ;                                       : P-KRIIPS ( mode pikkus nihe --- )                             GCL + DUP Kriips? IF 2DROP DROP ELSE ROT ROT Kriips THEN ;      : Tagasi ( --- )                                                BEGIN Tipp @ DUP 32 + @ DUP 0= IF DROP 28 + @ Tipp ! 0                                         ELSE Tipp ! DROP     -1                                         THEN                             UNTIL Mix- ;                                                    : OMAR ( --- omarea-index )                                     Tipp @ 60 + @ 2 * 1 - @160 0 <> IF 2 + THEN                     @28 @60 <> IF 2 + THEN ;                                        : NABA ( --- pealkirjarea-index )                               @116 1- OMAR - 2 / OMAR + ;                                     -->                                                             \ #29 ortogon                                        03/07/90 ) : PrintNumber ( x --- )                                         0 <# # #S #> DUP >R J@RG @ SWAP CMOVE R> J@RG +! ;              : PrintPoint 46 J@RG @ C! 1 J@RG +! ;                           : PrintNumbers ( >subr --- )                                    GET-LIMITS PrintNumber PrintPoint PrintPoint PrintNumber ;      : PrintName ( >type --- )                                       ?Nimi J@RG @ SWAP 2DUP DUP                                      C@ 31 AND SWAP 1+ ROT ROT CMOVE                                 C@ 31 AND SWAP 1- + DUP C@ 128 - SWAP DUP J@RG ! C! 1 J@RG +! ; : PrintEnum ( >type --- )                                       DUP 12 + @ SWAP 8 + @ DUP 16 + @ SWAP 12 + @                    0 DO OVER I =                                                        IF DUP Tipp @ 36 + @ 32 + !                                        PrintName DROP LEAVE ELSE 16 + @ THEN                     LOOP ;                                        -->             \ #30 ortogon                                        03/07/90 ) : PrintNames ( >subr --- )                                      DUP 12 + @ PrintEnum PrintPoint PrintPoint                          16 + @ PrintEnum ;                                          : PrintSubr ( >type --- )                                       DUP 16 + @ ?T 10 = IF PrintNames ELSE PrintNumbers THEN ;       : PrintLabel ( >type --- )                                      DUP ?T CASE 10 OF PrintEnum  ENDOF                                          11 OF PrintSubr  ENDOF                                     ENDCASE ;                                                : Label>Stack ( >casevahe --- 23 >l1...>ln )                    23 SWAP                                                         BEGIN DUP 8 + @ SWAP 12 + @ DUP 0=                                IF DROP -1 ELSE 0 THEN                                        UNTIL ;                                                         -->                                                             \ #31 ortogon                                        03/07/90 ) : PrintLabels ( >Labels --- )                                   Tipp @ 52 + @ Tipp @ 10 + H@ - 2 / ?VAD + CurrLine @ + J@RG !   Label>Stack                                                     BEGIN DUP 23 <> IF PrintLabel DUP 23 =                          IF DROP -1 ELSE 44 J@RG @ C! 1 J@RG +! 0 THEN                   THEN UNTIL ;                                                    : +SL Tipp @ 10 + H@ + Tipp @ 10 + H! ;                         : ?LLabel ( >type --- )                                         DUP ?T CASE 10 OF #SYMB? +SL          ENDOF                                 11 OF #SYMB? 2 * 2 + +SL  ENDOF                            ENDCASE ;                                                : ?SelektLaius ( >Labels --- )                                  BEGIN DUP 8 + @ ?LLabel 12 + @ DUP 0=                           IF DROP -1 ELSE 1 +SL 0 THEN UNTIL ;                            -->                                                             \ #32 ortogon                                        03/07/90 ) : MakeSelect ( >Case-vahe --- >Case-vahe )                      68 DECL DUP Tipp ! >R                                           Pesa @ R@ 12 + !                               ( sa reas      ) Puu @ 0= IF R@ Puu ! THEN                                       DUP R@ ! DUP 8 + @                             ( >pass        ) ?SelektLaius Tipp @ 10 + H@ 2 + DUP R@ 52 + @ > IF R@ 52 + !    ELSE DROP THEN R> DUP Viidad >Magasin DROP ;                    : V-PLK ( --- )                                                 CurrLine @ >R LineIndex @ >R Tipp @ 20 + @ 0=                   IF NABA LineIndex ! Get-CurrLine  THEN                          Tipp @ 10 + H@ 0=                                                 IF CurrLine @ Tipp @ 56 + @ ?VAD Tipp @ 52 + @ NimiKeskele      ELSE Tipp @ @ 8 + @ PrintLabels                                 THEN R> LineIndex ! R> CurrLine ! ;                           -->                                                             \ #33 ortogon                                        02/18/90 ) : makePuu ( >kirjetyyp --- )                                    Minx+ DUP 24 + @ SWAP 12 + @ 0                                  DO DUP ?T                                                         CASE 1 OF MakeTipp  Tipp @ @ ?TYPE DUP ?T 12 =                         IF SubArray  ELSE DROP THEN                    ENDOF          2 OF MakeTipp                                                        DUP MakeCRT  Minx+ 28 + @                                       BEGIN MakeSelect DUP 12 + @ DUP 0 <>                             IF MYSELF ELSE DROP                                             THEN 16 + @ DUP 0= IF DROP -1 ELSE 0 THEN                      UNTIL Minx-                                 ENDOF          3 OF NihE @ >R DUP 4 + @ NihE +! DUP MakeTipp                        8 + @ 12 + @ MYSELF R> NihE !               ENDOF      ENDCASE 16 + @ DUP 0= IF DROP LEAVE THEN                     LOOP Minx- ;                                            -->     \ #34 ortogon                                        02/18/90 ) : MakeVP ( --- )                                                ['] makePuu ['] MakePuu >BODY !                                 0 Pesa ! 0 Puu ! 1 Paxus ! 0 NihE ! @56 8 + @ ArrP @ 184 + !    @56 DUP ?T 13 = IF   MakePuu   Pesa @ A48 !                                     ELSE Make1Tipp 52 + @ A48 ! DROP                                THEN Puu @ A56 ! PeaPaxus                       Tipp @ A180 ! ;                                                 -->                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ #35 Pea                                            02/24/90 ) : J-KRIIPS ( mode pikkus nihe --- )                             GCL + ROT ROT Kriips ;                                          : JuttAlla ( --- )                                              1 LineIndex +! Get-CurrLine 1 Tipp @ 52 + @                     ?VAD P-KRIIPS 1 LineIndex -! Get-CurrLine ;                     : CaseJutt ( --- )                                              1 LineIndex +! Get-CurrLine 1 Tipp @ 52 + @ Tipp @ 24 + @       0= IF 1+ THEN ?VAD J-KRIIPS 1 LineIndex -! Get-CurrLine ;       -->                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ #36 Pea                                            02/24/90 ) : Raamid ( --- )                                                Tipp @ 24 + @ DUP 0 <>             ( Naaber ? )                   IF Tipp ! 1 ?VAD LineIndex @ 1- VERT-LINE                          Tipp @ 28 + @ Tipp !                                         ELSE DROP                                                       THEN                                                          Tipp @ 20 + @ 0 <>          ( Alla ? )                            IF JuttAlla Tipp @ @ ?T 2 =                                        IF 2 LineIndex +! CaseJutt 2 LineIndex -! Get-CurrLine          THEN                                                         THEN ;                                                        -->                                                                                                                                                                                                                                                             \ #37 Pea                                            02/24/90 ) : PeaPuu ( --- )                                                Raamid                                                          V-PLK Tipp @ 20 + @ DUP 0 <>          ( Alla ? )                  IF Tipp ! Minx+ 2 LineIndex +! Get-CurrLine  MYSELF                2 LineIndex -! Get-CurrLine Mix-                                Tagasi                           ( Yles )                    ELSE DROP                                                       THEN                                                          Tipp @ 24 + @ DUP 0 <>                ( Naaber ? )                IF Tipp ! MYSELF                                                ELSE DROP                                                       THEN ;                                                        -->                                                                                                                                                                                             \ #38 Pea                                            02/24/90 ) : PuuPea ( --- )                                                @56 DUP Tipp ! @ ?L 3 =                                             IF   2 LineIndex +! 0 Minx ! PATS @ Pagas !                          Get-CurrLine PeaPuu 2 LineIndex -! Get-CurrLine            THEN ;                                                      : PeaTriip 1 @108 @72 P-KRIIPS ;                                : ?PEANIMI ( --- )                                              1 LineIndex ! Get-CurrLine                                      @160 DUP 0 <> IF CurrLine @ SWAP @72 @108 NimiKeskele                            2 LineIndex ! PeaTriip 3 LineIndex !                            Get-CurrLine                                                 ELSE DROP                                                       THEN ;                                            -->                                                                                                                             \ #39 Pilt                                           02/25/90 ) : VERT-LINES ( --- )                                            @160 0 = IF 0 ELSE 2 THEN A112 !                                @64 @60 DUP 0 <> IF 1- 0 ?DO DUP I 4 * + @  SaD +! ( JV-vahed )                              1 SaD @ 0 VERT-LINE                                         LOOP                      ( JV-l“pp )                   ELSE 2DROP                                                      THEN                                           @60 DUP 0 <> IF 1- 4 * + @ SaD +! 0 SaD @ 0 VERT-LINE                        ELSE DROP                                                       THEN                                               ?PEANIMI @28 @60 <>                                              IF @48 SaD +! @40 @28 1- 4 * + @ 1- 0                            ?DO 1 SaD @ @112 VERT-LINE @48 SaD +! LOOP  ( last-index )     THEN ;                                                         -->                                                             \ #40 Pea                                            02/25/90 ) : MakeRaam ( --- )                                              @0 @76 0 0-RIDA @76 @0 + @156 1- 1                                  DO DUP 186 SWAP C! @76 + LOOP @76 @0 + @76 1- + @156 1- 1       DO DUP 186 SWAP C! @76 + LOOP                               2DROP                                                           @0 @156 1- @76 * + @76 0 n-RIDA                                 2DROP 2DROP ;                                                   : MakePilt ( --- )                                              MakeRaam  0 SaD ! VERT-LINES ;                                  : UusVeerg ( --- )                                              PuuPea @48 PATS +! ;                                            -->                                                                                                                                                                                                                                                             \ #41 Pea                                            02/22/90 ) : MultiScope ( >type >E --- )                                   SWAP 12 + @ 0 DO DUP ?Nimi                                                       CurrLine @ SWAP PATS @ @48 NimiKeskele                          UusVeerg 16 + @  ( next element )                            LOOP                                              DROP ;                                                          : MULTI-SSCOPE ( >type >basetype --- )                          OVER 20 + @ 12 + @ SWAP 16 + @ SWAP 0                             ?DO 16 + @ LOOP                                                 MultiScope ;                                                  : MULTISCOPE ( >indextype --- )                                 DUP 16 + @ MultiScope ;                                         -->                                                                                                                                                                                             \ #42 Pea                                            02/22/90 ) : NrKeskele ( A sarv vasak laius --- )                          1+ ROT - 2 / + + Pesa @                                         0 <# # #S #> ROT SWAP CMOVE ;                                   : ChKeskele ( A vasak laius )                                   2 / + + Pesa C@ SWAP C! ;                                       : NrPaika ( A --- )                                             Pesa @ 0 <# # #S #> ROT SWAP CMOVE ;                            : ChPaika ( A --- )                                             Pesa C@ SWAP C! ;                                               : MULTINUMBER ( >type >basetype --- )                           DROP DUP #SYMB? Sarv ! DUP 20 + @ 12 + @ Pesa !                 12 + @ 0 DO CurrLine @ Sarv @ PATS @ @48 NrKeskele                          UusVeerg  1 Pesa +!                                          LOOP ;                                                 -->                                                             \ #43 Pea                                            02/22/90 ) : MULTICHAR   ( >type >basetype --- )                           DROP DUP 20 + @ 13 + C@ Pesa C!                                 12 + @ 0 DO CurrLine @  PATS @ @48 ChKeskele                                UusVeerg  Pesa C@ 1+ Pesa C!                                 LOOP ;                                                 : MULTI-VAHEM ( >type >basetype --- )                           DUP ?T 6 = IF MULTICHAR ELSE MULTINUMBER THEN ;                 : MULTISUBRAN ( >indextype --- )                                DUP 16 + @ DUP ?T 10 = IF   MULTI-SSCOPE                                               ELSE MULTI-VAHEM                                                THEN ;                                   -->                                                                                                                                                                                                                                                             \ #44 Pea                                            02/22/90 ) : MULTIVEERG ( >indextype --- )                                 @56 @ ?L 3 <>                                                     IF   LineIndex @ @116 1- LineIndex ! 0 @76 0 P-KRIIPS                LineIndex ! Get-CurrLine                                   ELSE 1 LineIndex +! PeaTriip 1 LineIndex -! Get-CurrLine        THEN @72 PATS !                                               DUP ?T 10 = IF   MULTISCOPE                                                 ELSE MULTISUBRAN                                                THEN ;                                              -->                                                                                                                                                                                                                                                                                                                                                                                             \ #45 Pea                                            02/23/90 ) : NUL-INDEX ( --- )                                             0 Minx ! @72 DUP PATS ! Pagas ! @56 Tipp !                      PeaPuu @116 1- LineIndex ! 0 @76 0 P-KRIIPS ;                   : LAST-INDEX ( --- )                                            @44 @28 1- 4 * + @       ( viimase indexi tyyp )                MULTIVEERG                                                      @56 @ ?L 3 =                                                      IF @116 1- LineIndex ! 0 @76 0 P-KRIIPS                         THEN ;                                                        -->                                                                                                                                                                                                                                                                                                                                                                                             \ #46 Juhtveerud                                     02/26/90 ) : FILL-JV NOOP ;                                                : ?LI+ ( --- )                                                  @112 1+ @60 =                                                     IF ( 1 ) @52 LineIndex +! Get-CurrLine THEN ;                 : ?V-EL ( Vektor index --- A[i] )                               4 * + @ ;                                                       : NextJV ( --- )                                                @64 @112 ?V-EL SaD +! 1 A112 +!                                 FILL-JV 1 A112 -! @64 @112 ?V-EL SaD -! ;                       -->                                                                                                                                                                                                                                                                                                                                                                                             \ #47 Juhtveerud                                     02/26/90 ) : MULTI_NUMBER ( >type >basetype --- )                          DROP DUP 20 + @ 12 + @ Pesa !                                   12 + @ 0 DO CurrLine @ SaD @ + NrPaika                                      @112 1+ @60 <                                                       IF NextJV THEN                                              ?LI+ 1 Pesa +!                                               LOOP ;                                                 -->                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ #48 Juhtveerud                                     02/26/90 ) : Multi_Scope ( >type >E --- )                                  SWAP 12 + @ 0 DO DUP ?Nimi CurrLine @ SaD @ + SWAP                               MOVE-NAME @112 1+ @60 <                                             IF NextJV THEN                                              ?LI+ 16 + @                                                  LOOP                                              DROP ;                                                          : TRADE_MARK ( --- )                                            MARKBUFFER @ @76 BL FILL                                        @76 YORICK @ >=                                                   IF   MARKBUFFER @ @76 YORICK @ - 2 / + POOR                     ELSE MARKBUFFER @ @76 6 - 2 / + Q-SOFT                          THEN ;                                                        -->                                                                                                                             \ #49 Juhtveerud                                     02/26/90 ) : MULTI_CHAR   ( >type >basetype --- )                          DROP DUP 20 + @ 13 + C@ Pesa C!                                 12 + @ 0 DO CurrLine @ SaD @ + ChPaika @112 1+ @60 <                            IF NextJV THEN                                                 ?LI+ Pesa C@ 1+ Pesa C!                                   LOOP ;                                                 : MULTI_VAHEM ( >type >basetype --- )                           DUP ?T 6 = IF MULTI_CHAR ELSE MULTI_NUMBER THEN ;               -->                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ #50 Juhtveerud                                     02/26/90 ) : MULTI_SSCOPE ( >type >basetype --- )                          OVER 20 + @ 12 + @ SWAP 16 + @ SWAP 0                             ?DO 16 + @ LOOP Multi_Scope ;                                 : MULTI_SCOPE ( >indextype --- )                                DUP 16 + @ Multi_Scope ;                                        : MULTI_SUBRAN ( >indextype --- )                               DUP 16 + @ DUP ?T 10 = IF   MULTI_SSCOPE                                               ELSE MULTI_VAHEM                                                THEN ;                                   : MULTI_VEERG ( >indextype --- )                                DUP ?T 10 = IF   MULTI_SCOPE                                                ELSE MULTI_SUBRAN                                               THEN ;                                              -->                                                                                                                             \ #51 Juhtveerud                                     12/13/89 ) : fILL-JV ( --- )                                               @44 @112 4 * + @ MULTI_VEERG ;                                  : MakeJV ( --- )                                                ['] fILL-JV ['] FILL-JV >BODY !     ( for recursion ! )         @116 LineIndex ! Get-CurrLine 1 SaD ! 0 A112 ! FILL-JV ;        : T-PLANNER ( --- )                                             @156 DUP 16 > IF DROP 16 THEN A148 !  ( n„htav ridade arv )     @76 DUP 75 > IF DROP 75 THEN A144 !   ( n„htav tabeli laius )   @144 @72 - A172 !                     ( n„htav maatrixi laius ) @148 @116 - 1- A176 !                 ( n„htav maatrixi #read ) ;                                                               -->                                                                                                                                                                                                                                                             \ #52 Chart handle                                   03/02/90 ) -->                                                             HEX                                                             : PEANIMI? @160 0 <>                                              IF Iy 1 1 H-WINDOW W-GOTOXY                                        ." Kas soovite veergude pealkirja? "                            REVERSE ." Y | N" REVERSE-OFF Iyo                               BEGIN KELL KEY CASE 4E OF 0 A160 ! EXIT ENDOF    ( N )                              59 OF          EXIT ENDOF    ( Y )                              6E OF 0 A160 ! EXIT ENDOF    ( n )                              79 OF          EXIT ENDOF    ( y )                               ( else ) 7 EMIT                                           ENDCASE                                          AGAIN                                                        THEN ;                                                        DECIMAL                                                         \ #53 MakeMakett                                     02/20/90 ) : MakeMakett ( --- )                                            @16 @48 * 1+ DUP A108 !      ( maatriksi & pea laius )          @72 + A76 !  PURE?           ( maketirea pikkus )               @116 @20 @52 * + 1+ A156 !   ( ridade koguarv )                 T-PLANNER                    ( n„htav tabel )                   @156 1+ @76 * DUP A152 !     ( ä tabel )                        DECL DUP A0 !                ( teeb tabeli )                    @60 0= IF A8 ! ELSE DROP THEN @0 @152 ERASE                     @76 DECL DUP ArrP @ 192 + ! PRINTBUFFER !                       @76 DECL DUP ArrP @ 196 + ! EXPUHVER !                          @76 DECL DUP ArrP @ 200 + ! KRPUHVER !                          @76 DECL DUP ArrP @ 204 + ! MARKBUFFER !                        EXPUHVER @ @76 BL FILL      KRPUHVER @ @76 196 FILL             TRADE_MARK ;                                                    -->                                                             \ #54 MakeW                                          02/20/90 ) : MakeW ( --- )                                                 @44 @28 1- 4 * + @  #SYMB? 2 +       ( viimase indexi tyyp )    @48 2DUP > IF DROP ELSE SWAP DROP THEN                          A48 !                                ( ortogoni laius )         ( @56 48 + @ A52 !  )                  ( ortogoni paksus )      MakeMakett @60 0 <> IF MakeKorner THEN                          1 LineIndex ! Get-CurrLine MakePilt @28 @60 =                     IF   NUL-INDEX                                                  ELSE LAST-INDEX                                                 THEN                                                          @60 0 <> IF MakeJV THEN ;                                       ;S                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              