                                                                                                                                                                                                                                                                                                                                                 DATABASE for MODULA-2                                                                                                              Tartu University                                                                                                                  Ain Isotamm                                                                                                                                                                                                                                                                                                                                                                                        1989                                   \ #1 MDB-windows                                     07/12/82 ) -->                                                             : T-W-FULL T-WINDOW W-CLEAR T-WINDOW W-HOME                     REVERSE ." F1"  REVERSE-OFF Iy ." appi"     Iyo ."  "           REVERSE ." F2"  REVERSE-OFF Iy ." tyyp"     Iyo ."  "           REVERSE ." F3"  REVERSE-OFF Iy ." varu"     Iyo ."  "           REVERSE ." F4"  REVERSE-OFF Iy ." tabel"    Iyo ."  "           REVERSE ." F5"  REVERSE-OFF Iy ." fix"      Iyo ."  "           REVERSE ." F6" REVERSE-OFF Iy ." v" 132 EMIT ." rvid" Iyo ."  " REVERSE ." F7"  REVERSE-OFF Iy ." rida"     Iyo ."  "           REVERSE ." F8"  REVERSE-OFF Iy ." veerg"     Iyo ."  "          REVERSE ." F9"  REVERSE-OFF Iy ." nulli"    Iyo ."  "           REVERSE ." F10" REVERSE-OFF Iy ." taasta "  Iyo ;               -->                                                                                                                                                                                             \ #2 Variables                                       01/08/90 ) -->                                                             VARIABLE RIDA          VARIABLE IndeX     VARIABLE dFLAG        VARIABLE KUULUTUS  ( 0-pole, 1-v@ljas )   VARIABLE ElTyyp       VARIABLE ESIMENE       VARIABLE VIIMANE   VARIABLE tABEL        VARIABLE YLARIDA       VARIABLE ALARIDA   VARIABLE SAHVER       VARIABLE KURSV         VARIABLE inSert  ( VARIABLE KIRJETYYP )  VARIABLE Reevers     ( VARIABLE KIRJE )   VARIABLE ORIGINAAL    VARIABLE Kurss         VARIABLE Ridda     VARIABLE Aits         -->                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ #3 Service                                         01/08/90 ) : TF-SWAP ( t --- f ) IF 0 ELSE -1 THEN ;                       : NEXTVIIT ( ---  tf )                                          AIT @ 12 + @ DUP 0 <> IF AIT ! -1 THEN ;                        : PREVVIIT ( ---  tf )                                          AIT @ 8 + @ DUP 0 <> IF AIT ! -1 THEN ;                         : IS-JATK? ( --- tf )                                           AIT @ @ 0= ;                                                    : NEXT-VIIT ( --- >next tf )                                    AIT @ 12 + @ DUP 0 <> IF  -1 THEN ;                             : IS-RERO? ( --- tf)                                            GET-MKT 4 + @ 0 <> ;                                            : MDB-HELP NOOP ;                                               -->                                                                                                                                                                                             \ #4 Service                                         12/22/89 ) : GET-ENVA NOOP ;                                               : SCOPE-SUPPORT NOOP ;                                          : GET-BEGADDR ( --- v@@rtusv@lja algusaadress )                 IS-JATK? IF AIT @ >R BEGIN PREVVIIT DROP IS-JATK? TF-SWAP                            UNTIL GET-MKT 20 + @ R> AIT !                       ELSE GET-MKT 20 + @                                             THEN ;                                                 : SCROLL-UPLINE REC-WINDOW W-UP REC-WINDOW W-LLC ;              : SCROLL-DOWNLINE REC-WINDOW W-DOWN REC-WINDOW W-HOME ;         : ENUMLIST? ReWri @ 0 >                                         IF AIT @ 16 + @ ?T 10 = IF GET-ENVA THEN THEN ;                 : PUT-R-SPACES GET-MKT 16 + @ REVERSE SPACES REVERSE-OFF ;      : PUT-SPACES GET-MKT 16 + @ SPACES ;                            -->                                                                                                                             \ #5 Spaces, Show value                              12/22/89 ) : VA-SPAN ( --- Value_address Span )                            GET-MKT DUP 4 + @ RIDA @ REC-WINDOW W-GOTOXY                    DUP 20 + @ SWAP 16 + @  ;                                       : SHOW-R-VALUE ( --- )                                          DARK @ 0= IF VA-SPAN REVERSE TYPE REVERSE-OFF THEN ;            : SHOW-VALUE ( --- )                                            DARK @ 0= IF VA-SPAN TYPE THEN ;                                : K-RIDA  ( --- tf )                                            GET-MKT 4 + @ DUP 0 <>                                          IF DUP KURSV ! RIDA @ REC-WINDOW W-GOTOXY -1 THEN ;             : PREV-VIIT ( ---  tf )                                         AIT @ 8 + @ DUP 0 <> IF DROP -1 THEN ;                          -->                                                                                                                                                                                             \ #6 Cursor control                                  12/22/89 ) : VALUESHOW Reevers @ 0=                                           IF PUT-SPACES SHOW-VALUE                                        ELSE PUT-R-SPACES SHOW-R-VALUE K-RIDA DROP THEN ;            : S-R-V K-RIDA IF SHOW-R-VALUE  K-RIDA DROP THEN ;              : S-V K-RIDA IF SHOW-VALUE THEN ;                               : F-RIDA  ( kursor v@@rtusv@lja lo~ppu )                        GET-MKT 12 + @ DUP KURSV ! RIDA @ REC-WINDOW W-GOTOXY ;         : RIDA+ 1 RIDA +! ;                                             : RIDA- 1 RIDA -! ;                                             : SA-CURSOR ( --- nihe )                                        KURSV @ GET-MKT 4 + @ - ;                                       : CHAR-ADDRESS ( --- a )                                        SA-CURSOR GET-MKT 20 + @ + ;                                    -->                                                                                                                             \ #7 Snoop                                           12/22/89 ) : SNOOP-#SYMB ( --- n )                                         GET-MKT DUP 20 + @ SWAP 24 + @ 0                                  DO DUP C@ 0= IF   LEAVE                                                      ELSE 1+                                                         THEN                                               LOOP GET-MKT 20 + @ - ;                                       : LAST-ADDRESS ( --- addr )                                     GET-MKT 20 + @ SNOOP-#SYMB + 1- ;                               -->                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ #8 Line & scroll                                   11/14/83 ) : GET-MF ( --- >makett >field )                                 AIT @ DUP 4 + @ SWAP  @ ;                                       : NAME-SHOW ( >makett >field --- )                              DUP 0 >                                                           IF 4 - BODY> >NAME SWAP DUP @ SPACES 4 + @ 0=                        IF Iy .NAME Iyo                                                 ELSE .NAME ." = "  VALUESHOW                                    THEN                                                       ELSE 2DROP VALUESHOW                                            THEN ;                                                        : LINEDOWN   ( scroll down a new line )                         GET-MF SCROLL-DOWNLINE NAME-SHOW ;                              : LINEUP     ( scroll up a new line )                           GET-MF SCROLL-UPLINE NAME-SHOW ;                                -->                                                             \ #9 Show restriction                                02/08/90 ) : ?Nimi ( >pass --- >NAME )                                     4 - BODY> >NAME ;                                               : >>NUMBER ( x --- )                                            0 <# # #S #> TYPE ;                                             : >>S-NUMBER ( x --- )                                          DUP 0 < IF -1 * 045 EMIT THEN >>NUMBER ;                        : >>SH-ENUM ( >pass --- )                                       AIT @ 16 + @ ?Nimi                                              DUP 1+ SWAP C@ 31 AND TYPE ."  " ;                              : >>STRING ( x --- )                                            DROP AIT @ 16 + @ ?T 10 = IF >>SH-ENUM                                                    ELSE DUP 13 + SWAP 12 + @ TYPE                                  THEN ;                                -->                                                                                                                             \ #10 Show restriction                               02/08/90 ) : >>EN-LIMITS ( >T10-type --- )                                 DUP 16 + @ ?Nimi .NAME ." .."                                       20 + @ ?Nimi .NAME ;                                        : SHOW-T AIT @ 16 + @ ??TYPE DROP DUP ?L 9 <>                     IF ?Nimi .NAME ELSE DROP THEN ;                               : >>CHANGE AIT @ 20 + @ CASE 1 OF >>S-NUMBER  ENDOF                                          2 OF >>NUMBER    ENDOF                                          3 OF >>NUMBER    ENDOF                                          5 OF             ENDOF                                          6 OF >>STRING    ENDOF                                          7 OF >>STRING    ENDOF                                      ENDCASE ;                              -->                                                                                                                                                                                             \ #11 Show restriction                               02/08/90 ) : GET-LIMITS ( >type --- max min )                              DUP 24 + @ 12 + @ SWAP 20 + @ 12 + @ ;                          : SHOW-SUBRANGE AIT @ 16 + @ GET-LIMITS ."   [ " >>CHANGE       ." .." >>CHANGE ." ] OF " SHOW-T ;                              : SHOW-Type ( >eltype --- )                                     DUP ?L 9 <> IF ?Nimi .NAME                                                  ELSE DROP ElTyyp @ DUP ?L 8 =                                      IF ?Nimi .NAME                                                  ELSE DROP                                                       THEN                                                         THEN ;                                              -->                                                                                                                                                                                                                                                             \ #12 Show restriction                               02/08/90 ) : sHOW-INDEX ( >massiivityyp --- >elemendityyp )                DUP 16 + @ DUP ?L 8 =                                               IF ?Nimi .NAME                                                  ELSE DROP DUP ?INDEXTYPE DUP ?T                             CASE                                                             6 OF GET-LIMITS ."  [ " >>NUMBER ." .." >>NUMBER ." ] " ENDOF  10 OF ." [ " >>EN-LIMITS ." ] "                          ENDOF  11 OF GET-LIMITS ."  [ " >>NUMBER ." .." >>NUMBER ." ] " ENDOF  ENDCASE                                                             THEN DUP 12 + @ ElTyyp ! ?ELTYPE DUP ?L 11 <>                      IF DUP ?T 12 = IF ." ," MYSELF  THEN                            THEN ;                                                   -->                                                                                                                                                                                             \ #13 Show restriction                               02/08/90 ) : SHOW-ARRAY ." ARRAY" AIT @ 16 + @                             ."  " sHOW-INDEX ." OF " SHOW-Type ;                            : SHOW-REST AIT @ 16 + @ ?T 11 = IF SHOW-SUBRANGE                                                ELSE ." TYPE = " SHOW-T                                         THEN ;                         : SHOW-SCOPE AIT @ 16 + @ ." ( " >>EN-LIMITS ." ) " ;           : SHOW-POINTER AIT @ 16 + @ 12 + @                              ." POINTER TO " ?Nimi .NAME ;                                   -->                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ #14 Show restriction                               02/08/90 ) : Show-Descr   ( [AIT @ @ ] --- F2 - funktsioon )               2 2 H-WINDOW W-GOTOXY Iy                                        ( AIT @ @ ) DUP 0 > IF ?Nimi .NAME ."  : " ELSE DROP THEN       AIT @ 16 + @ ?T CASE  8 OF SHOW-POINTER          ENDOF                               10 OF SHOW-SCOPE    SHOW-T  ENDOF                               11 OF SHOW-SUBRANGE         ENDOF                               12 OF SHOW-ARRAY            ENDOF                               ( else ) SHOW-T                                            ENDCASE Iyo ;                                   : sD? dFLAG @ 1 = IF 2 2 H-WINDOW W-GOTOXY 57 0 DO 32 EMIT LOOP AIT @ @ Show-Descr K-RIDA DROP THEN ;                           : SHOW-DESCR dFLAG @ 1 XOR dFLAG ! sD? ;                                                                                        -->                                                                                                                             \ #15 Desactivate                                    01/11/90 ) : UP-DESACT ( --- )                                             AIT @ 8 + @ 0 > IF AIT @ @ 0 <> IF K-RIDA                                          IF SHOW-VALUE GET-MKT 8 + @ 1 >                                   IF AIT @ >R RIDA @ >R                       BEGIN RIDA @ ALARIDA @ <                                         IF AIT @ 12 + @ DUP 0 <>                                         IF DUP @ 0=                                                       IF AIT ! RIDA+ SHOW-VALUE  0                                    ELSE DROP -1                                                    THEN                                                          ELSE DROP -1                                                    THEN                                                           ELSE -1 THEN                                                   UNTIL R> RIDA ! R> AIT !                                         THEN THEN     THEN            THEN ;     -->                  \ #16 Desactivate                                    11/14/83 ) : DOWN-DESACT AIT @ 12 + @ DUP 0 <>                                IF @ 0 <>                                                          IF AIT @ >R RIDA @ >R K-RIDA IF SHOW-VALUE THEN                    BEGIN RIDA @ YLARIDA @ >                                          IF AIT @ 8 + @ DUP @ 0=                                            IF    AIT ! RIDA- SHOW-VALUE                  0                 ELSE  AIT ! RIDA- K-RIDA IF SHOW-VALUE THEN  -1                 THEN                                                         ELSE -1                                                         THEN                                                           UNTIL R> RIDA ! R> AIT !                                    THEN                              ( alluv on jatkurida )      ELSE DROP                                                       THEN ;                              ( alluvat pole )        -->                                                             \ #17 Longfield checking                             01/10/90 ) : DOWN-LONG? ( --- tf )                                         AIT @ 12 + @ DUP 0= IF DROP 0                                                       ELSE @ 0=                                                          IF -1                                                           ELSE GET-MKT 8 + @ 1 >                                          THEN                                                         THEN ;                                      : UP-LONG? ( --- tf )                                           AIT @ @ 0 > IF 0 ELSE -1 THEN ;                                 : LONG-CHECK  ( --- tf )                                        AIT @ 12 + @ DUP 0= IF DROP 0 ELSE @ 0= IF -1 ELSE 0 THEN THEN  ;                                                               : IS-LONG? AIT @ @ 0= GET-MKT 8 + @ 1 > OR ;                    -->                                                                                                                             \ #18 Desactivate                                    01/10/90 ) : DESACT-DOWN                                                    RIDA @ >R AIT @ >R ALARIDA @ RIDA @ - DUP 0 <>                    IF 0 DO AIT @ 12 + @ DUP 0=                                          IF DROP LEAVE                                                   ELSE DUP @ 0=                                                     IF AIT ! RIDA+ SHOW-VALUE                                       ELSE DROP LEAVE                                                 THEN                                                          THEN                                                            LOOP                                                       THEN R> AIT ! R> RIDA ! K-RIDA DROP ;                        -->                                                                                                                                                                                                                                                             \ #19 Desactivate                                    11/14/83 ) : DESACT-UP                                                      RIDA @ >R AIT @ >R RIDA @ YLARIDA @ - DUP 0 <> IF 0               ?DO AIT @ 8 + @ DUP 0=                                               IF DROP LEAVE                                                   ELSE AIT ! RIDA- IS-LONG?                                         IF SHOW-VALUE                                                   ELSE LEAVE                                                      THEN                                                          THEN                                                       LOOP THEN R> AIT ! R> RIDA ! K-RIDA DROP ;                   -->                                                                                                                                                                                                                                                                                                                             \ #20 Desactivate                                    01/10/90 ) : DESACT                                                        K-RIDA                                                          IF SHOW-VALUE IS-LONG?                                             IF DESACT-DOWN RIDA @ YLARIDA @ >                                 IF AIT @ @ 0=                                                      IF DESACT-UP                                                    THEN                                                         THEN                                                          THEN                                                         THEN ;                                                          -->                                                                                                                                                                                                                                                                                                                             \ #21 Activate                                       01/10/90 ) : ACT-DOWN                                                       RIDA @ >R AIT @ >R ALARIDA @ RIDA @ - DUP 0 >                   IF 0 ?DO AIT @ 12 + @ DUP 0=                                           IF DROP LEAVE                                                   ELSE DUP @ 0=                                                     IF AIT ! RIDA+ SHOW-R-VALUE                                     ELSE DROP LEAVE                                                 THEN                                                          THEN                                                          LOOP                                                       ELSE DROP                                                       THEN R> AIT ! R> RIDA ! K-RIDA DROP ;                          -->                                                                                                                                                                                             \ #22 Activate                                       11/14/83 ) : ACT-UP                                                        RIDA @ >R AIT @ >R RIDA @ YLARIDA @ - DUP 0 >                    IF 0 ?DO AIT @ 8 + @ DUP 0=                                             IF DROP LEAVE                                                   ELSE AIT ! RIDA- IS-LONG?                                         IF SHOW-R-VALUE                                                 ELSE LEAVE                                                      THEN                                                          THEN                                                         LOOP                                                       ELSE DROP                                                       THEN R> AIT ! R> RIDA ! K-RIDA DROP ;                          -->                                                                                                                                                                                             \ #23 Line up                                        08/07/91 ) : YLES    ( kursor eelmisele reale )                            UP-DESACT  RIDA @ YLARIDA @ =                                     IF AIT @ 8 + @ DUP 0 <>                                            IF DUP ESIMENE ! AIT ! LINEDOWN ALARIDA @ 15 =                   IF VIIMANE @ 8 + @ VIIMANE !                                    ELSE ALARIDA @ 1+ ALARIDA ! THEN                                  K-RIDA 0= IF MYSELF THEN S-R-V  UP-LONG? IF MYSELF THEN      ELSE DROP                                                       THEN                                                         ELSE RIDA- AIT @ 8 + @ AIT ! K-RIDA                                IF S-R-V UP-LONG? IF MYSELF THEN                                ELSE MYSELF                                                     THEN                                                         THEN  AIT @ @ 0 <> IF sD? THEN ;                              -->                                                             \ #24 Line down                                      11/14/83 ) : ALLA K-RIDA IF DOWN-DESACT THEN                               RIDA @ ALARIDA @ =                                                IF AIT @ 12 + @ DUP 0 <>      ( p@ris viimane? )                   IF DUP VIIMANE ! AIT ! LINEUP ESIMENE @ 12 + @ ESIMENE !           K-RIDA 0= IF MYSELF THEN                                        S-R-V ( DOWN-LONG? IF MYSELF THEN )                          ELSE DROP K-RIDA DROP          ( viimane! j@@b aktiivsex )      THEN                                                         ELSE RIDA+ AIT @ 12 + @ AIT ! K-RIDA ( pole ekraani viimane )    IF   S-R-V IS-LONG? IF  ACT-DOWN K-RIDA DROP THEN               ELSE MYSELF                                                     THEN                                                           THEN  AIT @ @ 0 <> IF sD? THEN ;                              -->                                                                                                                             \ #25 Activate                                       01/10/90 ) : ACTIVATE                                                      K-RIDA                                                          IF SHOW-R-VALUE K-RIDA DROP IS-LONG?                               IF ACT-DOWN AIT @ @ 0=                                            IF ACT-UP                                                       THEN                                                          THEN                                                         ELSE RIDA @ 0=                                                     IF ALLA THEN                                                 THEN ;                                                          -->                                                                                                                                                                                                                                                                                                                             \ #26 Message control, input check                   01/10/90 ) : AFISH                                                         CURSOR-OFF ."  " REVERSE                                        Iy 17 EMIT 205 EMIT 188 EMIT Iyo REVERSE-OFF                    1 KUULUTUS ! BEGIN KEY DROP EXIT AGAIN ;                        : AFISH-MAHA                                                    KUULUTUS @ 0 > IF 2 2 H-WINDOW W-GOTOXY                         57 2 DO 32 EMIT LOOP 0 KUULUTUS ! sD? CURSOR-ON                 KURSV @ RIDA @ REC-WINDOW W-GOTOXY THEN ;                       : CPunktE ( x --- x tf )                                        DUP DUP 46 = SWAP 69 = OR ;                                     : CaR ( x --- x tf )                                            DUP DUP 47 > SWAP 58 < AND ;                                    : C+- ( x --- x tf )                                            DUP DUP 43 = SWAP 45 = OR                                         IF -1 ELSE CaR THEN ;                    -->                  \ #27 Input check                                    11/14/83 ) : InT ( x --- x tf )                                            GET-MKT 4 + @ KURSV @ =                                           IF C+- ELSE CaR THEN ;                                        : ReA ( x --- x tf )                                            CaR IF -1 ELSE C+- IF -1 ELSE CPunktE THEN                          THEN ;                                                      : Symb-Check ( x --- x tf )                                     AIT @ 20 + @ CASE 1 OF InT ENDOF                                                  2 OF CaR ENDOF                                                  3 OF CaR ENDOF                                                  5 OF ReA ENDOF                                                           0          ( false )                              ENDCASE ;                                          -->                                                                                                                             \ #28 LineOut, ScreenOut.                            01/23/90 ) : LINEOUT                                                       0 RIDA @ REC-WINDOW W-GOTOXY GET-MF NAME-SHOW ;                                                                                 : SCREENOUT                                                     REC-WINDOW W-CLEAR 0 Reevers ! 0 YLARIDA ! AIT @ ESIMENE !      16 0 DO I RIDA ! LINEOUT NEXT-VIIT                                      IF AIT !                                                        ELSE  LEAVE                                                     THEN                                                         LOOP                                                       RIDA @ ALARIDA ! NEXT-VIIT IF DROP PREVVIIT DROP THEN           AIT @ VIIMANE ! ESIMENE @ AIT !                                 0 RIDA ! ACTIVATE ;                                             : PILTETTE JUURIK @ AIT ! sD? CURSOR-ON SCREENOUT ;             -->                                                             \ #29 Longleft, longright                            01/03/90 ) : GO-LEFT ( --- )                                               AIT @ @ 0 >                                                       IF 7 EMIT                                                       ELSE YLES 74 DUP KURSV ! RIDA @ REC-WINDOW W-GOTOXY             THEN ;                                                        : GO-RIGHT ( --- )                                               ALLA AIT @ @ 0=                                                   IF  GET-MKT 4 + @ DUP KURSV ! RIDA @ REC-WINDOW W-GOTOXY        ELSE YLES F-RIDA 7 EMIT                                         THEN ;                                                       -->                                                                                                                                                                                                                                                                                                                             \ #30 Left & right                                   12/22/89 ) : VASAKULE  ( kursor v@@rtusv@ljal vasakule )                   GET-MKT 4 + @  ( vasak piir )                                   KURSV @ =                                                         IF GO-LEFT                                                      ELSE 1 KURSV -! KURSV @ RIDA @ REC-WINDOW W-GOTOXY              THEN ;                                                        : PAREMALE  ( kursor v@@rtusv@ljal paremale )                   GET-MKT 12 + @ KURSV @ <=                                         IF LONG-CHECK                                                      IF GO-RIGHT ELSE KURSV @ RIDA @ REC-WINDOW W-GOTOXY THEN     ELSE 1 KURSV +! KURSV @ RIDA @ REC-WINDOW W-GOTOXY              THEN ;                                                        -->                                                                                                                                                                                             \ #31 Page: up & down, begin & end                   11/14/83 ) : LK-UP ( scroll up a new page )                                DESACT YLARIDA @ RIDA !   ESIMENE @ AIT ! K-RIDA DROP           AIT @ 8 + @  0 <>                                                 IF 16 0 DO PREVVIIT 0= IF LEAVE THEN LOOP SCREENOUT             THEN sD? ACTIVATE ;                                           : LK-BEGIN ( lk. esimesele kursor )                             DESACT YLARIDA @ RIDA !   ESIMENE @ AIT !  sD? K-RIDA             IF ACTIVATE ELSE NEXT-VIIT IF ALLA ACTIVATE THEN THEN ;       : LK-DOWN ( scroll down a new page )                            DESACT ALARIDA @ RIDA ! VIIMANE @ AIT !  K-RIDA DROP            AIT @ 12 + @ DUP 0 <>                                             IF AIT ! SCREENOUT                                              ELSE DROP                                                       THEN sD? ACTIVATE ;                                           -->                                                             \ #32 Scroll, cursor control                         01/03/90 ) : REC-BEGIN  ( aktiivseks kirje esimene v@li )                  PILTETTE ;                                                      : REC-END    ( aktiivseks kirje viimane v@li )                  BEGIN LK-DOWN AIT @ 12 + @ 0=                                   UNTIL sD? ACTIVATE ;                                            : F-BEGIN  ( kursor v@lja algusse )                             AIT @ @ 0= IF YLES MYSELF ELSE K-RIDA DROP THEN ;               : F-END  ( kursor v@lja loppu )                                 AIT @ 12 + @ 0=                                                   IF F-RIDA                                                       ELSE AIT @ 12 + @ @ 0= IF ALLA MYSELF ELSE F-RIDA THEN          THEN ;                                                        : GOTO-NEXT F-BEGIN AIT @ >R GET-MKT 8 + @ 0 DO ALLA LOOP       R> AIT @ <> IF sD? ENUMLIST? THEN ;                             -->                                                             \ #33 Cursor control                                 01/03/90 ) : F-V-END  ( cursor -> value-end )                              SNOOP-#SYMB GET-MKT 16 + @ >                                       IF ALLA MYSELF                                                  ELSE SNOOP-#SYMB DUP GET-MKT 16 + @ =                                IF DROP GET-MKT 12 + @                                          ELSE GET-MKT 4 + @ +                                            THEN DUP KURSV ! RIDA @ REC-WINDOW W-GOTOXY                THEN ;                                                       : NEXT-ATOM ( --- tf )                                          AIT @ 12 + @ DUP 0 <>                                             IF AIT ! BEGIN AIT @ DUP @ 0=                                             IF 12 + @ DUP AIT ! 0= ELSE DROP -1 THEN                       UNTIL AIT @ 0=                                         ELSE DROP -1                                                    THEN ;       -->                                              \ #34 Screen vary                                    02/06/90 ) : =I/C  ( key >selektor --- tf )                                12 + @ = ;                                                      : Inset?  ( key >selektor --- tf )                              12 + @ IN 0= 0= ;                                               : Insubr?  ( key >selektor --- tf )                             DUP   12 + @ 12 + @     ( alapiir )                             SWAP  16 + @ 12 + @     ( ylapiir )                             2 PICK >= SWAP ROT <= AND ;                                     : S-NEXT-ATOM ( --- tf )                                        AIT @ 32 + @ DUP 0 <>                                             IF AIT ! BEGIN AIT @ DUP @ 0=                                             IF 32 + @ DUP AIT ! 0= ELSE DROP -1 THEN                       UNTIL AIT @ 0=                                         ELSE DROP -1                                                    THEN ;       -->                                              \ #35 Screen vary                                    02/06/90 ) : OTSI_AIT  ( >pass --- )                                       BEGIN DUP S-NEXT-ATOM DROP AIT @ @ = UNTIL DROP ;               : CR_NEXT ( M --- tf )                                          20 + @ 16 + @ DUP 0 <>          ( Caseroot-naaber )               IF OTSI_AIT -1                                                  THEN ;                                                        : T@IS_ALT ( M --- tf )         ( otsib mittetyhja altern. )    BEGIN DUP 12 + @ DUP 0 <>                                         IF 24 + @ OTSI_AIT DROP -1 -1                                   ELSE DROP 16 + @ DUP 0 <>                                       THEN                                                          UNTIL ;                                                         -->                                                                                                                                                                                             \ #36 Screen vary                                    02/06/90 ) : PREV-AIT AIT @ 28 + @ AIT ! ;                                 : ALTERN_END ( M --- tf )                                       DUP 16 + @ DUP 0 <>                                               IF T@IS_ALT 0= IF CR_NEXT ELSE DROP -1 THEN                     ELSE DROP CR_NEXT                                               THEN DUP IF PREV-AIT THEN ;                                   : SABAVIIDAD ( >cr-naabri-pass --- )                            ( sahver <==> cr-naaber )                                       DUP 0= IF  SAHVER @ 12 + !    ( alternatiiviga lopeb kirje )           ELSE OTSI_AIT SAHVER @  AIT @ 8 + !                                           AIT @ SAHVER @ 12 + !                             THEN ;                                                   -->                                                                                                                                                                                             \ #37 Screen vary                                    02/06/90 ) : Variant ( >M --- )                                            AIT @ @ 16 + @ >R                ( caseroot-naabri pass )       AIT @ SAHVER !                   ( caseroot )                   DUP 12 + @ DUP 0 <>              ( voca-vahetase ? )            IF 24 + @ OTSI_AIT SAHVER @ AIT @ 8 + ! AIT @ SAHVER @ 12 + !      ALTERN_END IF AIT @ SAHVER ! R> SABAVIIDAD                                 ELSE R> DROP   ( kirje lopp )                                   THEN                                              ELSE DROP DROP R> SABAVIIDAD  ( tyhi alampuu, ylemus SAHVERis ) THEN ;                                                          -->                                                                                                                                                                                                                                                                                                                             \ #38 Screen vary                                    02/06/90 ) : SearchLabel ( >c --- >c tf )                                  DUP AIT @ 24 + @ KIRJE @ + @          ( index )                 SWAP 8 + @ DUP ?T                                                  CASE 1 OF =I/C     ENDOF                                             2 OF =I/C     ENDOF                                             3 OF =I/C     ENDOF                                             6 OF STR=     ENDOF                                             7 OF STR=     ENDOF                                             9 OF Inset?   ENDOF                                            10 OF =I/C     ENDOF                                            11 OF Insubr?  ENDOF                                            12 OF =I/C     ENDOF                                        ENDCASE ;                                                    -->                                                                                                                             \ #39 Screen vary                                    02/06/90 ) : SearchSelect  ( altern-tabel=M ---  M tf )                    DUP 8 + @ DUP 0 <>          ( >selektorite ahel )                 IF BEGIN SearchLabel IF DROP      -1 -1                                              ELSE 12 + @ DUP 0=     ( next-selector )                        THEN                                          UNTIL                                                        ELSE DROP                                                       THEN ;                                                        : VALI_VARIANT  ( Input caseroot )                              AIT @ DUP 32 + @ SWAP 12 + ! RIDA @ >R AIT @ DUP >R @ 28 + @     BEGIN SearchSelect IF Variant                        -1                            ELSE 16 + @ DUP 0= IF DROP -1 ELSE 0 THEN                       THEN                                         UNTIL ESIMENE @ AIT ! sD? SCREENOUT DESACT                            R> AIT ! R> RIDA ! ;                            -->      \ #40 Show Lines, Insert.                            01/06/90 ) : SHOW-LINES ( --- )                                            KURSV @ >R AIT @ >R                                             BEGIN AIT @ 12 + @ DUP 0 >                                        IF @ 0=                                                           IF AIT @ 12 + @ AIT ! RIDA+ 0 ELSE -1 THEN                    ELSE DROP -1 THEN                                             UNTIL                                                           BEGIN SHOW-R-VALUE AIT @ R@ <>                                    IF AIT @ 8 + @ AIT ! RIDA- 0 ELSE -1 THEN                     UNTIL R> DROP R> DUP KURSV ! RIDA @ REC-WINDOW W-GOTOXY ;       : LK-END ( lk. viimasele kursor )                               DESACT ALARIDA @ RIDA ! VIIMANE @ AIT ! sD? ACTIVATE F-BEGIN ;  : VAHELE inSert @ 1 XOR DUP inSert ! 0=                           IF CURSOR-ON ELSE INSERT-ON THEN ;                            -->                                                             \ #41 Get enum-value                                 01/30/90 ) : SEIFFE GET-MKT DUP 4 + @ 0 <>                                   IF DUP 20 + @ SWAP 24 + @ ERASE ELSE DROP THEN ;              : SH-ENUM ( >pass --- >pass )                                   SEIFFE DUP 12 + @ IndeX !   DUP   4 - BODY>  >NAME DUP 1+ SWAP  C@ 31 AND DUP 1- >R GET-MKT 20 + @ DUP >R SWAP CMOVE            R> R> + DUP C@ 128 - SWAP C! SHOW-R-VALUE                       DUP AIT @ 36 + @ 32 + ! ;                                       : FIRST-ENUM 8 + @ 16 + @ SH-ENUM ;                             : NEXT-ENUM ( >pass --- >pass' )                                DUP 16 + @ DUP 0= IF DROP FIRST-ENUM                                              ELSE SWAP DROP SH-ENUM THEN ;                 : SS-FUNC CASE LEFTARROW  OF FIRST-ENUM 0 ENDOF                                RIGHTARROW OF NEXT-ENUM  0 ENDOF                 F1 OF MDB-HELP 0 ENDOF F3 OF SCOPE-SUPPORT CURSOR-OFF -1 ENDOF  7 EMIT  0 ENDCASE ;      -->                                    \ #42 Get enum-value                                 01/30/90 ) : SHOW-SNOOP BEGIN KELL PCKEY                                       CASE 0        OF SS-FUNC IF EXIT THEN ENDOF                          NEWLINE  OF                 EXIT ENDOF                           ( Else )       7 EMIT                                     ENDCASE AGAIN ;                                             : gET-ENVA AIT @ @ 0 <>                                           IF AIT @ 16 + @ DUP ?T 10 =                                       IF CURSOR-OFF AIT @ 36 + @ 32 + @    ( aktiivne lli )             ( 16 + @ SH-ENUM ) SHOW-SNOOP 2DROP                             IndeX @ AIT @ 24 + @ KIRJE @ + ! CURSOR-ON                      AIT @ @ ?T 2 = IF VALI_VARIANT THEN ( GOTO-NEXT )            THEN                                                          THEN ;                                                        -->                                                                                                                             \ #43 Scope support                                  02/10/90 ) VARIABLE ScRida VARIABLE ScVeerg                                : GET-Element                                                   ScP @ 28 + @  DUP KUVAR ! IndeX @ 0 <>                            IF IndeX @ 0 ?DO 16 + @ LOOP KUVAR ! ELSE DROP                  THEN ;                                                        : S-GOTOXY                                                      ScVeerg @ 1- ScP @  @ * 1+       ( veeru sa )                   ScRida @ 1- ScP @ 16 + W-GOTOXY ;                               : J@rgmine? ( --- tf )                                          IndeX @ 1+ ScP @ 12 + @ < ;                                     : Eelmine? ( --- tf )                                           IndeX @ 0 > ;                                                   -->                                                                                                                                                                                             \ #44 Scope support                                  10/10/90 ) : Paremale? ( --- tf )                                          ScVeerg @ ScP @ 8 + @ < ;                                       : Vasakule? ( --- tf )                                          ScVeerg @ 1 > ;                                                 : TYPE-ENV ( --- )                                              KUVAR @ DUP ?L 7 =                                                   IF 4 - BODY> >NAME .NAME                                        ELSE DUP 8 + @ .NAME REVERSE-OFF H@ DUP 0 >                       IF SPACE INTENSITY . INTENSITY-OFF                              ELSE DROP 3 SPACES                                              THEN                                                          THEN ;                                                     : ACT-ENV S-GOTOXY GET-Element REVERSE TYPE-ENV REVERSE-OFF ;   : DESACT-ENV S-GOTOXY GET-Element TYPE-ENV ;                    -->                                                             \ #45 Scope support                                  02/10/90 ) : J@rgmine DESACT-ENV                                           J@rgmine? IF Paremale?                                                        IF 1 ScVeerg +! 1 IndeX +!                                      ELSE 1 ScVeerg ! 1 ScRida +! 1 IndeX +!                         THEN                                                        ELSE 1 ScVeerg ! 1 ScRida ! 0 IndeX !                           THEN ACT-ENV ;                                        -->                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ #46 Scope support                                  02/10/90 ) : V-Veerg ( --- c )                                             ScP @ 12 + @ ScP @ 8 + @ /MOD DROP ;                            : Eelmine DESACT-ENV                                            Eelmine?  IF Vasakule?                                                      IF 1 ScVeerg -! 1 IndeX -!                                      ELSE ScP @ 8 + @ ScVeerg ! 1 ScRida -! 1 IndeX -!               THEN                                                          ELSE ScP @ 12 + @ 1- IndeX ! ScP @ 4 + @ ScRida !                    V-Veerg DUP 0 <> IF ScVeerg !                                     ELSE DROP ScP @ 8 + @ ScVeerg ! THEN                     THEN ACT-ENV ;                                        : SET-Index  ( [#r-1]*#v + v-1 )                                ScRida @ 1-        ( r - 1 )                                    ScP @ 8 + @ *      ( [r-1]*#v )                                 ScVeerg @ 1- + IndeX ! ;               -->                      \ #47 Scope support                                  02/10/90 ) : Yles?  ( --- tf )                                             ScRida @ 1 > ;                                                  : Yles ScP @ 4 + @ 1 <>                                           IF DESACT-ENV Yles?                                               IF 1 ScRida -!                                                  ELSE ScP @ 4 + @ ScRida ! V-Veerg ScVeerg @ <                        IF 1 ScRida -! THEN                                        THEN SET-Index ACT-ENV                                        THEN ;                                                        -->                                                                                                                                                                                                                                                                                                                                                                                             \ #48 Scope support                                  02/10/90 ) : Alla? ( --- tf )                                              ScP @ 4 + @ DUP 1 =                                               IF DROP 0                                                       ELSE ScRida @ =                                                   IF 0                                                            ELSE ScP @ 12 + @ ScP @ 8 + @ /MOD ScRida @ =                      IF ScVeerg @ >=                                                 ELSE DROP -1                                                    THEN                                                         THEN                                                          THEN ;                                                        : Alla DESACT-ENV Alla?                                             IF 1 ScRida +!                                                  ELSE 1 ScRida !                                                 THEN SET-Index ACT-ENV ;      -->                           \ #49 Scope support                                  02/10/90 ) : FULL-SWINDOW ( --- )                                          1 ScRida !                                                      ScP @ 28 + @ KUVAR !                           ( 1. pass )      ScP @ 4 + @  0                                 ( #read )          DO ScP @ 8 + @ 0  1 ScVeerg !                ( #veerud )          DO S-GOTOXY TYPE-ENV 1 ScVeerg +!                                  KUVAR @ 16 + @ DUP KUVAR ! 0=                                   IF LEAVE THEN                                                LOOP 1 ScRida +! KUVAR @ 0= IF LEAVE THEN                     LOOP ;                                                        -->                                                                                                                                                                                                                                                                                                                             \ #50 Scope support                                  02/10/90 ) : SCOPE-FUNCT CASE LEFTARROW   OF Eelmine  ENDOF                                   RIGHTARROW  OF J@rgmine ENDOF                                   UPARROW     OF Yles     ENDOF                                   DOWNARROW   OF Alla     ENDOF                                   ALT-P       OF WriteScr ENDOF                                   ( else )        7 EMIT                                     ENDCASE ;                                         : SCOPE-CONTROL                                                 BEGIN KELL PCKEY CASE 0       OF SCOPE-FUNCT  ENDOF                                   NEWLINE OF EXIT         ENDOF                                   ( else )        7 EMIT                                     ENDCASE                                        AGAIN ;                                                         -->                                                                                                                             \ #51 Scope support                                  02/10/90 ) : SCOPe-SUPPORT ( --- )                                         AIT @ @  0 <> AIT @ 16 + @ ?T 10 = AND                          IF >vPUHVER                                                        AIT @ 36 + @ ScP ! CURSOR-OFF 4 Farbe ScP @ 24 + !              ScP @ 16 + W-BORDER                                             ScP @ 16 + W-CLEAR FULL-SWINDOW                                 0 IndeX ! 1 ScRida ! 1 ScVeerg ! ACT-ENV SCOPE-CONTROL          <vPUHVER CURSOR-ON                                              IndeX @ AIT @ 24 + @ KIRJE @ + ! KUVAR @ SH-ENUM DROP           AIT @ @ ?T 2 = IF VALI_VARIANT                                                 THEN GOTO-NEXT                                THEN ;                                                          -->                                                                                                                                                                                             \ #52 Erase                                          01/06/90 ) : NULLREC ( erase text-fields )                                 JUURIK @ AIT ! BEGIN SEIFFE NEXT-ATOM  UNTIL ;                  : SEEP ( erase text-field )                                     SEIFFE SHOW-LINES K-RIDA DROP ;                                 : PUHTAKS ( erase & show text-fields )                          KIRJE @ KIRJETYYP @ 8 + @ ERASE NULLREC  PILTETTE ;             : SOAP ( erase text-field until end )                           GET-MKT DUP 20 + @ SWAP 24 + @ SA-CURSOR                        DUP >R - SWAP R> + SWAP ERASE                                   SHOW-LINES KURSV @ RIDA @ REC-WINDOW W-GOTOXY ;                 : Delsymb 0 CHAR-ADDRESS C! BL REVERSE EMIT REVERSE-OFF         KURSV @ RIDA @ REC-WINDOW W-GOTOXY ;                            : DEL-SYMB  ( Backspace )                                       VASAKULE Delsymb ;                                              -->                                                             \ #53 Insert                                         12/13/89 ) : C!EMIT                                                        DUP REVERSE EMIT REVERSE-OFF CHAR-ADDRESS C! PAREMALE ;         : SHIFT-VALUE SNOOP-#SYMB GET-MKT 24 + @ <                      IF CHAR-ADDRESS  1 KURSV +! CHAR-ADDRESS      ( kust, kuhu )       GET-MKT 24 + @ SA-CURSOR -                 ( pikkus )           CMOVE> 1 KURSV -! C!EMIT SHOW-LINES                             KURSV @ RIDA @ REC-WINDOW W-GOTOXY                           ELSE DROP 7 EMIT                                                THEN ;                                                          : SHIFT-LINE  ( --- )                                           SNOOP-#SYMB GET-MKT 16 + @ <                                       IF SHIFT-VALUE                                                  ELSE LONG-CHECK IF SHIFT-VALUE ELSE DROP 7 EMIT THEN            THEN ;                                                       -->                                                             \ #54 Delete                                         01/06/90 ) : SYMB-MAHA ( --- )                                             1 KURSV +! CHAR-ADDRESS 1 KURSV -! CHAR-ADDRESS                 SNOOP-#SYMB 1- DUP >R SA-CURSOR - DUP 0 >                         IF   CMOVE 0 GET-MKT 20 + @ R> + C! SHOW-LINES                  ELSE 0=                                                            IF   Delsymb 2DROP R> DROP                                      ELSE 2DROP R> DROP 7 EMIT                                       THEN                                                         THEN ;                                                        : SET-CHAR ( symb --- )                                         GET-MKT 16 + @ 0 >                                              IF inSert @ 0 <>                                                  IF SHIFT-LINE ELSE C!EMIT THEN                                ELSE DROP 7 EMIT                                                THEN ;                                     -->                  \ #55 MDB-HELP, Afish                                01/12/90 ) : MDb-HELP ( --- )                                                CURSOR-OFF                                                      >vPUHVER SHOW-HELP CONTROLHELP  <vPUHVER                        KURSV @ RIDA @ REC-WINDOW W-GOTOXY                              CURSOR-ON ;                                                   : AFISH-BEGIN 7 EMIT 2 2 H-WINDOW W-GOTOXY Iy ;                 : AFISH-END   Iyo AFISH ;                                       : SHOW-FIX  ( --- )                                             0 1 F-WINDOW W-GOTOXY REVERSE ." Fikseeritud " .TIME            REVERSE-OFF ;                                                   : FIXEERI ( --- )                                               SHOW-FIX KIRJE @ ORIGINAAL @ KIRJETYYP @ 8 + @ CMOVE ;          : R-O! 7 EMIT AFISH-BEGIN ." Ainult lugemiseks" AFISH-END ;     : R-O? ReWri @ 0 = IF R-O! 0 ELSE -1 THEN ;                     : R-O  ReWri @ 1 = ;                                  -->       \ #56 Input                                          12/13/89 ) : CHAR-INP ( s --- )                                            DUP 20 < IF DROP 7 EMIT                                                  ELSE AIT @ 16 + @ ?T 10 =                                         IF DROP AFISH-BEGIN ." V" 132 EMIT 132 EMIT                        ." rtusvaru! Sobiv variant valige "                             205 EMIT 16 EMIT ."  abil " AFISH-END gET-ENVA               ELSE Symb-Check                                                   IF SET-CHAR                                                     ELSE DROP AFISH-BEGIN ." Ainult numbrid: "                           SHOW-REST AFISH-END                                        THEN                                                          THEN                                                          THEN ;                                                 -->                                                                                                                             \ #57 Convert                                        02/02/90 ) : BEGIN_FIELD ( --- )                                           BEGIN AIT @ @ 0= IF PREVVIIT IF 0 ELSE -1 THEN ELSE -1 THEN     UNTIL ;                                                         : A_OF_FIELD  ( --- addr )                                      AIT @ 24 + @ KIRJE @ + ;                                        : A_SOURCE  ( --- text-address )                                GET-MKT 20 + @ ;                                                : A_SOURCE" ( n --- n' text-address )                           GET-MKT 20 + @                                                   BEGIN DUP C@ BL = IF 1+ 0 ELSE -1 THEN UNTIL                   DUP GET-MKT 20 + @ - ROT SWAP - SWAP ;                          : STRING>  ( n --- )                                            AIT @ 16 + @ ?T 10 <>                                           IF A_SOURCE A_OF_FIELD ROT CMOVE THEN ;                         -->                                                             \ #58 Convert to inner                               02/02/90 ) : NUMBER>  ( n --- )                                            A_SOURCE" 0 1 ROT BASE @ >R DECIMAL DUP >R 1- CONVERT           DUP R> - 4 ROLL <                                                  IF AFISH-BEGIN C@ EMIT ."  pole number" AFISH-END 2DROP         ELSE DROP DROP A_OF_FIELD !                                     THEN R> BASE ! ;                                             : S-NUMBER>  ( n --- )                                          A_SOURCE" 0 1 ROT                                               BASE @ >R DECIMAL DUP C@ DUP 43 = SWAP 45 = OR                  IF ELSE 1- THEN DUP >R CONVERT DUP R@ - 4 ROLL <                   IF AFISH-BEGIN C@ EMIT ."  pole number" AFISH-END 2DROP         ELSE DROP DROP R> C@ 45 = IF NEGATE THEN A_OF_FIELD !           THEN R> BASE ! ;                                             -->                                                                                                                             \ #59 Restriction                                    02/03/90 ) : ERASE-VALUE PUT-SPACES GET-MKT DUP 20 + @ SWAP 24 + @ ERASE     SHOW-R-VALUE K-RIDA DROP                                        A_OF_FIELD AIT @ 16 + @ 8 + @ ERASE ;                         : C-SUBR ( >type --- tf )                                       GET-LIMITS A_OF_FIELD @ DUP >R <= SWAP R> >= AND                  IF    -1                                                        ELSE AFISH-BEGIN ." Vahemiku viga" SHOW-SUBRANGE                     AFISH-END ERASE-VALUE 0                                    THEN ;                                                        : CASE_JUUR? AIT @ @ ?T 2 = ;                                   -->                                                             : A-RAJA ( kuhu pikkus --- kuhu' pikkus )                       >R GET-MKT 24 + @ + R@ - R> ;                                   : PROPELLER GET-MKT DUP 4 + @ 0 <>                                IF DUP 20 + @ SWAP 24 + @ 32 FILL ELSE DROP THEN ;            \ #60 Restriction                                    02/03/90 ) : KITSENDUS ( --- tf )                                          AIT @ 16 + @ DUP ?T                                                 CASE 8 OF  ( C-POINT )   ENDOF                                       9 OF  ( C-SET )     ENDOF                                      11 OF    C-SUBR      ENDOF                                      ( else    DROP  )                                           ENDCASE ;                                                   : >ENUM-TEXT A_OF_FIELD @ AIT @ 16 + @ DUP 16 + @ SWAP 12 + @   0 DO OVER I =                                                       IF SH-ENUM ScP @ 32 + ! DROP LEAVE   ( jooksev pass ! )         ELSE 16 + @                                                     THEN                                                          LOOP ;                                                        -->                                                                                                                             \ #61 Convert to inner                               02/02/90 ) : CHANGE>  ( n --- )                                            AIT @ 20 + @ CASE 1 OF S-NUMBER>  ENDOF                                           2 OF NUMBER>    ENDOF                                           3 OF S-NUMBER>  ENDOF                                           5 OF            ENDOF     ( real )                              6 OF STRING>    ENDOF                                           7 OF STRING>    ENDOF ENDCASE ;               : FINN  ( --- tf )                                              AIT @ 16 + @ ?T 10 <>                                             IF AIT @ KUVAR ! BEGIN_FIELD                                       SNOOP-#SYMB DUP 0=                                                 IF DROP                  -1        ( tyhi v@li )                ELSE CHANGE> KITSENDUS                                          THEN KUVAR @ AIT !                                        ELSE -1 THEN ;                                -->             \ #62 Convert to text                                02/04/90 ) : >STRING  AIT @ 16 + @ ?T 10 =                                   IF >ENUM-TEXT                                                   ELSE A_OF_FIELD A_SOURCE GET-MKT 24 + @ CMOVE                   THEN ;                                                        : >NUMBER  A_OF_FIELD @ DUP 0 <>                                  IF 0 <# # #S #> A_SOURCE SWAP CMOVE                             ELSE DROP                                                       THEN ;                                                        : >S-NUMBER  A_OF_FIELD @ DUP 0 <>                              IF A_SOURCE >R DUP 0 <                                            IF -1 * 045 R@ C! R> 1+ >R S>D <# # #S #> R> SWAP CMOVE         ELSE 0 <# # #S #> R> SWAP CMOVE                                 THEN                                                          ELSE DROP                                                       THEN ;                             -->                          \ #63 Convert to text                                02/04/90 ) : >CHANGE ( --- )                                               AIT @ 20 + @ CASE 1 OF >S-NUMBER  ENDOF                                           2 OF >NUMBER    ENDOF                                           3 OF >NUMBER    ENDOF                                           5 OF            ENDOF     ( real )                              6 OF >STRING    ENDOF                                           7 OF >STRING    ENDOF ENDCASE ;               ;S                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              \ #23 Activate                                       01/10/90 ) : ACTIVATE                                                      K-RIDA                                                          IF SHOW-R-VALUE K-RIDA DROP IS-LONG?                               IF ACT-DOWN AIT @ @ 0=                                            IF ACT-UP                                                       THEN                                                          THEN                                                         ELSE RIDA @ 0= IF ALLA THEN                                     THEN ;                                                          -->                                                                                                                                                                                                                                                                                                                                                                                             : NIFF  ( --- )                                                 JUURIK @ DUP AIT ! ESIMENE !                                    BEGIN GET-MKT 4 + @ 0 <>                                          IF >CHANGE THEN CASE_JUUR? IF VALI_VARIANT THEN NEXT-ATOM     UNTIL ;                                                         : TAASTA NULLREC ORIGINAAL @ KIRJE @ KIRJETYYP @ 8 + @ CMOVE      NIFF PILTETTE ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               