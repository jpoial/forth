 MODULA-2 Print support. Parm in MASTER_RECORD:                 40 LIIK 1-regl, 2-emphasized, 3-double strike, 4-emph.&double s.41 KIRI 1-pica, 2-condensed, 3-enlarged, 4-enhanced             42 T@HED 1-pica, 2-elite                                        43 KURSIIV 1-no, 2-italic                                       44 ALLAKRIIPSUTUS 1-no, 2-yes                                   45 REAVAHE 1-1/8", 2-7/72", 3-1/6"                              46 PRINTER 1-kitsas, 2-lai      54 PAANI LAIUS                  47 LK-JAOTUS 1-yes, 2-no        55 #vabatextid                  48 KAHELE KYLJELE 1-no, 2-yes   56 #VABAD AATOMID               49 LEFT MARGIN                  57 PEANIMI?                     50 RIGHT MARGIN                 58-59 LK. PIKKUS 1/216-tollides 51 LK. PIKKUS                                                   52 BOTTOM MARGIN                                                53 LK. LAIUS SYMBOLITES                                                                                                         \ #1 Variables                                       05/13/90 ) 11 ARRAY PR-P                                                   VARIABLE #TOLLID      VARIABLE ReVa                             VARIABLE PiX  1 PiX ! ( tryki-opt-tabeli 1. rida )              11 ARRAY pikK                                                   4 0 pikK ! 4 1 pikK ! 2 2 pikK ! 2 3 pikK ! 2 4 pikK !          3 5 pikK ! 2 6 pikK ! 2 7 pikK ! 2 8 pikK ! 5 9 pikK !          3 10 pikK !                                                     : ?T@HED ( --- f )                                              MASTER_RECORD 42 + C@ 1 = ;                                     : ?PAREM@@R ( --- n )                                           MASTER_RECORD 50 + C@                                           MASTER_RECORD 46 + C@ * 1- ;                                    -->                                                                                                                                                                                             \ #2 Set print options                               06/01/90 ) : ?LK-LAIUS ( --- n )                                           MASTER_RECORD 41 + C@                                            CASE 1 OF ?T@HED IF  80 ELSE  96 THEN ENDOF                          2 OF ?T@HED IF 132 ELSE 160 THEN ENDOF                          3 OF ?T@HED IF  40 ELSE  48 THEN ENDOF                          4 OF ?T@HED IF  68 ELSE  81 THEN ENDOF                     ENDCASE ;                                                      : MAX-RIGHT ?LK-LAIUS MASTER_RECORD 50 + C! ;                   : sNP5 1 12 pWG ." Vasak " "a "a ." r "                         MASTER_RECORD 49 + C@ .  14 12 pWG ." Parem " "a "a ." r "      ?PAREM@@R . 28 12 pWG ." Lk. pikkus "                           MASTER_RECORD 51 + C@ .  ."  rida "                             50 12 pWG ." L" "q ." ppu " MASTER_RECORD 52 + C@ .             ."  t" "y ." hja rida" ;                                        -->                                                             \ #3 Set print options                               06/01/90 ) : P-LIIK!!                                                      MASTER_RECORD 40 + C@                                             CASE 2 OF 27 EMIT 70 EMIT                 ENDOF                      3 OF 27 EMIT 72 EMIT                 ENDOF                      4 OF 27 EMIT 72 EMIT 27 EMIT 70 EMIT ENDOF                 ENDCASE                                                       0 PR-P @ CASE 2 OF 27 EMIT 69 EMIT                  ENDOF                     3 OF 27 EMIT 71 EMIT                  ENDOF                     4 OF 27 EMIT 69 EMIT 27 EMIT 71 EMIT  ENDOF                ENDCASE ;                                              : P-LIIK! 0 PR-P @ MASTER_RECORD 40 + C! ;                      : .PAN MASTER-R @ 20 + C@ 0= IF ." Y" ELSE ." N" THEN ;         -->                                                                                                                                                                                             \ #4 Set print options                               06/01/90 ) : P-KIRI!                                                       1 PR-P @ MASTER_RECORD 41 + C! MAX-RIGHT sNP5 ;                 : sFPR1  ( --- )                                                @TL 0= IF @TT 1 = IF @76 ELSE 79 THEN MASTER-R @ 16 + ! THEN    1 13 pWG ." TABELI LAIUS: " @TL . 27 13 pWG ." PAANID: " .PAN ; : sFPR2  ( --- )                                                @TL 0= IF @TT 1 = IF @76 ELSE 79 THEN MASTER-R @ 16 + ! THEN    1 13 pWG Re ." TABELI LAIUS: " @TL . ReO                        CURSOR-ON 15 13 pWG #IN MASTER-R @ 16 + ! ( 1 10 PR-P ! )       CURSOR-OFF ( sFPR1 ) ;                                          : sFPR3 27 13 pWG ." PAANID: "                                  CURSOR-ON KEY MASTER-R @ 20 + C@ 1 XOR                          MASTER-R @ 20 + C! DROP .PAN CURSOR-OFF ( 1 10 PR-P ! sFPR1 ) ; -->                                                                                                                             \ #5 Set print options                               06/01/90 ) : P-KURSIIV!                                                    3 PR-P @ MASTER_RECORD 43 + C! ;                                : P-ALLAKR!                                                     4 PR-P @ MASTER_RECORD 44 + C! ;                                -->                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ #6 Set print options                               06/01/90 ) : P-REVA! 5 PR-P @ MASTER_RECORD 45 + C! ;                      : P-PRN! 6 PR-P @ MASTER_RECORD 46 + C! MAX-RIGHT sNP5 ;        : P-LKJ! 7 PR-P @ MASTER_RECORD 47 + C! ;                       : P-2KY! 8 PR-P @ MASTER_RECORD 48 + C! ;                       : GET-REVA ( --- n )                                            MASTER_RECORD 45 + C@ CASE 1 OF 27 ENDOF                                                   2 OF 21 ENDOF                                                   3 OF 36 ENDOF                                              ENDCASE ;                                 -->                                                                                                                                                                                                                                                                                                                                                                                             \ #7 Set print options                               06/01/90 ) : P-T@HED!                                                      2 PR-P @ MASTER_RECORD 42 + C! MAX-RIGHT sNP5 ;                 : SET_P-O                                                        9 0 DO MASTER_RECORD 40 + I + C@ I PR-P ! LOOP                 4 10 PR-P ! ;                                                   : PAGE"                                                         0 MASTER_RECORD 58 + H! ?LKJ                                      IF GET-REVA MASTER_RECORD 51 + C@ * MASTER_RECORD 58 + H!       THEN ;                                                        -->                                                                                                                                                                                                                                                                                                                                                                                             \ #8 Variables input                                 06/03/90 ) : !LK-LAIUS                                                     ?PAREM@@R MASTER_RECORD 49 + C@ -                               MASTER_RECORD 53 + C! ;                                         : ?PILU ( --- )                                                 !LK-LAIUS MASTER_RECORD  53 + C@ DUP @TL >                         IF   DROP @TL                                                   THEN MASTER_RECORD 54 + C! ;                                 : ?2KY ( --- f )                                                MASTER_RECORD 48 + C@ 2 = ;                                     : MAX-LEFT                                                      ?LK-LAIUS                                                       MASTER_RECORD 53 + C@ 1- MASTER_RECORD 49 + C@ <                  IF 0 MASTER_RECORD 49 + C!                                      THEN ;                                                        -->                                                             \ #9 Set options                                     06/03/90 ) -->                                                             VARIABLE F-AT                                                   VARIABLE F-TX                                                   VARIABLE F-TB                                                   ' FREE-ATOMS F-AT !                                             ' FREE-TEXTS F-TX !                                             ' TAB-OPT    F-TB !                                             : NEED? ( A[moodul] --- pckey )                                 PCKEY DUP 0 =                                                     IF   ROT  DROP                                                  ELSE DUP  NEWLINE =                                                IF   DROP EXECUTE                                               ELSE SWAP DROP                                                  THEN                                                         THEN ;                                                        \ #10 Set options                                    06/05/90 ) -->                                                             : sFPR1  1 13 pWG ." VABAD READ      " Re ." Aatomid " ReO              27 13 pWG ." Tekstid "                                          39 13 pWG ." Tabel "                                            51 13 pWG Re 17 EMIT 205 EMIT 188 EMIT ReO              F-AT @ NEED? ;                                                  : sFPR2  1 13 pWG ." VABAD READ      Aatomid "                          27 13 pWG Re ." Tekstid " ReO                                   39 13 pWG ." Tabel "                                            51 13 pWG Re 17 EMIT 205 EMIT 188 EMIT ReO              F-TX @ NEED? ;                                                  : sFPR3  1 13 pWG ." VABAD READ      Aatomid "                          27 13 pWG ." Tekstid "                                          39 13 pWG Re ." Tabel " ReO                             51 13 pWG Re 17 EMIT 205 EMIT 188 EMIT ReO F-TB @ NEED? ; -->   \ #11 Variables input                                06/03/90 ) : SET-LEFT ( --- )                                              1 12 pWG Re ." Vasak " "a "a ." r "                             MAX-RIGHT                                                       MASTER_RECORD 49 + C@ .                                         CURSOR-ON 11 12 pWG                                             OPTIONVALUE?                                                     IF #IN DUP ?PAREM@@R <=                                              IF MASTER_RECORD 49 + C! !LK-LAIUS                              ELSE DROP 7 EMIT MYSELF                                         THEN                                                       THEN                                                           ReO CURSOR-OFF ;                                                -->                                                                                                                                                                                             \ #12 Variables input                                06/03/90 ) : SET-RIGHT ( --- )                                             14 12 pWG Re ." Parem " "a "a ." r "                            MAX-RIGHT ?PAREM@@R .                                           CURSOR-ON 24 12 pWG                                             OPTIONVALUE?                                                      IF #IN DUP ?PAREM@@R <=                                              IF MASTER_RECORD 50 + C! !LK-LAIUS                              ELSE DROP 7 EMIT MYSELF                                         THEN                                                       THEN                                                          ReO CURSOR-OFF ;                                                -->                                                                                                                                                                                                                                                             \ #13 Variables input                                06/03/90 ) : SET-PLENGTH ( --- )                                           28 12 pWG Re ." Lk. pikkus "                                    MASTER_RECORD 51 + C@ .                                         CURSOR-ON 39 12 pWG                                             OPTIONVALUE?                                                      IF #IN DUP 128 <                                                    IF   MASTER_RECORD 51 + C! ."  rida " ( ?LKJ )                  ELSE DROP 7 EMIT MYSELF                                         THEN                                                        THEN                                                          ReO CURSOR-OFF ;                                                -->                                                                                                                                                                                                                                                             \ #14 Variables input                                06/03/90 ) : SET-ELINES ( --- )                                            50 12 pWG Re ." L" "q ." ppu "                                  MASTER_RECORD 52 + C@ .                                         CURSOR-ON 56 12 pWG                                             OPTIONVALUE?                                                      IF #IN MASTER_RECORD 52 + C! THEN                             ReO CURSOR-OFF ;                                                -->                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ #15 Print handle menu                              06/01/90 ) : sLIIK1 1 3 pWG ." LIIK            " Re ." Tavaline  " ReO             27 3 pWG ." Rasvane " 39 3 pWG ." Topelt "                      51 3 pWG ." Topelt ja rasvane" P-LIIK! ;                : sLIIK2 1 3 pWG ." LIIK            Tavaline  "                         27 3 pWG Re ." Rasvane " ReO                                    39 3 pWG ." Topelt "                                            51 3 pWG ." Topelt ja rasvane" P-LIIK! ;                : sLIIK3 1 3 pWG ." LIIK            Tavaline  "                         27 3 pWG ." Rasvane "                                   39 3 pWG Re ." Topelt "  ReO 51 3 pWG ." Topelt ja rasvane"     P-LIIK! ;                                                       : sLIIK4 1 3 pWG ." LIIK            Tavaline  "                         27 3 pWG ." Rasvane "                                   39 3 pWG ." Topelt "  51 3 pWG Re ." Topelt ja rasvane" ReO     P-LIIK! ;                                    -->                \ #16 Print handle menu                              06/01/90 ) : sKIRI1 1 4 pWG ." KIRI            " Re ." Standard  " ReO     27 4 pWG ." Tihe " 39 4 pWG ." Lai "                                    51 4 pWG ." Poollai " P-KIRI! ;                         : sKIRI2 1 4 pWG ." KIRI            Standard  "                 27 4 pWG Re ." Tihe " ReO 39 4 pWG ." Lai "                             51 4 pWG ." Poollai " P-KIRI! ;                         : sKIRI3 1 4 pWG ." KIRI            Standard  "                         27 4 pWG ." Tihe "                                      39 4 pWG Re ." Lai " ReO                                                51 4 pWG ." Poollai " P-KIRI! ;                         : sKIRI4 1 4 pWG ." KIRI            Standard  "                         27 4 pWG ." Tihe "                                      39 4 pWG ." Lai "                                                       51 4 pWG Re ." Poollai " ReO P-KIRI! ;                  -->                                                             \ #17 Print handle menu                              06/01/90 ) : sT@HD1 1 5 pWG ." T" "A ." HED           "                                     Re ." Pica " ReO                                       27 5 pWG ." Elite " P-T@HED! ;                          : sT@HD2 1 5 pWG ." T" "A ." HED           Pica "                       27 5 pWG Re ." Elite " ReO P-T@HED! ;                   : sKURS1 1 6 pWG ." KURSIIV         " Re ." Ei " ReO                    27 6 pWG ." Jah " P-KURSIIV! ;                          : sKURS2 1 6 pWG ." KURSIIV         Ei "                                27 6 pWG Re ." Jah "  ReO P-KURSIIV! ;                  : sALAK1 1 7 pWG ." ALLAKRIIPSUTUS  " Re ." Ei " ReO                    27 7 pWG ." Jah " P-ALLAKR! ;                           : sALAK2 1 7 pWG ." ALLAKRIIPSUTUS  Ei "                                27 7 pWG Re ." Jah "  ReO P-ALLAKR! ;                   -->                                                                                                                             \ #18 Print handle menu                              06/01/90 ) : sREVA1 1 8  pWG ." REAVAHE         " Re ." 1/8 tolli" ReO             27 8  pWG ." 7/72 tolli"                                        39 8  pWG ." 1/6 tolli" P-REVA! ;                       : sREVA2 1 8  pWG ." REAVAHE         1/8 tolli"                         27 8  pWG Re ." 7/72 tolli" ReO                                 39 8  pWG ." 1/6 tolli" P-REVA! ;                       : sREVA3 1 8  pWG ." REAVAHE         1/8 tolli"                         27 8  pWG ." 7/72 tolli"                                        39 8  pWG Re ." 1/6 tolli" ReO P-REVA! ;                -->                                                             : sFPR4  1 13 pWG ." VABAD READ      Aatomid "                          27 13 pWG ." Tekstid "                                          39 13 pWG ." Tabel "                                            51 13 pWG Re 17 EMIT 205 EMIT 188 EMIT ReO ;            -->                                                             \ #19 Print handle menu                              06/02/90 ) : sPRN1  1 9 pWG ." PRINTER         " Re ." Kitsas " ReO                27 9 pWG ." Lai " P-PRN! ;                              : sPRN2  1 9 pWG ." PRINTER         Kitsas "                            27 9 pWG Re ." Lai " ReO P-PRN! ;                       : sLKJ1  1 10 pWG ." LK-JAOTUS       " Re ." Jah " ReO                  27 10 pWG ." Ei " P-LKJ! ;                              : sLKJ2  1 10 pWG ." LK-JAOTUS       Jah "                              27 10 pWG Re ." Ei " ReO P-LKJ! ;                       : s2KY1  1 11 pWG ." KAHELE K" "Y ." LJELE  " Re ." Ei " ReO            27 11 pWG ." Jah " P-2KY! ;                             : s2KY2  1 11 pWG ." KAHELE K" "Y ." LJELE  Ei "                        27 11 pWG Re ." Jah " ReO P-2KY! ;                      -->                                                                                                                                                                                             \ #20 Print handle menu                              06/02/90 ) : sNP1 ( --- )                                                  SET-LEFT                                                        14 12 pWG ." Parem " "a "a ." r " ?PAREM@@R .                   28 12 pWG ." Lk. pikkus " MASTER_RECORD 51 + C@ . ."  rida "    50 12 pWG ." L" "q ." ppu " MASTER_RECORD 52 + C@ .             56 12 pWG ."  t" "y ." hja rida"  sNP5 ;                                                                                        : sNP2 1 12 pWG ." Vasak " "a "a ." r "                         MASTER_RECORD 49 + C@ .                                         SET-RIGHT                                                       28 12 pWG ." Lk. pikkus " MASTER_RECORD 51 + C@ . ."  rida "    50 12 pWG ." L" "q ." ppu " MASTER_RECORD 52 + C@ .             56 12 pWG ."  t" "y ." hja rida"  sNP5 ;                        -->                                                                                                                             \ #21 Print handle menu                              06/02/90 ) : sNP3 1 12 pWG ." Vasak " "a "a ." r "                         MASTER_RECORD 49 + C@ . 14 12 pWG ." Parem " "a "a ." r "       ?PAREM@@R .                                                     SET-PLENGTH                                                     50 12 pWG ." L" "q ." ppu " MASTER_RECORD 52 + C@ .             56 12 pWG ."  t" "y ." hja rida" sNP5 ;                                                                                         : sNP4 1 12 pWG ." Vasak " "a "a ." r "                         MASTER_RECORD 49 + C@ . 14 12 pWG ." Parem " "a "a ." r "       ?PAREM@@R . 28 12 pWG ." Lk. pikkus "                           MASTER_RECORD 51 + C@ .  ."  rida "                             SET-ELINES                                                      56 12 pWG ."  t" "y ." hja rida"  sNP5 ;                        -->                                                                                                                             \ #22 Print handle menu                              06/02/90 ) : nOOL- 0 PiX @ 2 + pWG 32 EMIT ;                               : nOOL+ 0 PiX @ 2 + pWG 16 EMIT ;                                                                                               : ?Ok ( --- f )                                                 ?PAREM@@R MASTER_RECORD 49 + C@ >                                 IF                                                 -1           ELSE 7 EMIT nOOL- 11 PiX ! nOOL+ 2 9 PR-P !                          ?LK-LAIUS MASTER_RECORD 50 + C!                                 MASTER_RECORD 46 + C@ * 1-  sNP2               0           THEN ;                                                        -->                                                                                                                                                                                                                                                                                                                             \ #23 Print option table                             06/01/90 ) 12 5 2ARRAY PPT_TAB                                             ' sLIIK1 1 1 PPT_TAB !            ' sKURS1 4 1 PPT_TAB !        ' sLIIK2 1 2 PPT_TAB !            ' sKURS2 4 2 PPT_TAB !        ' sLIIK3 1 3 PPT_TAB !            ' sALAK1 5 1 PPT_TAB !        ' sLIIK4 1 4 PPT_TAB !            ' sALAK2 5 2 PPT_TAB !        ' sKIRI1 2 1 PPT_TAB !            ' sREVA1 6 1 PPT_TAB !        ' sKIRI2 2 2 PPT_TAB !            ' sREVA2 6 2 PPT_TAB !        ' sKIRI3 2 3 PPT_TAB !            ' sREVA3 6 3 PPT_TAB !        ' sKIRI4 2 4 PPT_TAB !                                          ' sT@HD1 3 1 PPT_TAB !                                          ' sT@HD2 3 2 PPT_TAB !            ' sPRN1  7 1 PPT_TAB !        ' sLKJ1  8 1 PPT_TAB !            ' sPRN2  7 2 PPT_TAB !        ' sLKJ2  8 2 PPT_TAB !            ' s2KY1  9 1 PPT_TAB !        ' s2KY2  9 2 PPT_TAB !            ' sNP1  10 1 PPT_TAB !        ' sNP2  10 2 PPT_TAB !            ' sNP3  10 3 PPT_TAB !   -->  \ #24 Print handle menu                              06/01/90 ) ' sNP4  10 4 PPT_TAB !          ' sNP5  10 5 PPT_TAB !          ' sFPR3 11 3 PPT_TAB !          ' sFPR1 11 1 PPT_TAB !          ' sFPR2 11 2 PPT_TAB !       (  ' sFPR4 11 4 PPT_TAB ! )                                                                        : n-INDX ( --- )                                                PiX @ 1 - pikK @ PiX @ 1 - PR-P @                               2DUP = IF DROP 1 ELSE 1+ THEN PiX @ 1 - PR-P ! DROP ;           : p-INDX ( --- )                                                PiX @ 1 - pikK @ PiX @ 1 - PR-P @                               DUP 1 = IF DROP ELSE 1 - SWAP DROP THEN PiX @ 1 - PR-P ! ;      : d-INDX ( --- )                                                nOOL- PiX @ DUP 11 = IF DROP 1 ELSE 1+ THEN PiX ! nOOL+ ;       : u-INDX ( --- )                                                nOOL- PiX @ DUP 1 = IF DROP 11 ELSE 1 - THEN PiX ! nOOL+ ;      -->                                                             \ #25 Print handle menu                              06/01/90 ) : sHOW_OPTION ( --- )                                           PiX @ DUP 1 - PR-P @ PPT_TAB @ EXECUTE ;                        : sHOW_OPTIONS 5 9 PR-P ! 1 10 PR-P !                           12 1 DO I DUP 1 - PR-P @ PPT_TAB @ EXECUTE LOOP ;               -->                                                             : LaiuS! ( --- )                                                @TT 1 = IF @76 ELSE 79 THEN MASTER-R @ 16 + ! ;                 -->                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ #26 Print handle menu                              06/01/90 ) : LiiGU ( key --- )                                             CASE DOWNARROW  OF d-INDX                   ENDOF                    UPARROW    OF u-INDX                   ENDOF                    RIGHTARROW OF n-INDX                   ENDOF                    LEFTARROW  OF p-INDX                   ENDOF                    F1         OF  MDB-HELP CURSOR-OFF     ENDOF                    F3         OF SWITCH-P/D               ENDOF                    F4         OF RIPP-FTX                 ENDOF                    F5         OF RIPP-FA                  ENDOF                    F6         OF CHANGE-COLORS CURSOR-OFF ENDOF                    F7         OF SWITCH-PTY ENDOF F8  OF SWITCH-A/C ENDOF          F10        OF SWITCH-F/F               ENDOF                    ALT-P      OF WriteScr                 ENDOF                    ( else )    7 EMIT                                         ENDCASE sHOW_OPTION ;                                  -->      \ #27 Print handle menu                              06/01/90 ) : sET_OPTIONS ( --- f )                                         CURSOR-OFF                                                      sHOW_OPTIONS nOOL+                                              BEGIN KELL PCKEY CASE EXITFLAG OF        0  EXIT  ENDOF                               NEWLINE  OF ?Ok                                                             IF -1 EXIT THEN ENDOF                               0        OF LiiGU           ENDOF                               ( else )  7 EMIT                                           ENDCASE                                        AGAIN                                                           CURSOR-ON ;                                                     : PILU@ ( --- n )                                               MASTER_RECORD 54 + C@ ;                                         -->                                                                                                                             \ #28 Set print options                              06/01/90 ) : sEXPR  1 15 pWG Re ." Esc " ReO SPACE "A ." ra tr" "y ." ki " Re 17 EMIT 205 EMIT 188 EMIT ReO                                ."  1. Vali, 2. Salvesta v" "@ "@ ." rtus | Tr" "y ." ki "      Re 205 EMIT 16 EMIT SPACE 17 EMIT 205 EMIT SPACE 24 EMIT        SPACE 25 EMIT SPACE ReO ."  Vali " ;                            : INIT_P-O                                                      1 0 PR-P ! ( regular ) 1 1 PR-P ! ( pica ) 1 2 PR-P ! ( pica )  1 3 PR-P ! ( no italic ) 1 4 PR-P ! ( no underline )            3 5 PR-P ! ( 1/6" )                                             1 6 PR-P ! ( kitsas printer )  4 10 PR-P ! ( vabad read )       1 7 PR-P ! ( lk-jaotus ) 1 8 PR-P ! ( 1 kyljele )               0 MASTER_RECORD 49 + C! ( left ) 79 MASTER_RECORD 50 + C!       50 MASTER_RECORD 51 + C! ( lpage ) 2 MASTER_RECORD 52 + C!       9 0 DO I PR-P @ MASTER_RECORD 40 + I + C! LOOP ;               -->                                                             \ #29 2-side print                                   06/01/90 ) : CHANGE-LeRi                                                   PT? 0= IF P/D @ 2 < IF ?LKJ                                     IF ?2KY IF LK-NR @ 1 AND 0=         ( paaris? )                         IF   ?LK-LAIUS MASTER_RECORD 46 + C@ * 1-   ( paaris )               MASTER_RECORD 49 + C@ - DUP                                     27 EMIT 81 EMIT EMIT PILU@ -           ( right )                27 EMIT 108 EMIT EMIT                  ( left )            ELSE MASTER_RECORD 49 + C@                  ( paaritu )              27 EMIT 108 EMIT EMIT                  ( left )                 MASTER_RECORD 50 + C@                                           27 EMIT 81 EMIT EMIT                   ( right )           THEN                                                         THEN                                                       THEN THEN THEN ;                                                -->                                                             \ #30 Set print options                              06/01/90 ) : ?#PAAN ( --- n )                                              MASTER-R @ 20 + C@ 1 =                                          IF @TL PILU@ /MOD SWAP 0> IF 1+ THEN ELSE 1 THEN ;              VARIABLE JOTT   ( paaniindex )                                  : LK-NR! ( --- )                                                CHANGE-LeRi                                                     LK-NR @ 0 <# # # #> @TL OVER - 1 - EXPUHVER @ +                 DUP 4 - ASCII l SWAP C!                                         DUP 3 - ASCII k SWAP C!                                         DUP 2 - ASCII . SWAP C!                                         SWAP CMOVE ;                                                    : FILL-EXP ( --- )                                              DBFILE DROP DUP 5 + SWAP 4 + C@ @TL OVER - 2 /                  EXPUHVER @ + SWAP CMOVE ;                                       -->                                                             \ #31 Page support                                   06/10/90 ) : EMPH&DOUBL-ON P/D @ 2 < IF MASTER_RECORD 41 + C@ 4 <>          IF 27 EMIT 69 EMIT 27 EMIT 71 EMIT THEN THEN ;                 : EMPH&DOUBL-OFF P/D @ 2 < IF MASTER_RECORD 41 + C@ 4 <>         IF     27 EMIT 70 EMIT 27 EMIT 72 EMIT ( cancel )               THEN   P-LIIK!! THEN ;                                         : PRINT_EXP ( --- )                                             F/F? IF POP-ON LK-NR! EMPH&DOUBL-ON                                     CR PILU @ PILU@ =                                                  IF    .DATE SPACE .TIME                                               EXPUHVER @ 17 + PILU @ 17 - TYPE CR CR                    ELSE  EXPUHVER @ JOTT @ PILU@ * + PILU @ TYPE CR CR             THEN  EMPH&DOUBL-OFF                                      THEN ;                                                     -->                                                                                                                             \ #32 Page support                                   06/10/90 ) : TYPE_LINE ( A --- )                                           PILU @ DUP 0 = IF DROP PILU@ THEN TYPE                          P/D @ 2 = IF CR THEN ;                                                                                                          : P-MARK MARKBUFFER @ JOTT @ PILU@ * + TYPE_LINE ;                                                                              : P_KRIIPS KRPUHVER @ JOTT @ PILU@ * + TYPE_LINE ;                                                                              : END-OF-PAGE ( --- )                                           F/F? IF POP-ON EMPH&DOUBL-ON CR P-MARK CR                               P_KRIIPS CR CR EMPH&DOUBL-OFF                                THEN ;                                                     : N216 ( n --- )                                                P/D @ 2 < IF 27 EMIT 51 EMIT EMIT THEN CR ;                     -->                                                             \ #33 Page support                                   06/10/90 ) : LK-LQPP ( --- )                                               F/F? IF                                                          ?LKJ IF ReVa @ MASTER_RECORD 58 + H@ #TOLLID @ - DUP N216               POP-ON MASTER_RECORD 52 + C@ 0 ?DO CR LOOP                      END-OF-PAGE 1 LK-NR +! PRINT_EXP                                - DUP N216 #TOLLID ! POP-ON P/D @ 2 = IF KEY DROP THEN       THEN                                                           THEN ;                                                     : UUS-RIDA                                                      F/F? IF MASTER_RECORD 58 + H@ DUP 0 >                                  IF ReVa @ #TOLLID @ + >=                                          IF ReVa @ #TOLLID +! 1 RIDANR +! CR ELSE LK-LQPP THEN         ELSE DROP 1 RIDANR +! CR THEN                                 ELSE CR                                                         THEN ;                                 -->                 \ #34 Page support                                   06/10/90 ) : END-OF-CHART ( --- )                                          F/F?                                                            IF P/D @ 2 <                                                     IF MASTER_RECORD 58 + H@ #TOLLID @ - 216 /MOD                      0 ?DO 27 EMIT 51 EMIT 216 EMIT CR LOOP                          N216 POP-ON MASTER_RECORD 52 + C@ 0 ?DO CR LOOP END-OF-PAGE  THEN                                                           THEN ;                                                          : PILU! ( j --- )                                               PILU@ @TL >=                                                     IF DROP PILU@ PILU !                                            ELSE PILU@ * @TL SWAP - DUP PILU@ <                               IF PILU ! ELSE DROP THEN                                      THEN ;                                                         -->                                                             \ #35 Set print options                              06/01/90 ) : SET_PRNT ( --- f )                                            p-WINDOW W-BORDER p-WINDOW W-CLEAR                              27 0 pWG ." TABELI TR" "Y ." KK"                                1 1 pWG ." TABEL. Laius: " @TL . ."  s" "y ." mbolit, pikkus "  @156 . ."  rida. "                                              sEXPR 1 PiX ! SET_P-O                                           sET_OPTIONS PAGE" ;                                             -->                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ #36 Set print options                              06/01/90 ) : SET_PRINT ( --- f )                                           >vPUHVER CURSOR-OFF P/D @ 2 <                                     IF SET_PRNT                                                     ELSE CLEARSCREEN 0 0 GOTOXY                                     THEN ?PILU ;                                                  : TYPE_R-NR ( --- )                                             P/D @ 2 <                                                       IF CONSOLE 65 1 pWG ." RIDA " RIDANR @ . >TRYKK THEN ;          -->                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ #37 Print record                                   05/30/90 ) : EMPTY_LINE ( rida puhver l --- )                              0 DO 2DUP SWAP C@                                                    CASE 179 OF 179 ENDOF                                                180 OF 179 ENDOF                                                182 OF 186 ENDOF                                                185 OF 186 ENDOF                                                186 OF 186 ENDOF                                                187 OF 186 ENDOF                                                191 OF 179 ENDOF                                                194 OF 179 ENDOF                                                195 OF 179 ENDOF                                                197 OF 179 ENDOF                                                199 OF 186 ENDOF                                      -->                                                                                                                             ( #38 Print record                                   05/31/90 )          201 OF 186 ENDOF                                                203 OF 186 ENDOF                                                204 OF 186 ENDOF                                                206 OF 186 ENDOF                                                209 OF 179 ENDOF                                                215 OF 186 ENDOF                                                216 OF 179 ENDOF                                                218 OF 179 ENDOF                                           ( else ) BL SWAP                                                ENDCASE                                                         SWAP C! 1+ SWAP 1+ SWAP                                       LOOP 2DROP ;                                                  -->                                                                                                                                                                                             \ #39 Print  record                                  05/12/90 ) : CONV_PRINT ( rida puhver l --- )                              0 DO 2DUP SWAP C@ DUP 0=                                               IF DROP BL                                                      THEN SWAP C! 1+ SWAP 1+ SWAP                               LOOP 2DROP ;                                                  : PRINT_LINE ( rida --- )                                       DUP PRINTBUFFER @ PILU @ CONV_PRINT                             PRINTBUFFER @ PILU @ TYPE TYPE_R-NR UUS-RIDA                    P/D @ 2 < IF 5 PR-P @ 2 =                                                    IF    DUP PRINTBUFFER @ PILU @ EMPTY_LINE                             PRINTBUFFER @ PILU @ TYPE UUS-RIDA                        THEN DROP                                                    THEN ;                                                -->                                                                                                                             \ #40 Freeprint                                      07/07/90 ) : ?FPC ( --- )                                                  ESC-LYLI @ 8 + @ FP-CHAIN ! ;                                   : B<=? ( --- f )                                                R_J@RG @ ESC-LYLI @ 4 + @ <= ;                                  : SET_ReVa ( n --- )                                            P/D @ 2 < IF 27 EMIT 51 EMIT                                                 DUP 0 =                                                            IF   DROP 36                                                    THEN DUP EMIT ReVa !                                      ELSE DROP                                                       THEN ;                                                -->                                                                                                                                                                                                                                                             \ #41 Freeprint                                      07/07/90 ) : LAIUS>SARV ( printlaius --- symbarv )                         REAL_LENGTH DUP ESC-LYLI @ 18 + H@ DUP ROT <                     IF SWAP THEN DROP ;                                            : NEW-SA ( n --- )                                              DUP ESC-LYLI @ 16 + H@ + ESC-LYLI @ 16 + H!                         ESC-LYLI @ 18 + H@ SWAP - ESC-LYLI @ 18 + H! ;              : TYPE-BLANK ( n --- )                                          DUP 0 >                                                          IF DUP SPACES DUP R_J@RG +! N_J@@K -! ELSE DROP THEN ;         : TYPE-JUPP ( n --- )                                           DUP LAIUS>SARV                                                  DUP FREE-RIDA @ ESC-LYLI @ 16 + H@ + SWAP ESC-ON TYPE ESC-OFF   NEW-SA                                                          DUP R_J@RG +! N_J@@K -! ;                                       -->                                                             \ #42 Freeprint                                      07/07/90 ) : PRINT-A-JUPP                                                  B<=?                                                             IF ESC-LYLI @ @ R_J@RG @ - DUP 0 >                                 IF POP-On TYPE-BLANK POP-OFF ELSE DROP THEN                     ?FPC ESC-LYLI @ @ DUP R_J@RG ! ESC-LYLI @ 4 + @ SWAP -          DUP N_J@@K @ <= IF   TYPE-JUPP                                                  ELSE DROP N_J@@K @ TYPE-JUPP                                    THEN                                         THEN ;                                                         -->                                                                                                                                                                                                                                                                                                                                                                                             \ #43 Freeprint                                      07/07/90 ) : PRINT-B-JUPP                                                  B<=?                                                             IF ?FPC ESC-LYLI @ 4 + @ ESC-LYLI @ @ - DUP N_J@@K @ <=            IF   TYPE-JUPP                                                  ELSE DROP N_J@@K @ TYPE-JUPP                                    THEN                                                         THEN ;                                                         -->                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ #44 Freeprint                                      07/07/90 ) : PRINT-JUPP                                                    R_J@RG @ ESC-LYLI @ @ <=                                         IF R_J@RG @ N_J@@K @ + ESC-LYLI @ @ <                              IF POP-On N_J@@K @ TYPE-BLANK POP-OFF                           ELSE PRINT-A-JUPP                                               THEN                                                         ELSE PRINT-B-JUPP                                               THEN ;                                                         : SET_SPACE ( I --- )                                           ETTE/TAHA @ 0 =                                                   IF   4 * E_ReVa @ + @                                           ELSE 4 * T_ReVa @ + @                                           THEN SET_ReVa ;                                               -->                                                                                                                             \ #45 Freeprint                                      07/07/90 ) : PRINT_PILU                                                    ESC-LYLI @ 0 >                                                  IF JOTT @ PILU@ * R_J@RG !                                           BEGIN PRINT-JUPP N_J@@K @ 0 =                                    IF  -1                                                          ELSE ESC-LYLI @ 12 + @ DUP 0 >                                    IF ESC-LYLI ! 0                                                 ELSE DROP -1                                                    THEN                                                          THEN                                                          UNTIL                                                       THEN ;                                                          -->                                                                                                                                                                                             \ #46 Freeprint                                      07/07/90 ) : PRINT_FREELINE ( I --- )                                      DUP PILU @ N_J@@K ! DUP ETTE/TAHA @ 0 =                           IF   @TL * EESREAD  @ + FREE-RIDA !                                  4 * E_VIIDAD @ + @                                         ELSE @TL * TAGAREAD @ + FREE-RIDA !                                  4 * T_VIIDAD @ + @                                         THEN DUP 0 >                                                      IF ESC-LYLI ! PRINT_PILU                                        ELSE DROP                                                       THEN SET_SPACE UUS-RIDA ;                                   : PALUN ( --- )                                                 P/D @ 2 = IF Iy 4 FOREGROUND 50 24 GOTOXY                       ." Vajutage suvalist klahvi..."                                 Iyo 7 FOREGROUND KEY DROP CR THEN ;                             -->                                                             \ #47 Print  record                                  05/12/90 ) : TOLL-> ( 1" paberit v„lja )                                   P/D @ 2 <> IF 27 EMIT 74 EMIT 216 EMIT CR CR THEN ;             : BEFORE_FREE                                                   0 #TOLLID ! 0 ETTE/TAHA ! #EES @ 0 >                              IF POP-OFF #EES @ 1+ 0 DO I PRINT_FREELINE P/D @ 2 =                IF I 24 /MOD DROP 0= I 0 > AND IF PALUN THEN                    THEN                                                                               LOOP                                        P/D @ 2 = IF #EES @ 24 < IF PALUN                                                        ELSE #EES @ 24 /MOD DROP 0 >                                         IF PALUN THEN                                              THEN                                             THEN POP-ON                                        THEN ;                                                        -->                                                             ( #48                                                09/19/91 ) : AFTER_FREE                                                    1 ETTE/TAHA ! #TAGA @ 0 >                                         IF POP-OFF #TAGA @ 1+ 0 DO I PRINT_FREELINE P/D @ 2 =                                     IF I 24 /MOD DROP 0= I 0 > AND                                     IF PALUN THEN                                                THEN                                                         LOOP                                        P/D @ 2 = IF #TAGA @ 24 < IF PALUN                                                        ELSE #TAGA @ 24 /MOD DROP 0 >                                       IF PALUN THEN                                               THEN                                            THEN POP-ON                                        THEN ;                                                        ;S                                                                                                                              