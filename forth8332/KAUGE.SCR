 ( CONSTRUCTOR SCREENS FILE )                                    ;S                                                                                                                                Система Построения Трансляторов  ТАРТУ                                      КОНСТРУКТОР                                         202400   Эстонская ССР  г  Тарту                                ул  Лийви 2                                                     Тартуский госуниверситет                                        кафедра программирования                                                                                                        Я. Р. Пейал                                                     В. К. Соо                                                       М. О. Томбак                                                                                                                                                                                                                                                 ( Graafi v@ljastus                                   12/15/87 ) : .KAAR ( kaar --- )                                                    ." -(" DUP PREFLEN 0                                            ?DO                                                                 DUP I PREFSYMB .                                            LOOP                                                            ." # " DUP SUFSYMB .                                            ." )->" TARGET . ;                                      : .TIPP ( tipunr --- )                                                  DUP . TIPUD @GRA                                                BEGIN ?DUP                                                      WHILE DUP .KAAR NEXTEDGE                                        REPEAT ;                                                : .GRAAF SYMBARV @ 0                                                    ?DO CR I .TIPP LOOP ;                                                                                                   ( #2 BPR                                             09/28/87 ) : BPR ( N MAD --- ) ( N X N NURGA TRYKK MAATRIKSIST                                   MQQTMEGA DIMCONST )                              OVER 0 DO ?TERMINAL IF BEGIN ?TERMINAL                          UNTIL THEN CR I 2 PICK 0 DO DUP                                 I 3 PICK KOHT @BIT . LOOP DROP LOOP                             DROP DROP CR ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           \ #3 Po~hja loomine kauge konteksti jaoks            12/17/87 ) : LANG1 ( LIT" CONSTRF1BIN" PHEXEC )                                    LIT" CONSTRFABIN" PHEXEC ;                              LANG1                                                           SERVICE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ( System messages )                                             empty stack                                                     dictionary full                                                 has incorrect address mode                                      is redefined                                                    is undefined                                                    disk address out of range                                       stack overflow                                                  disk error                                                                                                                                                                                                                                                                                                                      BASE must be DECIMAL                                            missing decimal point                                           PC/FORTH 2.0                             Laboratory Microsystems( System messages )                                             compilation only, use in definition                             execution only                                                  conditionals not paired                                         definition not finished                                         in protected dictionary                                         use only when loading                                           off current editing screen                                      declare vocabulary                                                                                                                                                                                                                                              illegal dimension in array definition                           negative array index                                            array index too large                                                                                                           ( 8086 Assembler messages )                                     16 bit register not allowed                                     8 bit register not allowed                                      address out of range                                            immediate data value not allowed                                missing source register                                         missing destination register                                    illegal operation                                               illegal operand                                                 instruction not implemented                                     illegal destination register                                    illegal source register                                         illegal condition code                                          register mismatch                                               destination address missing                                                                                                     \ #7 Kauge kontekst: LISAW PAAR S,                   01/18/88 ) : CR ?TERMINAL DROP CR ;                                        : LISAW ( s1 s2 --- )                                            2DUP >                                                          IF SWAP                                                         THEN M1 KOHT 1!BIT ;                                           : PAAR ( a.i1 a.i2 --- a.i1 a.i2 )                               OVER S@RUL OVER S@RUL LISAW ;                                  : S, HERE S! SYMBCONST ?ALLOT ;                                 -->                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ #8 Kauge kontekst: DCPAARID                        10/28/87 ) : DCPAARID ( a --- a )                                           DUP AINFO                                                       BEGIN DUP ALINK @RUL                                            WHILE DUP AABI C@RUL ( a a.i )                                     IF DUP                                                             BEGIN ( a a.i a.i1 )                                               ALINK @RUL DUP                                               WHILE DUP AABI C@RUL                                               IF PAAR                                                         THEN                                                         REPEAT DROP                                                  THEN ALINK @RUL                                              REPEAT DROP ;                                                     -->                                                                                                                          \ #9 Kauge kontekst: AHELAD                          10/28/87 ) : AHELAD BMSIZE ['] M1 ALLO M1 BERS 0                            BEGIN RULES 10 + @ OVER >                                       WHILE DUP @RUL                                                     IF DUP AINFO ALINK @RUL                                            IF DCPAARID                                                     THEN                                                         THEN HR# +                                                   REPEAT DROP RULES HSEG FREEL ;                                  -->                                                                                                                                                                                                                                                                                                                                                                                                                                                            \ #10 Kauge kontekst: PAKIW ULM ALLM                 12/17/87 ) DIMCONST ARRAY W  VAR WBAAS                                     : PAKIW 0 W SYMBARV @ 2* ERASE HERE WBAAS !                             SYMBARV @ 1- TERMARV @                                          DO I SYMBARV @ I 1+                                                DO DUP I ( i j ) M1 KOHT @BIT                                      IF ( i ) DUP W @ ?DUP                                              IF ( i addr ) 1 SWAP +!                                         ELSE ( i ) HERE OVER W ! 1 ,                                    THEN I S,                                                    THEN                                                         LOOP DROP                                                    LOOP ['] M1 SEGFREE ;                                   DIMCONST BARRAY ULM              VAR TQKE                       : ALLM 0 ULM SYMBARV @ 255 FILL 255 0 LM C! ;                                                                                   \ #11 Kauge kontekst: WPAARID                        01/08/88 ) : WPAARID TSYKLIALG SYMBARV @ TERMARV @                          DO I W @ ?DUP                                                      IF DUP 2+ SWAP @ SYMBCONST * 0                                     DO DUP I + S@ ?DUP                                                 IF J 2DUP WPAAR                                                    IF . . TQKE @                                                      IF 0 OVER I + S! 0 TQKE !                                       THEN LEAVE                                                   ELSE 2DROP THEN                                              THEN SYMBCONST                                               +LOOP DROP                                                   THEN CONFL @ IF LEAVE THEN                                   LOOP ;                                                         -->                                                                                                                             \ #12 Kauge kontekst: ?MALU DCTEST                   10/29/87 ) ( 2VARIABLE STARTIS )                                           : DCTEST CR BMSIZE ['] M1 ALLO                                           -1 %CORRECT ! ALLM AHELAD PAKIW                                ( @TIME STARTIS 2! ) EELTOO                                      BEGIN 0 CONFL !                                                    WPAARID                                                         CONFL @ 0=                                                   UNTIL CR  WBAAS @ DP ! JARELTOO                                ( @TIME STARTIS 2@ -TIME CR .UT )                                PARMOUT ;                                                                                                                                                                                                                                                                                                                                                                              \ #13 Graaf: TIPUD, to"o" kaartega                   01/15/88 ) 7 LOAD                                                          VAR GRBAAS  VAR #KAAR                                           PR#SYMBCONST 1- GRAMCONST *  CONSTANT MAX#EDGE                  PRODLCONST 1- SYMBCONST 2* - CONSTANT MAXPREF                   DIMCONST ARRAY TIPUD  MAX#EDGE BARRAY MARKS                     DIMCONST 1-                  CONSTANT TYHISUF                   : K.TIPP 2+ ;      : K.JARGM 4 + ;                              : K.SUF 6 + ;      : K.PREFL 8 + ;       : K.PREF 9 + ;         : ?NOMARK @ MARKS C@ ;  : MARK @ MARKS 0 SWAP C! ;              : TARGET K.TIPP @ ;     : NEXTEDGE K.JARGM @ ;                  : SUFSYMB K.SUF S@ ;    : PREFLEN K.PREFL C@ ;                  : PREFSYMB ( kaar i --- pref<i> )                                       SYMBCONST * SWAP K.PREF + S@ ;                          : RELMARKS 0 MARKS #KAAR @ 255 FILL ; -->                                                                                       \ #14 Graaf: LQPPU TEEKAAR                           01/15/88 ) : LQPPU ( addr1 --- addr2 )                                             BEGIN DUP @                                                     WHILE @ K.JARGM REPEAT ;                                : TEEKAAR ( prad i --- )                                                2DUP PI TIPUD LQPPU HERE SWAP !                                 #KAAR @ , ( nr. ) OVER PV S, ( target ) 0 , ( next )            OVER P# OVER 2+ <                                               IF TYHISUF ELSE 2DUP 1+ PI                                      THEN S, ( suf ) 1- DUP C, ( preflen ) ?DUP                      IF 1 SWAP                                                             DO DUP I PI S, ( pref[i] ) -1                                   +LOOP                                                     THEN DROP 1 #KAAR +! ; -->                                                                                                                                                              \ #15 Kontekst graafist: TEEGRAAF WAYFROM            01/08/88 ) : TEEGRAAF 0 TIPUD SYMBARV @ 2* ERASE 0 #KAAR ! HERE GRBAAS !           PRODARV @ 0                                                     DO I PRVIIT DUP P# 1                                               DO DUP I TEEKAAR                                                LOOP DROP                                                    LOOP ;                                                  : WAYFROM ( tipunr cfa --- )                                            >R TIPUD @                                                      BEGIN ?DUP                                                      WHILE DUP ?NOMARK                                                  IF DUP MARK DUP R@ EXECUTE 0=                                      IF DUP TARGET R@ MYSELF                                         THEN                                                         THEN NEXTEDGE                                                REPEAT R> DROP ; -->                                    \ #16 Kontekst graafist: ADDLCT DLCCOND              12/04/87 ) DIMCONST BARRAY VLM                                             VAR A  VAR LNX                                                  : ADDLCT ( symb vektor --- )                                            OVER VLM 255 SWAP C!                                            OVER 3 ->L + SWAP 7 AND 128 SWAP ->L                            OVER C@ OR SWAP C! ;                                    : DLCCOND ( kaar --- f )                                                0 OVER PREFLEN 0                                                ?DO DROP DUP I PREFSYMB DUP ULM C@                                 IF A @ ADDLCT -1 LEAVE                                          ELSE DROP 0                                                     THEN                                                         LOOP SWAP DROP ;                                        -->                                                                                                                             \ #17 Kontekst graafist: LAHUTALM                    01/18/88 ) VAR ABI RIDA 2- ?ALLOT                                          VAR ABI1 DIMCONST 8 / ?ALLOT                                    : LAHUTALM CR ." [ "                                             ABI SYMBARV @ 0                                                 DO DUP C@ 8 0                                                      DO DUP 128 AND                                                     IF 0 J I + DUP . DUP LM C@                                         IF ." Grammar isn't (D/1)MSP "                                     0 %CORRECT ! -1 TQKE ! 2DROP                                 ELSE ULM C!                                                     THEN                                                         THEN 1<-CL                                                   LOOP DROP 1+ 8                                               +LOOP DROP ." ] " ; -->                                                                                                        \ #18 Kontekst graafist: CALCDLC WPAAR TSYKLIALG ... 12/19/87 ) : CALCDLC ( symb vektor --- )                                           DUP LNX @ ERASE RELMARKS                                        A ! DUP >R [S'] DLCCOND OVERLAY + WAYFROM                       ?cs: A @ M4 R> RIDA * LNX @ CMOVEL ;                    : WPAAR ( symb1 symb2 --- f )                                           ABI CALCDLC ABI1 CALCDLC                                        ?cs: DUP MAT1 ! MAT2 ! ABI1 ABI LNX @ CONJ DUP                  IF -1 CONFL ! LAHUTALM                                          THEN ;                                                  : TSYKLIALG 0 VLM SYMBARV @ ERASE ;                             : EELTOO BRPIK LNX ! TEEGRAAF                                           BMSIZE ['] M4 ALLO M4 BERS ;                            : JARELTOO %CORRECT @                                                   IF ." Grammar is (D/1)MSP" 0 VLM 0 LM SYMBARV @ CMOVE              255 0 LM C! THEN ;   11 LOAD                         \ #19 Hash-grammatika lugemine                       01/04/88 ) VARIABLE PUHV                                                   : ALLOCBF ( len --- seg )                                          B/BUF 1- + ALLOCL ;                                          : READL ( seg len --- )                                            [ HEX ] 7FFF [ DECIMAL ] BUFFER PUHV !                          0 DO PUHV @ B/BUF ATFILE LREAD ?DISCERR                              ?cs: PUHV @ 2 PICK I B/BUF CMOVEL B/BUF                      +LOOP DROP ;                                               : HREAD ( eaddr pass --- )                                         >R ATFILE OPEXT                                                 R@ 14 ATFILE LREAD ?DISCERR                                     R@ 10 + @ ALLOCBF R@ 12 + !                                     R> HCOUNT READL ;                                            : RULESIN LIT" HGR" RULES     HREAD ;                           INITMEM  RULESIN FORGET TASK : TASK ;                           \ #20 DLC arvutamine: MULTEPSLM SUMEPS               01/18/88 ) 7 LOAD                                                          VAR MX                                                          : MULTEPSLM ( seg --- ) MX ! SYMBARV @ 0                                DO 0 128 I 8 + I                                                   DO I ULM C@                                                        IF SWAP OVER OR SWAP                                            THEN 1->CYK                                                  LOOP DROP MX @ I 3 ->L SYMBARV @ 0                              DO >R OVER OVER R@ C@L AND OVER R@ C!L R> RIDA +                LOOP 3DROP 8                                                 +LOOP ;                                                 : SUMEPS ( seg --- )                                                    MX ! SYMBARV @ 0                                                DO I I MX @ KOHT 1!BIT LOOP ;                                            -->                                            \ #21 DLC arvutamine: LOOPLM LAMBDALMT ALPHALMT      12/30/87 ) : LOOPLM ( praddr x n i0  --- praddr )                                  DO OVER I PI 2DUP SWAP MX @ KOHT 1!BIT                             ULM C@ IF LEAVE THEN                                         LOOP DROP ;                                             : LAMBDALMT ( seg --- )                                                 DUP BERS MX ! PRODARV @ 0                                       DO I PRVIIT DUP PV OVER P# 1 LOOPLM DROP LOOP ;         : ALPHALMT ( seg --- )                                                  DUP BERS MX ! PRODARV @ 0                                       DO I PRVIIT DUP P# 1- 1                                            ?DO DUP I PI OVER P# I 1+ LOOPLM                                LOOP DROP                                                    LOOP ;                                                  DIMCONST BARRAY VLM                                              -->                                                            \ #22 Kauge kontekst: CALCDLCT WPAAR TSYKLIALG ...   01/18/88 ) : CALCDLCT                                                       M1 LAMBDALMT SYMBARV @ M1 TRANS M1 SUMEPS M4 ALPHALMT           SYMBARV @ M1 M4 MULT M4 MULTEPSLM ;      17 LOAD               : WPAAR ( i j --- f )                                               M4 SWAP RIDA * ?cs: ABI LNX @ CMOVEL                           ?cs: MAT2 ! M4 MAT1 ! RIDA * ABI LNX @ CONJ DUP                 IF -1 CONFL ! LAHUTALM                                          THEN ;                                                       : TSYKLIALG CALCDLCT 0 VLM SYMBARV @ ERASE ;                    : EELTOO BRPIK LNX ! BMSIZE ['] M1 ALLO BMSIZE ['] M4 ALLO ;    : JARELTOO %CORRECT @                                                   IF ." Grammar is (D/1)MSP" ['] M1 SEGFREE                          0 VLM 0 LM SYMBARV @ CMOVE 255 0 LM C!                       THEN ;                                                  11 LOAD                                                         \ #23 Graph segment                                  09/07/88 ) 7 LOAD                                                          : ALLOCSEG ( sconst len --- )                                           ALLOCL SWAP OVERLAY + >BODY ! ;                         : MAXALLOC ( sconst --- )                                               4096 ALCLASM ?DISCERR                                           SWAP OVERLAY + >BODY ! ;                                0 CONSTANT GRASEG                                               VAR GFFL VAR #KAAR                                              : INITGRAPH [S'] GRASEG MAXALLOC 0 GFFL ! ;                     : @GRA ( nihe --- n ) GRASEG SWAP @L ;                          : !GRA ( n nihe --- ) GRASEG SWAP !L ;                          : G, GRASEG GFFL @ !L 2 GFFL +! ;                               : TIPUD ( i --- nihe ) 2* ;                                     -->                                                                                                                             \ #24 Graph: TIPUD, edge fields                      09/07/88 ) PR#SYMBCONST 1- GRAMCONST *  CONSTANT MAX#EDGE                  DIMCONST 1-                  CONSTANT TYHISUF                   MAX#EDGE BARRAY MARKS                                           : K.TIPP 2+ ;      : K.JARGM 4 + ;                              : K.SUF 6 + ;      : K.PREFL 8 + ;       : K.PREF 9 + ;         : ?NOMARK @GRA MARKS C@ 0= ;  : MARK @GRA MARKS 255 SWAP C! ;   : TARGET K.TIPP @GRA ;        : NEXTEDGE K.JARGM @GRA ;         : SUFSYMB K.SUF @GRA ;        : PREFLEN K.PREFL @GRA 255 AND ;  : PREFSYMB ( kaar i --- pref<i> )                                       2* SWAP K.PREF + @GRA ;                                 : RELMARKS 0 MARKS #KAAR @ ERASE ;                              -->                                                                                                                                                                                                                                                             \ #25 Graph building: LQPPU TEEKAAR                  09/07/88 ) : LQPPU ( gaddr1 --- gaddr2 )                                           BEGIN DUP @GRA                                                  WHILE @GRA K.JARGM REPEAT ;                             : TEEKAAR ( prad i --- )                                                2DUP PI TIPUD LQPPU GFFL @ SWAP !GRA                            #KAAR @ G, ( nr. ) OVER PV G, ( target ) 0 G, ( next )          OVER P# OVER 2+ <                                               IF TYHISUF ELSE 2DUP 1+ PI                                      THEN G, ( suf ) 1- DUP G, -1 GFFL +! ( preflen ) ?DUP           IF 1 SWAP                                                             DO DUP I PI G, ( pref[i] ) -1                                   +LOOP                                                     THEN DROP 1 #KAAR +! ; -->                                                                                                                                                              \ #26 Graph: TEEGRAAF                                09/21/88 ) : TEEGRAAF 0 #KAAR !                                                    GRASEG 0 SYMBARV @ TIPUD DUP GFFL ! ERASEL PRODARV @ 0          DO I PRVIIT DUP P# 1                                               DO DUP I TEEKAAR LOOP DROP                                   LOOP GRASEG GFFL @ SETBL ; -->                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          \ #27 Leftmost: ADDFTERM FTERMKAAR FIRSTTERM         09/07/88 ) 0 CONSTANT FTSEG ( Segment for FIRST and RC )                   VAR RCALG VAR TRL                                               DIMCONST BARRAY RCFOUND                                         : INITFT [S'] FTSEG SYMBARV @ 2* TRL @ *                                DUP >R ALLOCSEG FTSEG 0 R> ERASEL                               SYMBARV @ TRL @ * RCALG !                                       0 RCFOUND SYMBARV @ ERASE ;                             VAR TERMNIHE VAR TERMASK                                        : ADDFTERM ( symb2 --- )                                                TRL @ * TERMNIHE @ + >R                                         FTSEG R@ C@L TERMASK @ OR FTSEG R> C!L ;                : FTERMKAAR ( kaar --- f )                                              DUP PREFLEN                                                     IF DROP -1                                                      ELSE TARGET ADDFTERM 0 THEN ; -->                       \ #28 Leftmost: FTWAYS FIRSTTERM RCVECTOR            09/15/88 ) : FTWAYS ( tipunr --- )                                                 TIPUD @GRA BEGIN ?DUP                                                      WHILE DUP ?NOMARK                                                    IF DUP MARK DUP FTERMKAAR 0=                                       IF DUP TARGET MYSELF THEN                                    THEN NEXTEDGE                                              REPEAT ;                                     : FIRSTTERM INITFT                                                      TERMARV @ 0                                                     DO RELMARKS                                                        I DUP 3 ->L TERMNIHE !                                          DUP 7 AND 128 SWAP ->L TERMASK !                                DUP ADDFTERM FTWAYS                                          LOOP ;                                                  : RCVECTOR TRL @ * RCALG @ + ; -->                              \ #29 Context: context segment MARKSAVE LISAPAREM ...09/15/88 ) 0 CONSTANT CONTSEG      VAR FFL                                 : INITCONT [S'] CONTSEG MAXALLOC 0 FFL ! ;                      : @CONT ( nihe --- n ) CONTSEG SWAP @L ;                        : !CONT ( n nihe --- ) CONTSEG SWAP !L ;                        : KONTEKST ( i --- nihe ) 2* ;                                  0 CONSTANT MARKSAVE                                             : ALLOCMS [S'] MARKSAVE MAX#EDGE ALLOCSEG ;                     VAR X VAR H1Y VAR SYMB1                                         : LISAPAREM ( clyli --- )                                               FTSEG MAT1 ! CONTSEG MAT2 !                                     H1Y @ SWAP 4 + TRL @ DISJ ;                             : ADDRC ( tipunr rcvekt --- )                                           FTSEG DUP MAT1 ! MAT2 !                                         SWAP RCVECTOR TRL @ DISJ ;                                                                   -->                        \ #30 Context: TEELYLI LISACONT                      09/15/88 ) : TEELYLI ( viit --- )                                                  FFL @ X @ OVER !CONT                                            OVER @CONT OVER 2+ !CONT                                        SWAP !CONT                                                      FTSEG H1Y @ CONTSEG FFL @ 4 + TRL @ CMOVEL                      TRL @ 4 + FFL +! ;                                      : LISACONT ( --- ) SYMB1 @ KONTEKST                                     BEGIN DUP @CONT 0=                                                 IF TEELYLI EXIT THEN                                            DUP @CONT @CONT X @ >                                           IF TEELYLI EXIT THEN                                            DUP @CONT @CONT X @ =                                           IF @CONT LISAPAREM EXIT THEN                                    @CONT 2+                                                     AGAIN ;    -->                                          \ #31 Context: SUFIKS? LMPREF? SAVEMARKS RESTMARKS...09/15/88 ) : SUFIKS? ( kaar --- f )                                                SUFSYMB DUP TYHISUF <>                                          IF TRL @ * H1Y ! -1 ELSE DROP 0 THEN ;                  : LMPREF? ( kaar --- f )                                                0 OVER PREFLEN 0                                                ?DO DROP DUP I PREFSYMB DUP ULM C@                                  IF X ! -1 LEAVE                                                 ELSE DROP 0 THEN                                            LOOP SWAP DROP ;                                        : SAVEMARKS ?cs: 0 MARKS MARKSAVE 0 #KAAR @ CMOVEL ;            : RESTMARKS MARKSAVE 0 ?cs: 0 MARKS #KAAR @ CMOVEL ;            : DLCKAAR ( kaar --- f )                                                LMPREF? DUP                                                     IF LISACONT THEN ;                                       -->                                                            \ #32 Context: DLCWAY DLCJATK                        09/15/88 ) : DLCWAY ( tipunr --- )                                                 TIPUD @GRA                                                      BEGIN ?DUP                                                      WHILE DUP ?NOMARK                                                  IF DUP MARK DUP DLCKAAR 0=                                         IF DUP TARGET MYSELF                                            THEN                                                         THEN NEXTEDGE                                                REPEAT ;                                                : DLCJATK ( kaar --- )                                                  SAVEMARKS RELMARKS DUP MARK                                     TARGET                                                          DLCWAY RESTMARKS ;                                                       -->                                                                                                            \ #33 Context: RCKAAR RCWAYS                         09/21/88 ) : RCKAAR ( kaar --- f ; TRUE, kui sufiks ka"es )                        SUFIKS? DUP                                                     IF LISACONT THEN ;                                      : RCWAYS ( tipunr --- )                                                 DUP RCFOUND C@                                                  IF RCVECTOR H1Y ! LISACONT                                      ELSE DUP TIPUD @GRA                                                BEGIN ?DUP                                                      WHILE DUP ?NOMARK IF DUP MARK DUP RCKAAR                                             IF OVER H1Y @ ADDRC                                             ELSE DUP TARGET MYSELF                                             2DUP TARGET RCVECTOR ADDRC                                   THEN                                                         THEN NEXTEDGE                                 REPEAT 255 SWAP RCFOUND C! THEN ; -->                \ #34 Context: RCJATK XFLAG DCKAAR                   09/21/88 ) : RCJATK ( kaar --- )                                                   SAVEMARKS RELMARKS DUP MARK                                     TARGET                                                          RCWAYS RESTMARKS ;                                      -->                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ #34 Context: RCJATK XFLAG DCKAAR                   09/21/88 ) VAR XFLAG                                                       : DCKAAR ( kaar --- f ; TRUE, kui kontekst ka"es )                      DUP LMPREF? XFLAG !                                             DUP SUFIKS?                                                     IF XFLAG @ IF DROP LISACONT                                                ELSE DLCJATK                                                    THEN -1                                              ELSE XFLAG @ IF RCJATK -1                                                    ELSE DROP 0                                                     THEN                                               THEN ;                                                   -->                                                                                                                                                                                                                                                            \ #35 Context: DCWAYS                                09/15/88 ) : DCWAYS ( tipunr --- )                                                 TIPUD @GRA                                                      BEGIN ?DUP                                                      WHILE DUP ?NOMARK                                                  IF DUP MARK DUP DCKAAR NOT                                         IF DUP TARGET MYSELF                                            THEN                                                         THEN NEXTEDGE                                                REPEAT ;                                                -->                                                                                                                                                                                                                                                                                                                                                                                             \ #36 Context: CALCSQLT EEMALDALM                    09/15/88 ) : CALCSQLT ( symb --- )                                                 DUP KONTEKST @CONT                                              IF DROP                                                         ELSE RELMARKS DUP SYMB1 !                                          DCWAYS                                                       THEN ;                                                  : EEMALDALM ( x --- )                                                   CONFL @ 0= IF CR ." [ " THEN                                    DUP . DUP LM C@                                                 IF ." Grammar isn't (1,1)DMSP " 0 %CORRECT !                       -1 TQKE ! DROP                                               ELSE 0 SWAP ULM C!                                              THEN -1 CONFL ! ; -->                                                                                                                                                                   \ #37 Context: YHISOSA?                              09/15/88 ) : YHISOSA? ( clyli1 clyli2 --- )                                        CONTSEG DUP MAT1 ! MAT2 !                                       OVER 4 + OVER 4 + TRL @ -CONJ                                   IF DUP @CONT EEMALDALM                                          THEN 2DROP ;                                            -->                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ #38 Context: WPAAR                                 09/15/88 ) : WPAAR ( symb1 symb2 --- f )                                           2DUP CALCSQLT CALCSQLT                                          KONTEKST @CONT SWAP KONTEKST @CONT                              BEGIN OVER @CONT OVER @CONT 2DUP =                                 IF 2DROP 2DUP YHISOSA?                                          ELSE <                                                             IF SWAP                                                         THEN                                                         THEN  2+ @CONT DUP 0=                                        UNTIL 2DROP CONFL @ DUP                                         IF ." ] "                                                       THEN ;                                                  -->                                                                                                                                                                                             \ #39 Context: EELTOO TSYKLIALG                      09/19/90 ) ( 1 LOAD )                                                      : EELTOO TERMARV @ BMRL TRL !                                           INITGRAPH TEEGRAAF ( .GRAAF )                                                      INITCONT ALLOCMS                             FIRSTTERM ;                                             : TSYKLIALG CONTSEG 0 SYMBARV @ KONTEKST DUP FFL ! ERASEL ;      -->                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            \ Context: WRITE_CONTEXT                             09/19/90 ) : WRITE_CONTEXT                                                         LIT" CTB" ATFILE MKEXT                                          32767 BUFFER PUHV !                                             CONTSEG                                                         FFL @ 0                                                         DO               ( contseg )                                       DUP I ?cs: PUHV @ B/BUF CMOVEL                                  PUHV @ B/BUF ATFILE LWRITE                                   B/BUF +LOOP                                                     DROP ;                                                  -->                                                                                                                                                                                                                                                                                                                             (                                                    09/19/90 ) -->                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ #42 Context: LMOUT JARELTOO                        09/19/90 ) : LMOUT LIT" LMV" ATFILE MKEXT                                          0 ULM SYMBARV @ ATFILE LWRITE                                   ATFILE CLOSE-FILE ?DISCERR ;                            : JARELTOO [S'] FTSEG  OVERLAY + SEGFREE                                   [S'] GRASEG OVERLAY + SEGFREE                                %CORRECT @                                                      IF ." Grammar is (1,1)DMSP" CR -1 %ADLCTRL !                       ( LOENDA HCONTMALU PAISKA HCONT HKOKKU )                        ( LIT" CON" HCONT HWRITE ) LMOUT                                ( HCONT HSEG FREEL )                                            WRITE_CONTEXT                                                THEN ;                                                  11 LOAD                                                                                                                                                                                         