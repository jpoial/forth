 MODULA-2 DataBase                                              Main screen file "PrintMaster"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  \ #1 Set print options                               06/01/90 ) : ESC! ( kood --- )                                             27 EMIT EMIT ;                                                  : P-LIIK+ ( kood --- )                                                   CASE 2 OF  69 ESC!         ENDOF                                     3 OF  71 ESC!         ENDOF                                     4 OF  69 ESC! 71 ESC! ENDOF                                ENDCASE ;                                              : P-KIRI+ ( kood --- )                                          CASE 2 OF 15 EMIT                                       ENDOF        3 OF 87 ESC! PT? 0= IF 1 ELSE 49 THEN EMIT         ENDOF        4 OF 15 EMIT 87 ESC! PT? 0= IF 1 ELSE 49 THEN EMIT ENDOF        5 OF 83 ESC! PT? 0= IF 1 ELSE 49 THEN EMIT         ENDOF   ENDCASE ;                                                       -->                                                                                                                             \ #2 Set print options                               06/01/90 ) : P-KURSIIV+ ( kood --- )                                       PT? 0= IF CASE 1 OF                         ENDOF                              2 OF 37 ESC!  0 EMIT 52 ESC! ENDOF                         ENDCASE                                                      ELSE DROP                                                       THEN ;                                                   : P-ALLAKR+ ( kood --- )                                        CASE 1 OF                ENDOF                                       2 OF 45 ESC! PT? 0= IF 1 ELSE 49 THEN EMIT ENDOF           ENDCASE ;                                                       : P-T@HED+ ( kood --- )                                         CASE 1 OF PT? 0= IF 80 ESC! ELSE 18 EMIT THEN ENDOF ( pica )         2 OF PT? 0= IF 77 ESC! ELSE 58 ESC! THEN ENDOF ( elite )   ENDCASE ;                                                       -->                                                             \ #3 Set print options                               06/01/90 ) : OTSI_PASS ( --- )                                             JUURIK @ AIT ! 1 I-ATOM !                                       FP-CHAIN @ 4 + H@                                               BEGIN DUP I-ATOM @ <>                                             IF nEXT-ATOM IF 0 ELSE 0 FP-CHAIN @ 17 + C! -1 THEN             ELSE -1                                                         THEN                                                          UNTIL                                                           DROP ;                                                          : P-T@HED- ( kood --- )                                         CASE 1 OF                                     ENDOF ( pica )         2 OF PT? 0= IF 80 ESC! ELSE 18 EMIT THEN ENDOF ( elite )   ENDCASE ;                                                       -->                                                                                                                             \ #4 Set print options                               06/01/90 ) : P-LIIK- ( kood --- )                                                   CASE 2 OF  70 ESC!         ENDOF                                     3 OF  72 ESC!         ENDOF                                     4 OF  70 ESC! 72 ESC! ENDOF                                ENDCASE ;                                              : P-KIRI- ( kood --- )                                          CASE 2 OF 18 EMIT                                       ENDOF        3 OF 87 ESC! PT? 0= IF 0 ELSE 48 THEN EMIT         ENDOF        4 OF 18 EMIT 87 ESC! PT? 0= IF 0 ELSE 48 THEN EMIT ENDOF        5 OF 84 ESC!                                       ENDOF   ENDCASE ;                                                       : P-KURSIIV- ( kood --- )                                       PT? 0= IF CASE 1 OF                        ENDOF                               2 OF 53 ESC! 37 ESC! 1 EMIT ENDOF                          ENDCASE ELSE DROP THEN ;                    -->       \ #5 Set print options                               06/01/90 ) : P-ALLAKR- ( kood --- )                                        CASE 1 OF                                       ENDOF                2 OF 45 ESC! PT? 0= IF 0 ELSE 48 THEN EMIT ENDOF           ENDCASE ;                                                       : CANCEL_PRN/OPT                                                PRINTER                                                         PT? 0= IF 27 EMIT 80 EMIT ELSE 18 EMIT THEN   ( pica )          18 EMIT                    ( cancel condensed )                 27 EMIT 87 EMIT PT? 0= IF 0 ELSE 48 THEN EMIT ( cl enlarged )   27 EMIT 70 EMIT            ( cancel emphasized )                27 EMIT 72 EMIT            ( cancel double-strike )             27 EMIT 45 EMIT PT? 0= IF 0 ELSE 48 THEN EMIT ( cl underl-ng )  PT? 0= IF 27 EMIT 53 EMIT THEN                ( cancel italic ) 27 EMIT 84 EMIT            ( cancel subscript )                 CONSOLE ;                                             -->       \ #6 Trykkal normaalolekusse                         06/04/90 ) : RESET_PRN/OPT                                                 ?PRN IF CANCEL_PRN/OPT PRINTER                                           27 EMIT 50 EMIT                   ( 1/6" line space )           PT? 0= IF 27 EMIT 81 EMIT 79 EMIT    ( right margin )                     27 EMIT 108 EMIT 0 EMIT    ( left  margin )                  THEN                                                 THEN CONSOLE ;                                             : L.ATOM? ( --- pikkus )                                        AIT @ 20 + @ 6 < IF GET-MKT 16 + @ ELSE SNOOP-#SYMB THEN ;      : ATOM-> ( A.kuhu --- )                                         GET-MKT 20 + @ SNOOP-#SYMB  ROT SWAP   ( A.text A.kuhu sarv )   AIT @ 20 + @ 6 < IF DUP >R GET-MKT 16 + @ SWAP - + R>                            THEN CMOVE ;                                   -->                                                                                                                             \ #7 Relative position                               07/01/90 ) VARIABLE ESC-LYLI VARIABLE FREE-RIDA                            5 2 2ARRAY P-WIDTH                                               80 1 1 P-WIDTH !      96 1 2 P-WIDTH !                         132 2 1 P-WIDTH !     160 2 2 P-WIDTH !                          40 3 1 P-WIDTH !      48 3 2 P-WIDTH !                          68 4 1 P-WIDTH !      81 4 2 P-WIDTH !                          80 5 1 P-WIDTH !      96 5 2 P-WIDTH !                         : P-REVA+  ( kood --- )                                         DUP 3 > IF 51 ESC! EMIT                                                 ELSE CASE 1 OF 48 ESC! ENDOF                                              2 OF 49 ESC! ENDOF                                              3 OF 50 ESC! ENDOF ENDCASE                            THEN ;                                                  : /+ ( n1 n2 --- q[+rem] )                                      /MOD SWAP 5 >= IF 1+ THEN ;                           -->       \ #8 Relative position, value length                 07/01/90 ) : GET_TABW ( --- n )                                            MASTER_RECORD 41 + C@ MASTER_RECORD 42 + C@ P-WIDTH @ ;         : GET_FREEW ( --- n )                                           FP-CHAIN @ 11 + C@ FP-CHAIN @ 12 + C@ P-WIDTH @ ;               : V-PIKKUS? ( --- n )                                           FP-CHAIN @ 4 + H@ 0 >                                            IF FP-CHAIN @ 20 + @ 0=                                           IF FP-CHAIN @ 6 + C@ 1 =                                          IF AIT @ @ ?LNAME 1+ ELSE 0 THEN                                   IS-RERO? IF L.ATOM? + THEN                                 ELSE WIDENESS                                                   THEN                                                          ELSE FP-CHAIN @ 18 + C@                                         THEN DUP ESC-LYLI @ 18 + H! ;                                  -->                                                             \ #9 Set print options                               06/25/90 ) : ESC-ON ( --- )                                                P/D @ 2 <                                                       IF FP-CHAIN @ DUP 10 + C@ P-LIIK+                                             DUP 11 + C@ P-KIRI+                                             DUP 12 + C@ P-T@HED+                                            DUP 13 + C@ P-KURSIIV+                                          DUP 14 + C@ P-ALLAKR+ 15 + C@ P-REVA+             THEN ;                                                          : ESC-OFF ( --- )                                               P/D @ 2 < IF FP-CHAIN @ DUP 10 + C@ P-LIIK- DUP 11 + C@ P-KIRI-                         DUP 12 + C@ P-T@HED-                                            DUP 13 + C@ P-KURSIIV-                                              14 + C@ P-ALLAKR-                             THEN ;                                                -->                                                             \ #10 Set print options: Backline                    06/25/90 ) VARIABLE #EES     VARIABLE #TAGA                                VARIABLE EESREAD  VARIABLE TAGAREAD                             VARIABLE E_VIIDAD VARIABLE T_VIIDAD                             VARIABLE E_Jd     VARIABLE T_Jd              ( j„rjed )         VARIABLE A_OF_L   VARIABLE i.RIDA                               VARIABLE E_Beed   VARIABLE T_Beed                               VARIABLE E_ReVa   VARIABLE T_ReVa                               : GET_A&L ( A[BUF] --- A n )                                    ESC-LYLI @ DUP 18 + H@ SWAP 16 + H@ ROT + SWAP ;                : MOVEVABA ( A[BUF] --- )                                       GET_A&L FP-CHAIN @ 19 + ROT ROT CMOVE ;                         : ET+ ( f --- )                                                 IF   7 + C@ TELL-# + DUP #EES @ >  IF #EES !  ELSE DROP THEN    ELSE 7 + C@ TELL-# + DUP #TAGA @ > IF #TAGA ! ELSE DROP THEN    THEN ;           -->                                            \ #11 FreePrint buffers                              06/28/90 ) : #FREES? ( --- )                                               0 #EES ! 0 #TAGA ! GET-FCHAIN                                    IF BEGIN FP-CHAIN @ DUP DUP 17 + C@ 1 =                            IF   16 + C@ 1 = ET+                                            ELSE DROP DROP                                                  THEN NEXT-CHAIN                                                 UNTIL                                                        THEN GET-F-CHAIN                                                IF BEGIN FP-CHAIN @ DUP DUP 17 + C@ 1 =                            IF   16 + C@ 1 = ET+                                            ELSE DROP DROP                                                  THEN NEXT-CHAIN                                                 UNTIL                                                        THEN ;                                                         -->                                                             \ #12 Freeline chain support                         07/05/90 ) : AHELASSE! ( --- )                                             A_OF_L @ @ 0 =                                                    IF ESC-LYLI @ A_OF_L @ !                                        ELSE A_OF_L @ @ @ ESC-LYLI @ @ >                                    IF A_OF_L @ @ ESC-LYLI @ 12 + !                                    ESC-LYLI @ A_OF_L @ !                                        ELSE A_OF_L @ @ 12 + A_OF_L ! MYSELF                            THEN                                                        THEN ;                                                        : MEND_LENGTH ( n --- n' )                                      GET_TABW * GET_FREEW /+ ;                                       : REAL_LENGTH ( n --- n' )                                      GET_FREEW * GET_TABW /+ ;                                       : &Rida ( --- i )                                               FP-CHAIN @ DUP 7 + C@ i.RIDA @ + ;                  -->         \ #13 Freeline chain support                         07/05/90 ) : GET-A_OF_Jd ( --- A )                                         &Rida 4 * SWAP 16 + C@ 1 =                                       IF E_Jd ELSE T_Jd THEN @ + ;                                   : GET-A_Bee ( --- A )                                           &Rida 4 * SWAP 16 + C@ 1 =                                       IF E_Beed ELSE T_Beed THEN @ + ;                               : GET-A_ReVa ( --- A )                                          &Rida 4 * SWAP 16 + C@ 1 =                                       IF E_ReVa ELSE T_ReVa THEN @ + ;                               : GET-ReVa ( kood --- n )                                       CASE 1 OF 27 ENDOF                                                   2 OF 21 ENDOF                                                   3 OF 36 ENDOF                                              ENDCASE ;                                                       -->                                                             \ #14 Freeline line space                            07/05/90 ) : ReVa! ( --- )                                                 FP-CHAIN @ 15 + C@ DUP 4 <                                        IF GET-ReVa THEN                                              GET-A_ReVa ! ;                                                  : MAKE_ESC-LYLI ( --- )                                         20 DECL ESC-LYLI ! FP-CHAIN @ ESC-LYLI @ 8 + ! ;                : ESC-LYLI! ( --- )                                             ESC-LYLI @ &Rida 4 * SWAP 16 + C@ 1 =                            IF E_VIIDAD @ + ELSE T_VIIDAD @ + THEN                         A_OF_L ! AHELASSE! ReVa! DROP ;                                 : S-ADDR! ( A[BUF] --- )                                        GET-A_OF_Jd @ ESC-LYLI @ 16 + H! ;                              -->                                                                                                                                                                                             \ #15 Freeline chain support                         07/05/90 ) : POSITS! ( n --- )                                             DUP ESC-LYLI @ !                                                V-PIKKUS? MEND_LENGTH + ESC-LYLI @ 4 + ! ;                      : CENTRE! ( --- )                                               @TL V-PIKKUS? MEND_LENGTH DUP >R - 2 / DUP ESC-LYLI @ !         R> + ESC-LYLI @ 4 + ! ;                                         : RIGHT! ( --- )                                                @TL 1 - DUP ESC-LYLI @ 4 + !                                        V-PIKKUS? MEND_LENGTH - ESC-LYLI @ ! ;                      : SAPPA! ( --- )                                                GET-A_Bee @ 1+ DUP ESC-LYLI @ !                                 V-PIKKUS? MEND_LENGTH + ESC-LYLI @ 4 + ! ;                      -->                                                                                                                                                                                             \ #16 Freeline filling                               06/28/90 ) : MOVEATOM ( A[VAL] --- A[VAL+] )                               GET_A&L DROP                                                    FP-CHAIN @ 6 + C@ 1 =                                               IF DUP AIT @ @ ?Nimi MOVE-NAME AIT @ @ ?LNAME + 1+ THEN     IS-RERO? IF   ATOM->                                                     ELSE DROP                                                       THEN ;                                                 : MOVEFREE ( --- )                                              ESC-LYLI @ 4 + @ GET-A_Bee ! FREE-RIDA @ FP-CHAIN @ 4 + H@ 0 =  IF MOVEVABA ELSE MOVEATOM THEN                                  ESC-LYLI @ 18 + H@ GET-A_OF_Jd +!  ESC-LYLI! ;                  : MOVE.TAB ( --- )                                              ESC-LYLI @ 4 + @ GET-A_Bee ! FREE-RIDA @                        GET_A&L DROP SWAP CMOVE.B                                       ESC-LYLI @ 18 + H@ GET-A_OF_Jd +! ESC-LYLI! ;   -->             \ #17 Freeline filling                               06/28/90 ) : ELEMENT! ( A l --- )                                          S-ADDR! FP-CHAIN @ 4 + H@ 0 >                                     IF OTSI_PASS THEN FP-CHAIN @ 17 + C@ 0 >                              IF FP-CHAIN @ 8 + H@ DUP 4 >                                                      IF   POSITS!                                                    ELSE CASE 0 OF POSITS!   ENDOF                                            1 OF 0 POSITS! ENDOF                                            2 OF RIGHT!    ENDOF                                            3 OF CENTRE!   ENDOF                                            4 OF SAPPA!    ENDOF                                       ENDCASE                                                    THEN MOVEFREE                                 THEN ;                                                  -->                                                                                                                             \ #18 Freeline filling                               06/28/90 ) : ELEMENT> ( A l --- )                                          S-ADDR! FP-CHAIN @ 4 + H@ 0 >                                     IF OTSI_PASS THEN FP-CHAIN @ 17 + C@ 0 >                              IF FP-CHAIN @ 8 + H@ DUP 4 >                                                      IF   POSITS!                                                    ELSE CASE 0 OF POSITS!   ENDOF                                            1 OF 0 POSITS! ENDOF                                            2 OF RIGHT!    ENDOF                                            3 OF CENTRE!   ENDOF                                            4 OF SAPPA!    ENDOF                                       ENDCASE                                                    THEN MOVE.TAB                                 THEN ;                                                  -->                                                                                                                             \ #19 Freeline filling                               06/28/90 ) : Multi? ( --- f )                                              @TT 1 <>                                                         IF FP-CHAIN @ 20 + @ 0 > ELSE 0 THEN ;                         : FILL-MULTI  ( --- )                                           FP-CHAIN @ 17 + C@ 1 =                                          IF TABEL+L TELL-# 0                                               DO I i.RIDA ! &Rida @TL * SWAP 16 + C@ 1 =                        IF   EESREAD @ +                                                ELSE TAGAREAD @ +                                               THEN FREE-RIDA ! MAKE_ESC-LYLI                                       I RIDA+L  ELEMENT>                                       LOOP                                                          THEN ;                                                          -->                                                                                                                             \ #20 Freeline filling                               06/28/90 ) : FILL-BUFFER ( --- )                                           FP-CHAIN @ 17 + C@ 1 =                                            IF 0 i.RIDA ! &Rida @TL * SWAP 16 + C@ 1 =                        IF   EESREAD @ +                                                ELSE TAGAREAD @ +                                               THEN FREE-RIDA ! MAKE_ESC-LYLI ELEMENT!                       THEN ;                                                        : FILL-BUFFS ( --- )                                            AIT @ >R GET-FCHAIN                                              IF BEGIN Multi? IF FILL-MULTI ELSE FILL-BUFFER THEN NEXT-CHAIN     UNTIL                                                        THEN GET-F-CHAIN                                                IF BEGIN FILL-BUFFER NEXT-CHAIN                                    UNTIL                                                         THEN R> AIT ! ;                  -->                          \ #21 Free print support                             06/28/90 ) : DECL-FBUFFS ( --- )                                           0 EESREAD ! 0 TAGAREAD ! 0 E_VIIDAD ! 0 T_VIIDAD !              #EES  @ DUP 0 >                                                  IF 1+ @TL * DUP DECL DUP EESREAD ! SWAP BL FILL                    #EES @ 1+ 4 * DUP DECL E_VIIDAD ! DUP DECL E_Jd !                             DUP DECL E_Beed ! DECL E_ReVa !                ELSE DROP THEN                                                 #TAGA @ DUP 0 >                                                  IF 1+ @TL * DUP DECL DUP TAGAREAD ! SWAP BL FILL                   #TAGA @ 1+ 4 * DUP DECL T_VIIDAD ! DUP DECL T_Jd !                             DUP DECL T_Beed ! DECL T_ReVa !               ELSE DROP THEN ;                                               : FP-SUPPORT                                                    #FREES? DECL-FBUFFS #EES @ #TAGA @ + 0 >                          IF FILL-BUFFS THEN ;                                -->       \ #22 Set print options                              06/01/90 ) : -LIIK!                                                        MASTER_RECORD 40 + C@                                             CASE 1 OF                                 ENDOF                      2 OF 27 EMIT 70 EMIT                 ENDOF                      3 OF 27 EMIT 72 EMIT                 ENDOF                      4 OF 27 EMIT 72 EMIT 27 EMIT 70 EMIT ENDOF                 ENDCASE ;                                                     : +LIIK!                                                        MASTER_RECORD 40 + C@                                             CASE 1 OF 27 EMIT 72 EMIT 27 EMIT 70 EMIT ENDOF                      2 OF 27 EMIT 69 EMIT                 ENDOF                      3 OF 27 EMIT 71 EMIT                 ENDOF                      4 OF 27 EMIT 69 EMIT 27 EMIT 71 EMIT ENDOF                 ENDCASE ;                                                     -->                                                             \ #23 Set print options                              06/01/90 ) : -KIRI!                                                        18 EMIT MASTER_RECORD 41 + C@                                   CASE 1 OF 18 EMIT ENDOF 2 OF 18 EMIT ENDOF                           3 OF 27 EMIT 87 EMIT PT? 0= IF 0 ELSE 48 THEN EMIT ENDOF        4 OF 18 EMIT 27 EMIT 87 EMIT PT? 0=                                IF 0 ELSE 48 THEN EMIT ENDOF                            ENDCASE ;                                                       : +KIRI!                                                        MASTER_RECORD 41 + C@                                           CASE 1 OF 18 EMIT ENDOF 2 OF 15 EMIT ENDOF                           3 OF 27 EMIT 87 EMIT PT? 0= IF 1 ELSE 49 THEN EMIT ENDOF        4 OF 15 EMIT 27 EMIT 87 EMIT PT? 0=                                IF 1 ELSE 49 THEN EMIT ENDOF                            ENDCASE ;                                                       -->                                                             \ #24 Set print options                              06/01/90 ) : -KURSIIV!                                                     PT? 0= IF MASTER_RECORD 43 + C@ 2 =                               IF 27 EMIT 53 EMIT THEN THEN ;                                : +KURSIIV!                                                     PT? 0= IF MASTER_RECORD 43 + C@ 2 =                               IF 27 EMIT 52 EMIT THEN THEN ;                                : -T@HED!                                                       MASTER_RECORD 42 + C@ P-T@HED- ;                                -->                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ #25 Set print options                              06/01/90 ) : +T@HED!                                                       MASTER_RECORD 42 + C@ P-T@HED+ ;                                : -ALLAKR!                                                      MASTER_RECORD 44 + C@ P-ALLAKR- ;                               : +ALLAKR!                                                      MASTER_RECORD 44 + C@ P-ALLAKR+ ;                               -->                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ #26 Set print options                              06/01/90 ) : +REVA!                                                        MASTER_RECORD 45 + C@                                                    CASE 1 OF 27 EMIT 48 EMIT ENDOF                                      2 OF 27 EMIT 49 EMIT ENDOF                                      3 OF 27 EMIT 50 EMIT ENDOF                                 ENDCASE ;                                              : A/C! ( ASCII/Cyrillic + ESC 6 IBM-l )                         PT? 1 = IF 116 ESC! AC? EMIT 54 ESC! THEN ;                     -->                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ #27 Set print options                              05/15/91 ) : ?LKJ ( --- f )                                                MASTER_RECORD 47 + C@ 1 = ;                                     : +LEFT! ( --- )                                                PT? 0= IF MASTER_RECORD 49 + C@ 27 EMIT 108 EMIT EMIT THEN ;    : +RIGHT! ( --- )                                               PT? 0= IF MASTER_RECORD 50 + C@ 27 EMIT 81 EMIT EMIT THEN ;     : +PLENGTH! ( --- )                                             ?LKJ IF MASTER_RECORD 51 + C@ 27 EMIT 67 EMIT EMIT THEN ;       : POP-ON P/D @ 2 <                                              IF A/C! +LIIK! +KIRI! +T@HED! +KURSIIV! +ALLAKR! +REVA!            +LEFT! +RIGHT! +PLENGTH! THEN ;                              : POP-OFF P/D @ 2 <                                             IF  -LIIK! -KIRI! -T@HED! -KURSIIV! -ALLAKR!                    THEN ;                                                          -->                                                             ( #28                                                08/16/91 ) : POP-On P/D @ 2 <                                              IF A/C! +LIIK! +KIRI! +T@HED! +KURSIIV! +ALLAKR! +REVA!         THEN ;                                                          ;S                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              \ #16 Freeline filling                               06/28/90 ) : MOVEATOM ( A[VAL] --- A[VAL+] )                               GET_A&L DROP                                                    FP-CHAIN @ 6 + C@ 1 =                                               IF DUP AIT @ @ ?Nimi MOVE-NAME AIT @ @ ?LNAME + 1+ THEN     IS-RERO? IF   ATOM->                                                     ELSE 2DROP                                                      THEN ;                                                 : MOVEFREE ( --- )                                              ESC-LYLI @ 4 + @ GET-A_Bee !                                    FREE-RIDA @ FP-CHAIN @ 4 + H@ 0 =                               IF MOVEVABA ELSE MOVEATOM THEN                                  ESC-LYLI @ 18 + H@ GET-A_OF_Jd +! 0 ESC-LYLI! ;                 -->                                                                                                                                                                                             \ #20 Set print options                              06/01/90 ) : -LIIK!                                                        MASTER_RECORD 40 + C@                                             CASE 1 OF                                 ENDOF                      2 OF 27 EMIT 70 EMIT                 ENDOF                      3 OF 27 EMIT 72 EMIT                 ENDOF                      4 OF 27 EMIT 72 EMIT 27 EMIT 70 EMIT ENDOF                 ENDCASE ;                                                     : +LIIK!                                                        MASTER_RECORD 40 + C@                                             CASE 1 OF 27 EMIT 72 EMIT 27 EMIT 70 EMIT ENDOF                      2 OF 27 EMIT 69 EMIT                 ENDOF                      3 OF 27 EMIT 71 EMIT                 ENDOF                      4 OF 27 EMIT 69 EMIT 27 EMIT 71 EMIT ENDOF                 ENDCASE ;                                                     -->                                                             \ #21 Set print options                              06/01/90 ) : -KIRI!                                                        18 EMIT MASTER_RECORD 41 + C@                                   CASE 1 OF 18 EMIT ENDOF 2 OF 18 EMIT ENDOF                           3 OF 27 EMIT 87 EMIT PT? 0= IF 0 ELSE 48 THEN EMIT ENDOF        4 OF 18 EMIT 27 EMIT 87 EMIT PT? 0=                                IF 0 ELSE 48 THEN EMIT ENDOF                            ENDCASE ;                                                       : +KIRI!                                                        MASTER_RECORD 41 + C@                                           CASE 1 OF 18 EMIT ENDOF 2 OF 15 EMIT ENDOF                           3 OF 27 EMIT 87 EMIT PT? 0= IF 1 ELSE 49 THEN EMIT ENDOF        4 OF 15 EMIT 27 EMIT 87 EMIT PT? 0=                                IF 1 ELSE 49 THEN EMIT ENDOF                            ENDCASE ;                                                       -->                                                             \ #22 Set print options                              06/01/90 ) : -KURSIIV!                                                     PT? 0= IF MASTER_RECORD 43 + C@ 2 =                               IF 27 EMIT 53 EMIT THEN THEN ;                                : +KURSIIV!                                                     PT? 0= IF MASTER_RECORD 43 + C@ 2 =                               IF 27 EMIT 52 EMIT THEN THEN ;                                : -T@HED!                                                       MASTER_RECORD 42 + C@ P-T@HED- ;                                -->                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ #23 Set print options                              06/01/90 ) : +T@HED!                                                       MASTER_RECORD 42 + C@ P-T@HED+ ;                                : -ALLAKR!                                                      MASTER_RECORD 44 + C@ P-ALLAKR- ;                               : +ALLAKR!                                                      MASTER_RECORD 44 + C@ P-ALLAKR+ ;                               -->                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ #24 Set print options                              06/01/90 ) : +REVA!                                                        MASTER_RECORD 45 + C@                                                    CASE 1 OF 27 EMIT 48 EMIT ENDOF                                      2 OF 27 EMIT 49 EMIT ENDOF                                      3 OF 27 EMIT 50 EMIT ENDOF                                 ENDCASE ;                                              : A/C! ( ASCII/Cyrillic + ESC 6 IBM-l )                         PT? 1 = IF 116 ESC! AC? EMIT 54 ESC! THEN ;                     -->                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ #25 Set print options                              05/15/91 ) : ?LKJ ( --- f )                                                MASTER_RECORD 47 + C@ 1 = ;                                     : +LEFT! ( --- )                                                PT? 0= IF MASTER_RECORD 49 + C@ 27 EMIT 108 EMIT EMIT THEN ;    : +RIGHT! ( --- )                                               PT? 0= IF MASTER_RECORD 50 + C@ 27 EMIT 81 EMIT EMIT THEN ;     : +PLENGTH! ( --- )                                             ?LKJ IF MASTER_RECORD 51 + C@ 27 EMIT 67 EMIT EMIT THEN ;       : POP-ON P/D @ 2 <                                              IF A/C! +LIIK! +KIRI! +T@HED! +KURSIIV! +ALLAKR! +REVA!            +LEFT! +RIGHT! +PLENGTH! THEN ;                              : POP-OFF P/D @ 2 <                                             IF  -LIIK! -KIRI! -T@HED! -KURSIIV! -ALLAKR!                    THEN ;                                                          -->                                                             (                                                    08/16/91 ) : POP-On P/D @ 2 <                                              IF A/C! +LIIK! +KIRI! +T@HED! +KURSIIV! +ALLAKR! +REVA!         THEN ;                                                          ;S                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              